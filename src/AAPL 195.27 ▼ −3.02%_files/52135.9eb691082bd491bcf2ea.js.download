(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[52135,9726,43382,54875,63317],{144762:e=>{e.exports={}},712580:e=>{e.exports={rootContainer:"rootContainer-fxQkGV8J"}},872877:e=>{e.exports={container:"container-B8mkOfAH",inner:"inner-B8mkOfAH","border-left":"border-left-B8mkOfAH","border-right":"border-right-B8mkOfAH","border-top":"border-top-B8mkOfAH","border-bottom":"border-bottom-B8mkOfAH","top-right-radius":"top-right-radius-B8mkOfAH","top-left-radius":"top-left-radius-B8mkOfAH","bottom-right-radius":"bottom-right-radius-B8mkOfAH","bottom-left-radius":"bottom-left-radius-B8mkOfAH"}},429973:(e,t,i)=>{"use strict";i.d(t,{formatTime:()=>u,isValidTimeOptionsDateStyle:()=>h,isValidTimeOptionsRange:()=>d});const r={calendar:"gregory",numberingSystem:"latn",hour12:!1},n={year:"numeric",month:"short",day:"numeric"},s={year:"numeric",month:"2-digit",day:"2-digit"},o={hour:"2-digit",minute:"2-digit",second:"2-digit"},a={timeZoneName:"shortOffset",weekday:"short"},l={year:0,month:1,day:2,hour:3,minute:4,second:5};const c=["year","month","day","hour","minute","second"];function d(e){return c.includes(e)}function h(e){return"numeric"===e||"short"===e}function u(e,t,i="year",c="day",d){const h=function(e="year",t="day",i={}){[e,t]=l[t]>l[e]?[e,t]:[t,e];const c={..."numeric"===i.dateStyle?s:n,...o},d=i.fractionalSecondDigits,h={...r,fractionalSecondDigits:void 0===d?void 0:Math.floor(Math.min(Math.max(1,d),3)),timeZone:i.timeZone,weekday:i.weekday?a.weekday:void 0,timeZoneName:i.timeZoneName?a.timeZoneName:void 0};return Object.keys(c).forEach((i=>{l[i]>=l[e]&&l[i]<=l[t]&&(h[i]=c[i])})),h}(i,c,d),u=new Intl.DateTimeFormat(t,h),_=new Date(e);return u.format(_)}},782618:(e,t,i)=>{"use strict";i.d(t,{setupChartEventHint:()=>u});var r=i(650151),n=i(444372),s=i(62802),o=i(87913),a=i(529751),l=i(638456),c=i(470316),d=i(213377);const h=["LineToolTrendLine","LineToolRay","LineToolInfoLine","LineToolExtended","LineToolRegressionTrend","LineToolRotatedRectangle","LineToolParallelChannel","LineToolFlatBottom","LineToolDisjointAngle","LineToolPitchfork","LineToolSchiffPitchfork","LineToolSchiffPitchfork2","LineToolInsidePitchfork","LineToolVertLine","LineToolCrossLine","LineToolHorzLine","LineToolHorzRay","LineToolTrendAngle"];function u(e,t=!1,u=!1){if(!d.enabled("popup_hints"))return()=>{};const _=e.getContainer();let g=null,p=null,m=null;return o.tool.subscribe(f),o.createdLineTool.subscribe(null,v),o.finishedLineTool.subscribe(null,y),e.layoutSizesChanged().subscribe(S),t||l.CheckMobile.any()||!w("hint.startFocusedZoom")||(m=function(e,t){let i=!1;const r=n=>{n?(i&&t(n),e.onZoom().unsubscribe(null,r)):i||(t(n),i=!0)};return e.onZoom().subscribe(null,r),()=>e.onZoom().unsubscribe(null,r)}(e,(function(e){if(!w("hint.startFocusedZoom"))return;if(e)p&&(m=null,C("hint.startFocusedZoom"));else{b(n.t(null,void 0,i(681712)).format({key:(0,c.humanReadableModifiers)(c.Modifiers.Mod,!1)}),"hint.startFocusedZoom")}}))),()=>{o.tool.unsubscribe(f),o.createdLineTool.unsubscribe(null,v),o.finishedLineTool.unsubscribe(null,y),
e.layoutSizesChanged().unsubscribe(S),m?.()};function f(){const t=o.tool.value(),r=l.CheckMobile.any();if(g?.hide(),!r&&(0,o.toolIsDemonstration)(t)&&w("hint.demonstrationCursorSelected")){return void b(n.t(null,void 0,i(187133)).format({key:(0,c.humanReadableModifiers)(c.Modifiers.Alt,!1)}),"hint.demonstrationCursorSelected")}if(u&&r&&(s=t,h.includes(s)))return void async function(t){{const r=()=>(0,o.resetToCursor)(!0);if(g)g.show(t,r);else{const{DrawingHintsRenderer:n}=await Promise.all([i.e(71731),i.e(19190),i.e(65874),i.e(32227),i.e(35858)]).then(i.bind(i,953745));g=new n(e),t===o.tool.value()&&g.show(t,r)}}}(t);var s;if("LineToolTextAbsolute"===t&&w("hint.anchoredTextWillBeRemoved"))return void b(n.t(null,void 0,i(277705)),"hint.anchoredTextWillBeRemoved");if(!w("hint.touchPainting"))return;const d=(0,a.isLineToolDrawWithoutPoints)(t);!(0,a.isStudyLineToolName)(t)||"LineToolRegressionTrend"===t||d||r?(0,a.isLineToolName)(t)&&!(0,a.isLineDrawnWithPressedButton)(t)&&!d&&r?b(n.t(null,void 0,i(360663)),"hint.touchPainting"):p&&p.hide():b(n.t(null,void 0,i(414985)),"hint.touchPainting")}function v(){const e=o.tool.value();"LineToolPath"===e&&w("hint.finishBuildPathByDblClick")?b(n.t(null,void 0,i(275296)),"hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&w("hint.finishBuildPolylineByDblClick")&&b(n.t(null,void 0,i(317409)),"hint.finishBuildPolylineByDblClick")}function y(){if(p){const e=o.tool.value();"LineToolPath"===e?C("hint.finishBuildPathByDblClick"):"LineToolPolyline"===e&&C("hint.finishBuildPolylineByDblClick")}}function S(){if(!w("hint.startResizingChartInLayout"))return;b(l.CheckMobile.any()?n.t(null,void 0,i(436539)):n.t(null,void 0,i(9430)),"hint.startResizingChartInLayout")}function b(e,t){if(p)p.show(e,C.bind(null,t));else{const r=o.tool.value();Promise.all([i.e(46195),i.e(50628),i.e(32227),i.e(26166)]).then(i.bind(i,410837)).then((i=>{p=new i.ChartEventHintRenderer(_),r===o.tool.value()&&p.show(e,C.bind(null,t))}))}}function w(e){return!Boolean(s.getBool(e))}function C(e){s.setValue(e,!0,{forceFlush:!0}),(0,r.ensureNotNull)(p).destroy(),null!==m&&m(),p=null}}},229534:(e,t,i)=>{"use strict";async function r(e){return(await Promise.all([i.e(66814),i.e(38452),i.e(3016),i.e(41392),i.e(67799),i.e(66534),i.e(71761),i.e(11194),i.e(64935),i.e(29684),i.e(47793),i.e(25977),i.e(26614),i.e(30938),i.e(37757)]).then(i.bind(i,173403))).createDialog(e)}function n(e){r(e).then((e=>e.open()))}i.d(t,{createErrorDialog:()=>r,showErrorDialog:()=>n})},503246:(e,t,i)=>{"use strict";i.d(t,{QUOTE_INFO_PATHS:()=>a,categoryIdByPaths:()=>n,isStatementsCategoryPath:()=>s,pathsByCategoryId:()=>r});const r={"income statements":"/financials-income-statement/","balance sheet":"/financials-balance-sheet/","cash flow":"/financials-cash-flow/",statistics:"/financials-statistics-and-ratios/",dividends:"/financials-dividends/",earnings:"/financials-earnings/",revenue:"/financials-revenue/"},n={"/financials-income-statement/":"income statements","/financials-balance-sheet/":"balance sheet","/financials-cash-flow/":"cash flow"}
;function s(e){return"/financials-income-statement/"===e||"/financials-balance-sheet/"===e||"/financials-cash-flow/"===e}function o(e){return e.replace(/\//g,"")}const a=[`/:category(${o("/financials-income-statement/")})/:indicator`,`/:category(${o("/financials-balance-sheet/")})/:indicator`,`/:category(${o("/financials-cash-flow/")})/:indicator`,`/:category(${o("/financials-statistics-and-ratios/")})/:indicator`]},254526:(e,t,i)=>{"use strict";i.d(t,{SYMBOL_TYPE_BLACK_LIST:()=>r});const r=new Set(["spread","economic"])},969919:(e,t,i)=>{"use strict";i.d(t,{ChartAreaResizer:()=>d});var r=i(820028),n=i(581996),s=i(484443),o=i(213377),a=i(305141);const l=o.enabled("no_min_chart_width"),c=o.enabled("bypass_chart_height_check");class d{constructor(e){this._processVisibility=e=>{const t=e.container.value();return this.affectsLayout(e.name)?(t&&t.classList.toggle("js-hidden",!1),!0):(t&&t.classList.toggle("js-hidden",!0),!1)},this._setWidth=(e,t,i)=>{let r=i;this._fullscreenArea!==e.name&&(e.availWidth.setValue(i),e.canNegotiate.width&&(r=(0,s.determineSize)(i,e.negotiations.width))),t||(r=0);const n=e.container.value();return n&&t&&(n.style.width=r+"px"),e.width.setValue(r),r},this._setHeight=(e,t,i)=>{let r=i;this._fullscreenArea!==e.name&&(e.availHeight.setValue(i),e.canNegotiate.height&&(r=(0,s.determineSize)(i,e.negotiations.height))),t||(r=0);const n=e.container.value();return n&&t&&(n.style.height=r+"px"),e.height.setValue(r),r};const t=e.container.value();if(!t)throw new Error("bridge.container.value() must be an element");this._container=t,this._availableAreas=["left","tradingpanel","right","top","bottom","center","topleft","extratop"],this._areas={},this._bridge=e,this._width=e.width,this._height=e.height,this._width.subscribe((()=>this.recalculate())),this._height.subscribe((()=>this.recalculate())),this._bridge.visible.subscribe((()=>this._updateVisibility())),this._bridge.fullscreen.subscribe((()=>this._onParentFullscreenChange())),this.recalculate()}allocate(e){const t=e&&e.areaName;if(-1===this._availableAreas.indexOf(t))throw new Error("unknown options.areaName");this.free(t);const i=this._createDOM(t),o={name:t,canNegotiate:{width:"left"===t||"right"===t||"tradingpanel"===t||"topleft"===t,height:"top"===t||"bottom"===t||"topleft"===t||"extratop"===t},negotiations:{width:[],height:[]},remove:()=>{for(const e in this._areas)this._areas[e]===o&&this.free(e)},negotiateWidth:e=>{if(!o.canNegotiate.width)return;const t=(0,s.processNegotiation)(e);(0,s.negotiationsAreEqual)(o.negotiations.width,t)||(o.negotiations.width=t,this.recalculate())},negotiateHeight:e=>{if(!o.canNegotiate.height)return;const t=(0,s.processNegotiation)(e);(0,s.negotiationsAreEqual)(o.negotiations.height,t)||(o.negotiations.height=t,this.recalculate())},requestFullscreen:()=>{this._fullscreenArea||("right"!==t&&"center"!==t||(this._fullscreenArea=t),"center"===t&&this._bridge.requestFullscreen(),this._updateFullscreen())},exitFullscreen:()=>{t===this._fullscreenArea&&(this._fullscreenArea=void 0,
"center"===t&&this._bridge.exitFullscreen(),this._updateFullscreen())},width:new r.WatchedValue,height:new r.WatchedValue,availWidth:new r.WatchedValue,availHeight:new r.WatchedValue,alive:new r.WatchedValue(!0),container:new r.WatchedValue(i),visible:new r.WatchedValue(!0),fullscreen:new r.WatchedValue(!1),fullscreenable:new r.WatchedValue("right"===t||"center"===t),rdState:new n.ResizerDetacherState};return o.rdState.pushOwner(o),this._areas[t]=o,o.rdState.owner.subscribe((e=>{const i=o.container.value();if(e!==o)i&&(i.innerHTML="",i.parentElement&&i.parentElement.removeChild(i));else{let e=null;for(let i=this._availableAreas.indexOf(t);i--;){const t=this._availableAreas[i];if(this.affectsLayout(t)){e=this._areas[t].container.value();break}}i&&(e&&i.parentElement?i.insertAdjacentElement("afterend",e):this._container.appendChild(i))}this.recalculate()}),{callWithLast:!0}),o.rdState.bridge()}free(e){const t=this._areas[e];if(!t)return;this._areas[e]=void 0;const i=t.container.value();i&&i.parentElement&&i.parentElement.removeChild(i),t.alive.setValue(!1)}recalculate(){const e={};this._recalcSingleRunToken=e;const t=this._areas.topleft,i=this._areas.left,r=this._areas.tradingpanel,n=this._areas.right,s=this._areas.top,o=this._areas.bottom,c=this._areas.center,d=this._areas.extratop,h=this._width.value(),u=this._height.value();let _=0,g=0,p=0,m=0,f=0,v=0,y=0,S=0;if(e===this._recalcSingleRunToken&&d){const e=this._processVisibility(d);S=this._setHeight(d,e,u),this._setWidth(d,e,h)}if(e===this._recalcSingleRunToken&&t){const e=this._processVisibility(t);y=this._setHeight(t,e,u),v=this._setWidth(t,e,h);const i=t.container.value();e&&i&&(i.style.top=S+"px")}let b=0;if(e===this._recalcSingleRunToken&&s){const e=this._processVisibility(s),t=s.container.value();e&&t&&(t.style.left=v+"px",t.style.top=S+"px");const i=h-v;this._setWidth(s,e,i),_=this._setHeight(s,e,u),_&&(b=1)}if(e===this._recalcSingleRunToken&&i){const e=this._processVisibility(i),t=Math.max(y,_);p=this._setWidth(i,e,h),p&&(p+=4),p&&1===b&&(b=4);const r=i.container.value();e&&r&&(r.style.top=t+S+b+"px"),this._setHeight(i,e,u-t-S)}if(e===this._recalcSingleRunToken&&r){const e=this._processVisibility(r);let t=h-p;l||(t-=300),f=this._setWidth(r,e,t),f&&1===b&&(b=4),this._setHeight(r,e,u-S-_-b)}if(e===this._recalcSingleRunToken&&n){const e=this._processVisibility(n);let t=h-p-f;l||(t-=300),m=this._setWidth(n,e,t),m&&1===b&&(b=4),this._setHeight(n,e,u-S-_-b);const i=n.container.value();e&&i&&(i.style.top=_+S+b+"px")}const w=f+m;let C=0,T=h-p-f-m-(w?4:0);const P=Boolean(f||!w);if(!m&&f&&(T+=4),e===this._recalcSingleRunToken&&o){const e=this._processVisibility(o),t=o.container.value();e&&t&&(t.style.left=p+"px",t.classList.toggle("no-border-top-left-radius",!p),t.classList.toggle("no-border-top-right-radius",P)),this._setWidth(o,e,T);const i=u-S;C=Math.min(300,i-0),g=this._setHeight(o,e,i)+4}const A=Boolean(_&&(p||w));if(this._container.classList.toggle("layout-with-border-radius",A),
a.setNewBlackColor&&this._container.classList.toggle("black-border-bigger-radius",!0),e===this._recalcSingleRunToken&&c){const e=this._processVisibility(c),t=c.container.value();e&&t&&(t.style.left=p+"px",t.style.top=_+S+b+"px",t.classList.toggle("no-border-bottom-left-radius",!g||!p),t.classList.toggle("no-border-bottom-right-radius",P||!g),t.classList.toggle("no-border-top-left-radius",Boolean(!p&&w)),t.classList.toggle("no-border-top-right-radius",P)),this._setWidth(c,e,T);const i=u-_-g-S-b;this._setHeight(c,e,Math.max(i,C))}if(e===this._recalcSingleRunToken&&r&&this.affectsLayout("tradingpanel")){const e=r.container.value();e&&(e.style.right=f&&m?`${m+4}px`:`${m}px`,e.style.top=S+_+b+"px",e.style.borderTopRightRadius=A&&m?"4px":"0px")}e===this._recalcSingleRunToken&&this._updateVisibility()}affectsLayout(e){const t=this._areas[e];if(!t)return!1;if(t.rdState.owner.value()!==t)return!1;if(this._fullscreenArea&&this._fullscreenArea!==e)return h(e);if(this._width.value()<=567||this._height.value()<=445&&!c){if(!["center","top","left","topleft","extratop"].includes(e))return!1}return!0}_updateVisibility(){const e=this._bridge.visible.value();for(let t=0;t<this._availableAreas.length;t++){const i=this._availableAreas[t],r=this._areas[i];r&&(e&&this.affectsLayout(i)?r.visible.setValue(!0):r.visible.setValue(!1))}}_onParentFullscreenChange(){this._bridge.fullscreen.value()||(this._fullscreenArea=void 0,this._updateFullscreen())}_updateFullscreen(){const e=void 0!==this._fullscreenArea;for(let t=0;t<this._availableAreas.length;t++){const i=this._availableAreas[t],r=this._areas[i];if(!r)continue;if(i===this._fullscreenArea){r.fullscreen.setValue(!0);continue}r.fullscreen.setValue(!1);const n=r.container.value();n&&n.classList.toggle("js-hidden",e&&!h(i))}this._updateVisibility(),this.recalculate()}_createDOM(e){const t=document.createElement("div");return t.classList.add("layout__area--"+e),t.style.position="absolute","tradingpanel"===e&&(t.style.borderTopRightRadius="4px"),"bottom"===e?t.style.bottom="0":t.style.top="0","right"===e||"tradingpanel"===e?t.style.right="0":t.style.left="0",t}}function h(e){const t=o.enabled("side_toolbar_in_fullscreen_mode"),i=o.enabled("header_in_fullscreen_mode");return"center"===e||"left"===e&&t||"top"===e&&i}},250378:(e,t,i)=>{"use strict";i.d(t,{BadRequestErrorResponse:()=>n});var r=i(867023);class n extends r.ErrorResponse{constructor(e){super(e),this.name="BadRequestError",e.error?this.message=e.error:this.message="unknown error"}}},867023:(e,t,i)=>{"use strict";i.d(t,{ErrorResponse:()=>r});class r{constructor(e){this._status=e.status,this._statusText=e.statusText||""}getInfo(){return{name:this.name,status:this._status,statusText:this._statusText,message:this.message}}}},729030:(e,t,i)=>{"use strict";i.d(t,{getSymbolData:()=>l});var r=i(803912),n=i(438874),s=i(250378),o=i(685503),a=i(159954);function l(e,t,i,l,c=!0,d=!1){const h=i.join(","),u=(0,n.getSymbolDataUrl)(t,h,l,c,d),_={signal:e,method:"GET",credentials:"include",headers:{Accept:"application/json"}};return(0,r.fetch)(u,_,{
logOnErrorStatus:!1}).then((e=>{if(400===e.status){const{status:t,statusText:i}=e;return e.json().then((e=>{const r=e.errmsg;throw new s.BadRequestErrorResponse({status:t,statusText:i,error:r})}))}if(404===e.status){const{status:t,statusText:i}=e;return e.json().then((r=>{if("symbol_not_exists"===r.code){const e=r.errmsg;throw new a.SymbolDoesNotExistErrorResponse({status:t,statusText:i,error:e})}throw new o.HttpErrorResponse(e)}))}if(e.ok)return e.json().then((e=>e));throw new o.HttpErrorResponse(e)}))}},685503:(e,t,i)=>{"use strict";i.d(t,{HttpErrorResponse:()=>n});var r=i(867023);class n extends r.ErrorResponse{constructor(e){super(e),this.name="HttpErrorResponse",this._status>=200&&this._status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`}}},159954:(e,t,i)=>{"use strict";i.d(t,{SymbolDoesNotExistErrorResponse:()=>n});var r=i(867023);class n extends r.ErrorResponse{constructor(e){super(e),this.name="SymbolDoesNotExistError",this.message=e.error||"symbol does not exist"}}},438874:(e,t,i)=>{"use strict";function r(){return window.SCREENER_HOST||"https://scanner.tradingview.com"}function n(e,t){const i=r();return t?`${i}/${t}/`:1===e.length?`${i}/${e[0]}/`:`${i}/global/`}function s(e,t,i,n,s){const o=r(),a={symbol:e,fields:t};n&&(a.no_404="true"),s&&(a.price_conversion="disabled"),i&&(a["label-product"]=i);const l=new URL(`${o}/symbol`);return Object.keys(a).forEach((e=>{l.searchParams.append(e,a[e])})),l.toString()}function o(e,t){return`${r()}/enum?id=${e}&lang=${t||window.language||"en"}`}function a(e,t){return`${r()}/enum/ordered?id=${e}&lang=${t||window.language||"en"}`}i.d(t,{getBackendUrl:()=>n,getEnumOrderedRegistryUrl:()=>a,getEnumRegistryUrl:()=>o,getSymbolDataUrl:()=>s})},372006:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SupportTicketData:()=>C});var r=i(803912),n=i(849289),s=i.n(n),o=i(569897),a=i(699576),l=i(314802),c=i(638456),d=i(131089),h=i(582950),u=i(735566),_=i(136734),g=i(734489),p=i(792598),m=(i(659863),i(125226)),f=i(262078),v=i(62802);function y(e){const t={name:e.name,time:e.startTime};return"measure"===e.entryType&&(t.duration=e.duration),t}function S(){const e=navigator.connection;return{effectiveType:e&&e.effectiveType||"unknown",rtt:e&&e.rtt||-1}}var b=i(184026);const w=(0,u.getLogger)("Support.TicketData");class C{constructor(e={}){this._options=e,this.reset()}destroy(){delete this._data,delete this._browserInfo,delete this._dialogElement}reset(){this._data={event:"support_ticket",screenshotAgree:!0},this._browserInfo=new(s())}setOptions(e){this._options={...this._options,...e}}getData(){return this._data}addData(e){Object.assign(this._data,e)}setDialogElement(e){this._dialogElement=e}async getFinalData(){if(void 0!==this._beforeCollectingFinalData&&(await this._beforeCollectingFinalData(),this._data.snapshotData)){try{const{data:e,width:t,height:i}=this._data.snapshotData;this._data.pageSnapshotURL=await(0,d.uploadSnapshot)(`data:image/png;base64,${e}`,t,i)}catch(e){
w.logError(`${e}`)}delete this._data.snapshotData}const e=this._options.disableAutoCollection?this.getData():await this._collectData();return e?.tradingLogsAgree&&!e.trading&&(e.trading=this._getMinimalTradingLogs()),(0,h.isTicketDataComplete)(e)?e:(w.logError("Not enough data collected. `event` and one of (`userId`, `email`) fields required."),null)}onBeforeCollectingFinalData(e){this._beforeCollectingFinalData=e}tradingDataPromise(){return this._tradingDataPromise}onTradingData(e){this._tradingDataPromise=e}static setChartWidgetCollection(e){C._chartWidgetCollection=e}static getChartWidgetCollection(){return C._chartWidgetCollection}static setScreener(e){C._screener=e}static getScreener(){return C._screener}static setNewScreenerStandalone(e){C._newScreenerStandalone=e}static getNewScreenerStandalone(){return C._newScreenerStandalone}async _collectData(){this.addData(this._filterEmptyFields({browserInfo:this._getBrowserInfo(),ping:this._getPingInfo(),user:this._getUser(),userId:this._getUserId(),pro_plan:this._getProPlan(),websocketAddress:this._getWebSocketAddress(),sessionid:this._getSessionId(),ref:this._getReferrer(),js_errors:this._getJsErrors(),product:this._getProductId(),symbolSessionId:this._getSymbolSessionId(),dividendsAdjustment:this._getDividendsAdjustment(),backAdjustment:this._getBackAdjustment(),settlementAsClose:this._getSettlementAsClose(),chartSessionDisconnects:this._getChartSessionDisconnects(),marketStatuses:this._getChartMarketStatuses(),seriesStatuses:this._getChartSeriesStatuses(),is_pro:this._getUserIsPro(),subscription_state:this._getSubscriptionState(),proOffers:this._getProOffers(),timezone:this._getTimezone(),performanceMetrics:this._getPerformanceMetrics(),serverInfo:this._getServerInfo(),serverTimeOffset:this._getServerTimeOffset(),settings:this._getUserSettings(),domNodesCount:this._getDomNodesCount(),buildTime:this._getBuildTime(),plugins:this._getPlugins(),locale:this._getLocale(),featuretoggles:this._getFeaturetoggles()}));const e=await Promise.allSettled([this._getChartSnapshot(),this._getTradingLogs(),this._getScreenerParams(),this._getLogHistory(),this._getPersistentLogHistory(),this._getDesktopReports(),this._getAlertHealthchecks(),this._getNewScreenerStandaloneParams(),this._getPageSnapshot()]);return this.addData(this._filterEmptyFields({snapshotURL:"fulfilled"===e[0].status?e[0].value:null,trading:"fulfilled"===e[1].status?e[1].value:null,screener:"fulfilled"===e[2].status?e[2].value:null,log:"fulfilled"===e[3].status?e[3].value:null,persistentLogs:"fulfilled"===e[4].status?e[4].value:null,desktopReports:"fulfilled"===e[5].status?e[5].value:null,alertHealthchecks:"fulfilled"===e[6].status?e[6].value:null,newScreenerStandaloneState:"fulfilled"===e[7].status?e[7].value:null,pageSnapshotURL:"fulfilled"===e[8].status?e[8].value:null})),this._data}_getBrowserInfo(){return this._browserInfo.state()}async _getChartSnapshot(){const e=C.getChartWidgetCollection();if(void 0===e)return w.logWarn("Abort generating snapshot. No chartWidgetCollection found."),null
;g.forceTradingObjVisibilityOnScreenshot.setValue(!0);try{const t=await(0,o.takeChartSnapshotPromise)(e,{showHeaderMainSymbol:!0});return`${location.protocol}//${location.host}/x/${t}`}catch{return w.logError("Failed to take chart snapshot."),g.forceTradingObjVisibilityOnScreenshot.setValue(null),null}}_getMinimalTradingLogs(){return JSON.stringify({deviceId:(0,p.getDeviceId)()})}async _getTradingLogs(){if(!this._data.tradingLogsAgree)return w.logWarn("Abort collecting trading logs. User did not agree to send trading logs."),null;const e=(0,a.tradingService)();if(!e)return w.logWarn("Abort collecting trading logs. No trading object found."),null;const t=e.activeBroker();if(null===t||!t.bugReportInfo||1!==t.connectionStatus())return w.logWarn("Abort collecting trading logs because of connection or abscence of info collection method."),null;try{const e=await t.bugReportInfo();return JSON.stringify(e)}catch(e){return w.logError(`Error while collecting activeBroker info: ${e}`),null}}async _getScreenerParams(){const e=C.getScreener();return void 0===e?(w.logWarn("Abort collecting screener params. No screener found."),null):e.getCurrentState()}async _getNewScreenerStandaloneParams(){const e=C.getNewScreenerStandalone();return e?e.getCurrentStateStringified():(w.logWarn("Abort collecting new screener standalone params. No new screener standalone found."),null)}async _performHealthCheck(e,t,i="GET"){const n=Date.now();try{const s=await(0,r.fetch)(t,{method:i});return{title:e,status:s.status,responseTime:Date.now()-n,responseSize:s.headers.get("content-length")||"unknown"}}catch{return{title:e,status:0,responseTime:Date.now()-n}}}async _getAlertHealthchecks(){return this._data.issueType!==h.TVOnlyActiveIssueType.Alert?null:Promise.all([this._performHealthCheck("alert_facade","https://pricealerts.tradingview.com/is_alive","POST"),this._performHealthCheck("old_alerts","https://alerts.tradingview.com/alerts/health/"),this._performHealthCheck("pine_facade","https://pine-facade.tradingview.com/pine-facade/is_auth_to_get/STD%3BSMA/last")])}_getProductId(){return(0,l.isOnMobileAppPage)("old")?"ios":(0,l.isOnMobileAppPage)("new")?"android":(0,c.isDesktopApp)()?"desktop":(0,c.isSymphonyEmbed)()?"symphony":"tv"}_getSymbolSessionId(){const e=C.getChartWidgetCollection();if(!e)return w.logWarn("Abort getting sessionId property value. No chartWidgetCollection found."),null;let t;try{t=e.activeChartWidget.value().model().mainSeries().properties().childs().sessionId.value()}catch(e){return w.logError(`Error while getting sessionId property value: ${e.message}`),null}return"string"==typeof t?t:null}_getDividendsAdjustment(){const e=C.getChartWidgetCollection();if(!e)return w.logWarn("Abort getting dividendsAdjustment property value. No chartWidgetCollection found."),null;let t;try{t=e.activeChartWidget.value().model().mainSeries().properties().childs().dividendsAdjustment.value()}catch(e){return w.logError(`Error while getting dividendsAdjustment property value: ${e.message}`),null}return"boolean"==typeof t?t:null}_getBackAdjustment(){
const e=C.getChartWidgetCollection();if(!e)return w.logWarn("Abort getting backAdjustment property value. No chartWidgetCollection found."),null;let t;try{t=e.activeChartWidget.value().model().mainSeries().properties().childs().backAdjustment.value()}catch(e){return w.logError(`Error while getting backAdjustment property value: ${e?.message}`),null}return"boolean"==typeof t?t:null}_getSettlementAsClose(){const e=C.getChartWidgetCollection();if(!e)return w.logWarn("Abort getting settlementAsClose property value. No chartWidgetCollection found."),null;let t;try{t=e.activeChartWidget.value().model().mainSeries().properties().childs().settlementAsClose.value()}catch(e){return w.logError(`Error while getting settlementAsClose property value: ${e?.message}`),null}return"boolean"==typeof t?t:null}_getChartSessionDisconnects(){return window.ChartApiInstance?window.ChartApiInstance.disconnectCount():(w.logWarn("Abort getting chart session disconnects count. No ChartApiInstance found."),null)}_getChartMarketStatuses(){const e=C.getChartWidgetCollection();return e?e.chartMarketStatuses():(w.logWarn("Abort getting market statuses. No chartWidgetCollection found."),[])}_getChartSeriesStatuses(){const e=C.getChartWidgetCollection();return e?e.chartSeriesStatuses():(w.logWarn("Abort getting series statuses. No chartWidgetCollection found."),[])}_getUserIsPro(){return Boolean(window.user&&window.user.is_pro)}_getSubscriptionState(){return(0,b.isPaidPro)(window.user)?h.SubscriptionState.IsPro:window.user.had_pro?h.SubscriptionState.ExPro:void 0}_getProOffers(){return window.pro&&window.pro.offers&&window.pro.offers()||[]}_getTimezone(){const e=C.getChartWidgetCollection();if(!e)return w.logWarn("Abort getting timezone. No chartWidgetCollection found."),null;let t=null;try{t=e.activeChartWidget.value().model().model().properties().childs().timezone.value()}catch(e){w.logError(`Error while getting timezone: ${e.message}`)}return t}_getPerformanceMetrics(){return function(){if(!window.performance||!performance.getEntriesByType)return null;const e=performance.getEntriesByType("navigation");if(0===e.length)return null;const t=e[0];let i=performance.getEntriesByType("mark");i=i.slice(Math.max(i.length-1e3,0));let r=performance.getEntriesByType("paint");r=r.slice(Math.max(r.length-1e3,0));let n=performance.getEntriesByType("measure");return n=r.slice(Math.max(n.length-1e3,0)),{connection:S(),navigation:t.toJSON&&t.toJSON()||"unknown",paints:r.map(y),marks:i.map(y),measures:n.map(y),pushstream:{statusPublic:f.pushStreamMultiplexer.status(),statusPrivate:f.pushStreamMultiplexer.statusPrivate()}}}()}_sortLogs(e,t){return e.timestamp-t.timestamp}async _getLogHistory(){let e;try{let t=(0,u.getRawLogHistory)();f.pushStreamMultiplexer.ownPushStream()||(t=t.concat(await f.pushStreamMultiplexer.getLogs())),e=t.sort(this._sortLogs).map(u.serializeLogHistoryEntry).join("\n").slice(-8e6)}catch(t){w.logWarn(`Error while collecting log history: ${t.message}`),e=JSON.stringify({error:"logger.getLogHistory(maxLen) failed: "+t.message,stack:t.stack})}
return e}async _getPersistentLogHistory(){const e=await((0,_.getPersistentLogger)()?.getLastSessions(5))??[];return e.forEach((e=>e.entries=e.entries.slice(-8e6))),e}async _getDesktopReports(){return window.TVD&&window.TVD.getReports?window.TVD.getReports():null}_getPingInfo(){if(!window.ChartApiInstance)return w.logWarn("Abort getting chart session disconnects count. No ChartApiInstance found."),[];const e=window.ChartApiInstance.getPingInfo();return null!==e?[e.min,e.max,e.avg]:[]}_getUserId(){return window.user&&window.user.id?window.user.id:null}_getUser(){return window.user&&window.user.username||"Guest"}_getProPlan(){return window.user&&window.user.pro_plan&&"free"!==window.user.pro_plan?window.user.pro_plan:null}_getWebSocketAddress(){return window.WSBackendConnection?window.WSBackendConnection.getHost():(w.logWarn("Abort getting websocket address. No WSBackendConnection found."),null)}_getSessionId(){return window.ChartApiInstance?window.ChartApiInstance.sessionid:(w.logWarn("Abort getting websocket address. No ChartApiInstance found."),null)}_getReferrer(){return location.href}_getJsErrors(){return window.__tv_js_errors.slice(0,10)}_filterEmptyFields(e){const t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];null!=r&&(!Array.isArray(r)||r.length>0)&&(t[i]=r)}return t}_getServerInfo(){const e=document.querySelector('meta[name="tv:server-name"]');return null!==e?e.getAttribute("content"):null}_getServerTimeOffset(){return window.ChartApiInstance?String(Math.round(window.ChartApiInstance.serverTime()-Date.now()))+"s":(w.logWarn("Abort getting server time offset. No ChartApiInstance found."),null)}_getUserSettings(){{const e=v.default.keys().reduce(((e,t)=>{const i=v.default.getValue(t);if(i)try{e[t]=JSON.parse(i)}catch(r){e[t]=i}return e}),{});return JSON.stringify(e).slice(0,5e5)}}_getDomNodesCount(){return document.querySelectorAll("*").length}async _getPageSnapshot(){if(!this._data.screenshotAgree||!(0,l.isOnMobileAppPage)("new"))return null;const e=await Promise.all([i.e(59928),i.e(142)]).then(i.bind(i,311702)),t={logging:!1,ignoreElements:e=>e===this._dialogElement,querySelectorForSnapshot:""};document.getElementById("js-screener-container")?t.querySelectorForSnapshot="#js-screener-container":document.getElementById("js-market-heatmap")&&(t.querySelectorForSnapshot="#js-market-heatmap");try{const i=await e.generateHtml2CanvasSnapshot(t);return i?(0,d.uploadSnapshot)(i.data,i.width,i.height):null}catch(e){return w.logError(`Failed to make page snapshot: ${e}`),null}}_getBuildTime(){return window.BUILD_TIME}_getPlugins(){return void 0!==navigator.plugins?Array.from(navigator.plugins).map((e=>({name:e.name,filename:e.filename,description:e.description}))):[]}_getLocale(){return window.language??"en"}_getFeaturetoggles(){return Object.keys(window.featureToggleState??{}).reduce(((e,t)=>(e[t]=(0,m.isFeatureEnabled)(t),e)),{})}}},582950:(e,t,i)=>{"use strict";var r,n,s,o,a,l,c,d,h,u,_;function g(e){return null!==e&&void 0!==e.event&&void 0!==e.userId||null!==e&&void 0!==e.email}i.d(t,{
AdditionalIssueType:()=>a,CoreActiveIssueType:()=>r,CoreLegacyIssueType:()=>n,FieldName:()=>_,FreshdeskProduct:()=>u,SatisfactionStatus:()=>h,SubscriptionState:()=>l,TVOnlyActiveIssueType:()=>s,TVOnlyLegacyIssueType:()=>o,TicketNoteState:()=>c,TicketPublicStatus:()=>d,isTicketDataComplete:()=>g}),function(e){e.Chart="Chart",e.Trading="Trading issue",e.Indicators="Indicators",e.Drawings="Drawings"}(r||(r={})),function(e){e.Other="Other",e.DrawingIssue="Drawings issue",e.StudyNotLoading="Study not loading",e.SlowChart="Slow scrolling or chart loading"}(n||(n={})),function(e){e.Billing="Billing",e.Data="Data",e.PineScript="Pine Script issue",e.Alert="Alerts issue",e.Screener="Screener",e.SocialNetwork="Social network",e.Watchlist="Watchlist",e.MobileApps="Mobile apps",e.Desktop="Desktop",e.Financials="Financials",e.ProfileSettings="Profile settings",e.Heatmap="Heatmap",e.AccountRecovery="Account recovery",e.Blackfriday="Black Friday",e.Cybermonday="Cyber Monday",e.PaymentSearch="Payment search",e.Options="Options",e.PineSeeds="Pine Seeds",e.News="News"}(s||(s={})),function(e){e.Unsubscribe="Unsubscribe",e.ChartDoesNotLoad="Chart does not load",e.NoRealTimeData="No real-time data",e.GapInTheData="Gap in the data",e.PriceIncorrect="Price incorrect"}(o||(o={})),function(e){e.Refund="Refund"}(a||(a={})),function(e){e.IsPro="Is PRO",e.ExPro="Ex-PRO"}(l||(l={})),function(e){e.FromAgent="0",e.FromUser="2"}(c||(c={})),function(e){e.Received="Received",e.InProgress="In Progress",e.Closed="Closed"}(d||(d={})),function(e){e[e.Good=103]="Good",e[e.Average=100]="Average",e[e.Bad=-103]="Bad"}(h||(h={})),function(e){e[e.Production=43000002188]="Production",e[e.ProductionFree=43000002552]="ProductionFree",e[e.ProductionRefunds=43000007194]="ProductionRefunds",e[e.Staging=43000002187]="Staging",e[e.StagingFree=43000002553]="StagingFree",e[e.StagingRefunds=43000007193]="StagingRefunds"}(u||(u={})),function(e){e.IssueType="issue-type",e.Alert="alert",e.Broker="broker",e.TicketOrderId="ticket-order-id",e.Description="description",e.PineScript="pine-script",e.Attachments="attachments",e.TradingLogsAgree="trading-agree",e.PageScreenshotAgree="page-screenshot-agree",e.PineRepo="pine-repo"}(_||(_={}))},163482:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TECHNICALS_QS_FIELDS:()=>r,TECHNICALS_SCREENER_COLUMNS:()=>l,requiredMAColumns:()=>o,requiredOscColumns:()=>s,requiredPivotsColumns:()=>a,requiredRecommendColumns:()=>n})
;const r=["type","listed_exchange","pricescale","typespecs","pro_name","short_name"],n=["Recommend.Other","Recommend.All","Recommend.MA"],s=["RSI","Stoch.K","CCI20","ADX","AO","Mom","MACD.macd","Stoch.RSI.K","W.R","BBPower","UO"],o=["EMA10","SMA10","EMA20","SMA20","EMA30","SMA30","EMA50","SMA50","EMA100","SMA100","EMA200","SMA200","Ichimoku.BLine","VWMA","HullMA9"],a=["Pivot.M.Classic.R3","Pivot.M.Classic.R2","Pivot.M.Classic.R1","Pivot.M.Classic.Middle","Pivot.M.Classic.S1","Pivot.M.Classic.S2","Pivot.M.Classic.S3","Pivot.M.Fibonacci.R3","Pivot.M.Fibonacci.R2","Pivot.M.Fibonacci.R1","Pivot.M.Fibonacci.Middle","Pivot.M.Fibonacci.S1","Pivot.M.Fibonacci.S2","Pivot.M.Fibonacci.S3","Pivot.M.Camarilla.R3","Pivot.M.Camarilla.R2","Pivot.M.Camarilla.R1","Pivot.M.Camarilla.Middle","Pivot.M.Camarilla.S1","Pivot.M.Camarilla.S2","Pivot.M.Camarilla.S3","Pivot.M.Woodie.R3","Pivot.M.Woodie.R2","Pivot.M.Woodie.R1","Pivot.M.Woodie.Middle","Pivot.M.Woodie.S1","Pivot.M.Woodie.S2","Pivot.M.Woodie.S3","Pivot.M.Demark.R1","Pivot.M.Demark.Middle","Pivot.M.Demark.S1"],l=[...n,...s,...o,...a]},719885:(e,t,i)=>{"use strict";i.d(t,{TechnicalsDialogController:()=>c});var r=i(583912),n=i(584317),s=i(729030),o=i(254526),a=i(163482);let l;class c extends n.DialogRenderer{constructor(){super(...arguments),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)}}async show(e){const t=e?.symbol?e.symbol:r.linking.proSymbol.value();if(e?.snapshot){const{snapshot:i}=e,r=await this._loadModule();this._getDialog(r,{...e,symbol:t,...i,exchange:i.listed_exchange}).show()}else{const r=async()=>{const{snapshoter:e}=await i.e(51030).then(i.bind(i,795394));return e().getSnapshot(t,new Set(a.TECHNICALS_QS_FIELDS))},[n,s]=await Promise.all([this._loadModule(),r()]);if("error"===s.status)return void this._getDialog(n,{...e,symbol:t}).show();this._getDialog(n,{...e,symbol:t,...s.values,exchange:s.values.listed_exchange}).show()}}async canBeShown(e){const t=e||r.linking.proSymbol.value();if(!t)return!1;const n=new Set([...a.TECHNICALS_QS_FIELDS,"description"]),l=await(async()=>{const{snapshoter:e}=await i.e(51030).then(i.bind(i,795394));return e().getSnapshot(t,n)})();if("error"===l.status)return!1;const{values:{type:c,listed_exchange:d,description:h}}=l;if(!o.SYMBOL_TYPE_BLACK_LIST.has(c))try{const e=await(0,s.getSymbolData)(null,t,["Recommend.All"]);return Boolean(e&&0!==Object.keys(e).length&&h&&d&&c)}catch(e){return!1}return!1}hide(){this._dialog?.hide()}static getInstance(){return l||(l=new c),l}_getDialog(e,t){return this._dialog?.hide(),this._dialog?.visible().unsubscribe(this._subscribe),this._dialog=new e.TechnicalsDialogRenderer(t),this._dialog.visible().subscribe(this._subscribe),this._dialog}_loadModule(){
return Promise.all([i.e(7056),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(50874),i.e(20563),i.e(98158),i.e(38752),i.e(71450),i.e(34002),i.e(97540),i.e(25563),i.e(72232),i.e(19365),i.e(48197),i.e(59546),i.e(51513),i.e(34943),i.e(11058),i.e(76848),i.e(23399),i.e(45512),i.e(36463),i.e(21639),i.e(28828),i.e(90783),i.e(53987),i.e(32227),i.e(17619),i.e(14337),i.e(97829),i.e(71138)]).then(i.bind(i,948549))}}},487381:(e,t,i)=>{"use strict";i.d(t,{setupTrackingModePopupHint:()=>l});var r=i(62802),n=i(87913),s=i(638456),o=i(345848),a=i(213377);function l(e){if(!s.CheckMobile.any()||Boolean(r.getBool("hint.trackingMode"))||!a.enabled("popup_hints"))return;const t=s=>{const a=n.tool.value();((0,n.toolIsCursor)(a)||"eraser"===a)&&(s.preventDefault(),s.stopPropagation(),Promise.all([i.e(30625),i.e(92537),i.e(98185),i.e(18883),i.e(32937),i.e(46195),i.e(43776),i.e(32227),i.e(62526),i.e(35174)]).then(i.bind(i,416108)).then((e=>{e.render(document.createElement("div"),(()=>{r.setValue("hint.trackingMode",!0,{forceFlush:!0}),(0,o.trackEvent)("GUI","Tracking Mode")}))})),e.removeEventListener("touchstart",t,!0))};e.addEventListener("touchstart",t,!0)}},24958:(e,t,i)=>{"use strict";i.d(t,{TradingBootloader:()=>h});var r=i(564894),n=i(510013),s=i(62802),o=i(893935),a=i(213377),l=i(624505),c=i(533126),d=i(712580);class h extends n.ChunkLoader{constructor(e){super(),this._options=e,this._options.resizerBridge.container.value().classList.add(d.rootContainer);const t=s.default.getBool(l.settingsKeys.TRADING_PANEL_OPENED,a.enabled("show_order_panel_on_start"));window.is_authenticated&&!(0,o.isMobileTradingAvailable)()&&t&&(this._options.resizerBridge.negotiateWidth(s.default.getInt(l.settingsKeys.PANEL_WIDTH)||c.minPanelWidth),this._options.resizerBridge.negotiateHeight(c.panelHeight))}async _startLoading(){return this._loadTrading()}async _loadTrading(){
const{resizerBridge:e,chartWidgetCollection:t}=this._options,[{TRADING_SERVICE:n},{Trading:s},{TradingNotificationsHandler:o}]=await Promise.all([Promise.all([i.e(92041),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(90579),i.e(50874),i.e(61171),i.e(67780),i.e(95679),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(98158),i.e(40887),i.e(97540),i.e(25563),i.e(3359),i.e(19715),i.e(72232),i.e(71803),i.e(49760),i.e(82279),i.e(14100),i.e(24973),i.e(55033),i.e(78836),i.e(6061),i.e(18639),i.e(92874),i.e(95275),i.e(51979),i.e(93014),i.e(42387),i.e(31848),i.e(75728),i.e(74112),i.e(1934),i.e(73022),i.e(47479),i.e(96231),i.e(32227),i.e(91276),i.e(12635),i.e(68283),i.e(37009),i.e(52868),i.e(3060),i.e(53961),i.e(13726),i.e(1853),i.e(47286),i.e(25142)]).then(i.bind(i,699576)),Promise.all([i.e(92041),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(90579),i.e(50874),i.e(61171),i.e(67780),i.e(95679),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(98158),i.e(40887),i.e(97540),i.e(25563),i.e(3359),i.e(19715),i.e(72232),i.e(71803),i.e(49760),i.e(82279),i.e(14100),i.e(24973),i.e(55033),i.e(78836),i.e(6061),i.e(18639),i.e(92874),i.e(95275),i.e(51979),i.e(93014),i.e(42387),i.e(31848),i.e(75728),i.e(74112),i.e(1934),i.e(73022),i.e(47479),i.e(96231),i.e(32227),i.e(91276),i.e(12635),i.e(68283),i.e(37009),i.e(52868),i.e(3060),i.e(53961),i.e(13726),i.e(1853),i.e(47286),i.e(25142)]).then(i.bind(i,504761)),Promise.all([i.e(92041),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(90579),i.e(50874),i.e(61171),i.e(67780),i.e(95679),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(98158),i.e(40887),i.e(97540),i.e(25563),i.e(3359),i.e(19715),i.e(72232),i.e(71803),i.e(49760),i.e(82279),i.e(14100),i.e(24973),i.e(55033),i.e(78836),i.e(6061),i.e(18639),i.e(92874),i.e(95275),i.e(51979),i.e(93014),i.e(42387),i.e(31848),i.e(75728),i.e(74112),i.e(1934),i.e(73022),i.e(47479),i.e(96231),i.e(32227),i.e(91276),i.e(12635),i.e(68283),i.e(37009),i.e(52868),i.e(3060),i.e(53961),i.e(13726),i.e(1853),i.e(47286),i.e(25142)]).then(i.bind(i,509387))]),a=new s(e,this._options.bottomWidgetBarSettled);return r.registerService(n,a),void 0!==t&&a.setChartWidgetCollection(t),new o(a),a}}},477600:(e,t,i)=>{"use strict";i.d(t,{createStubElem:()=>n});var r=i(872877);function n(e=[],t=[]){const i=document.createElement("div"),n=document.createElement("div");return i.appendChild(n),i.classList.add(r.container),n.classList.add(r.inner),e.forEach((e=>{i.classList.add(r[e])})),t.forEach((e=>{i.classList.add(r[e])})),i}},100148:(e,t,i)=>{"use strict";function r(e,t){const i=e.dataSourceForId(t);if(null===i)throw new Error(`Chart has no study or shape with id "${t}"`);return i}i.d(t,{SelectionApi:()=>n});class n{constructor(e){this._model=e}add(e){Array.isArray(e)?this._model.selectionMacro((t=>{e.map(r.bind(null,this._model)).forEach((e=>t.addSourceToSelection(e)))})):this.add([e])}canBeAddedToSelection(e){const t=r(this._model,e)
;return this._model.selection().canBeAddedToSelection(t)}set(e){Array.isArray(e)?this._model.selectionMacro((t=>{t.clearSelection(),e.map(r.bind(null,this._model)).forEach((e=>t.addSourceToSelection(e)))})):this.set([e])}remove(e){Array.isArray(e)?this._model.selectionMacro((t=>{e.map(r.bind(null,this._model)).forEach((e=>t.removeSourceFromSelection(e)))})):this.remove([e])}contains(e){const t=r(this._model,e);return this._model.selection().isSelected(t)}allSources(){return this._model.selection().dataSources().map((e=>e.id()))}isEmpty(){return this._model.selection().isEmpty()}clear(){this._model.selectionMacro((e=>{e.clearSelection()}))}onChanged(){return this._model.onSelectedSourceChanged()}}},503595:(e,t,i)=>{"use strict";i.d(t,{asyncWindowOpen:()=>a});var r=i(314802),n=i(638456),s=i(444372),o=i(23482);function a(e,t,a){return window.TVD||(0,r.isOnMobileAppPage)("any")||"_self"===t||(0,n.isSymphonyEmbed)()?function(e,t,i){return e.then((e=>{void 0!==e&&open(e,t,i)}),(()=>{}))}(e,t,a):async function(e,t,r){const n=URL.createObjectURL(new Blob([`<!doctype html><html style="background-color:${getComputedStyle(document.documentElement).backgroundColor}"><head><meta charset="utf-8"><title>${s.t(null,void 0,i(493292))}</title></head><body style="background-color:${getComputedStyle(document.body).backgroundColor}"></body></html>`],{type:"text/html"}));try{o.isIOS&&await new Promise((e=>setTimeout(e)));const i=open(n,t,r);if(!i)throw new Error("cound not open a new tab");const s=await e.catch((()=>{}));void 0!==s?i.location.replace(s):i.close()}finally{URL.revokeObjectURL(n)}}(e,t,a)}},849289:(e,t,i)=>{"use strict";var r,n,s,o=i(77034);function a(){return r||(this instanceof a?void(r=this):new a)}a.prototype.browser=function(){return n||(n=o.name+" "+o.version),n},a.prototype.setBrowser=function(e){"string"==typeof e&&e&&(n=e)},a.prototype.os=function(){if(!s){var e=Object.keys(o);s=["mac","windows","windowsphone","linux","chromeos","android","ios","blackberry","firefoxos","webos","bada","tizen","sailfish"].filter((function(t){return e.includes(t)}))[0]}return s},a.prototype.setOS=function(e){"string"==typeof e&&e&&(s=e)},a.prototype.cookieEnabled=function(){return navigator.cookieEnabled},a.prototype.viewportSize=function(){return document.documentElement.clientWidth+" x "+document.documentElement.clientHeight},a.prototype.screenSize=function(){return window.screen&&(screen.width||screen.availWidth)+" x "+(screen.height||screen.availHeight)||"unknown"},a.prototype.colorDepth=function(){return window.screen&&screen.colorDepth||"unknown"},a.prototype.pixelRatio=function(){return window.devicePixelRatio||0},a.prototype.wsTestResult=function(){return"Pending"},a.prototype.maxTouchPoints=function(){return navigator.maxTouchPoints||0},a.prototype.orientation=function(){return"onorientationchange"in window},a.prototype.touchevents=function(){return"ontouchstart"in window},a.prototype.hover=function(){try{return window.matchMedia("(any-hover: hover)").matches}catch(e){return null}},a.prototype.state=function(){return{
os:this.os(),browser:this.browser(),cookieEnabled:this.cookieEnabled(),viewportSize:this.viewportSize(),screenSize:this.screenSize(),colorDepth:this.colorDepth(),pixelRatio:this.pixelRatio(),maxTouchPoints:this.maxTouchPoints(),orientation:this.orientation(),touchevents:this.touchevents(),hover:this.hover()}},e.exports=a},510013:(e,t,i)=>{"use strict";i.d(t,{ChunkLoader:()=>n});var r=i(904653);class n{constructor(){this._retries=5,this._cache=null,this._tryLoad=(e,t)=>{this._retries=this._retries-1;this._startLoading(e).then(t,0!==this._retries?i=>{(0,r.isAbortError)(i)||setTimeout((()=>this._tryLoad(e,t)),3e3)}:void 0)}}load(e){return this._cache||(this._cache=new Promise(this._tryLoad.bind(this,e??null))),this._cache}}},84004:(e,t,i)=>{"use strict";i.d(t,{addIDCCodes:()=>l});var r=i(803912),n=i(444372),s=(i(142492),i(345848)),o=i(261963),a=i(228931);function l(e){return(0,s.trackEvent)("IDC Add Delay Service","Agreed",e),(0,r.fetch)(`/idc-add-delay-service/${e}/`,{credentials:"include"}).then((e=>e.json())).then((e=>e.res===o.SymbolAvailabilityCodes.OK?0:1)).catch((()=>(function(e){(0,a.showNoticeDialog)({title:n.t(null,void 0,i(91940)),content:n.t(null,void 0,i(882369)).format({exchange:e.toUpperCase()})})}(e),Promise.resolve(1))))}},746849:(e,t,i)=>{"use strict";i.d(t,{checkIfExchangeAvailable:()=>s,isUserNeedSignAgreement:()=>n});i(142492);var r=i(406103);function n(e){if(!(0,r.isIDCExchange)(e))return!1;e=o(e);const t=window.pro,i=t.getProduct(e);return void 0!==i.idc_service_codes_delay&&((!Array.isArray(i.included_exchanges)||!i.included_exchanges.some((e=>t.hasPackage(o(e)))))&&!function(e){const t=window.pro;return t.hasPackage(e)||t.hasPackage(e+"_dly")}(e))}function s(e){const t=window.pro;return new Promise((i=>{window.is_authenticated?!t.getIDCExchanges(!0).length||t.isInvalidShopConf()?t.updateShopConf().then((()=>{i(!n(e))})).catch((()=>{i(!0)})):i(!n(e)):i(!0)}))}function o(e){return e.startsWith("exchange-")?e:"exchange-{0}".format(e.toLowerCase())}},572104:(e,t,i)=>{"use strict";i.d(t,{BIST_MIXED_KEY:()=>h,checkBrokerageBist:()=>_,vorAgreementDialog:()=>g});var r=i(226722),n=i(749028),s=i(486481),o=i(464463);var a=i(735566);const l=(0,s.subscriptionNotification)(),c=(0,a.getLogger)("VorAgreementDialog"),d=()=>{},h="bist_mixed",u=["INFOYATIRIM","OSMANLI"];function _(e){u.includes(e)&&g(h)}async function g(e,t=!1){try{if(t)return void p(t);const i=await(0,n.isSignedExchangeAgreement)({exchange:e});if(i.response)return;p()}catch(e){c.logError(e.message)}}async function p(e=!1){!async function(e){
const{ShowAgreementDialogImpl:t}=await Promise.all([i.e(48349),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(11069),i.e(65743),i.e(67780),i.e(95679),i.e(14391),i.e(76052),i.e(43329),i.e(27702),i.e(13485),i.e(79317),i.e(69965),i.e(38490),i.e(59546),i.e(63585),i.e(94036),i.e(26070),i.e(10330),i.e(75316),i.e(29481),i.e(61360),i.e(66193),i.e(15878),i.e(837),i.e(17637),i.e(32227),i.e(21202),i.e(13905),i.e(31021),i.e(99431),i.e(44863),i.e(8302)]).then(i.bind(i,254610));t(e)}({isUpdateRequired:e,onConfirm:()=>{(0,o.showExchangeAgreementDialog)({onClose:()=>{e||l.emit({type:s.SubscriptionEventType.AgreementSigned}),window.user.market_profile_updated_timestamp=void 0,window.sessionStorage.setItem("market_profile_updated","true"),r.TVXWindowEvents.emit(s.SubscriptionEventType.MarketProfileDataUpdated)},isExpert:"pro"===window.user.declared_status,hideCloseButton:!0,isUpdateRequired:e})},onClose:d})}},406103:(e,t,i)=>{"use strict";i.d(t,{isIDCExchange:()=>n});var r=i(184026);function n(e,t=!1){if(e&&e.startsWith("exchange-"))return function(e,t=!1){const i=window.pro?.getProduct(e);return!(void 0===i||!(0,r.isProductDefined)(i)||(t?!i.idc_service_codes_delay:!i.idc_service_codes))}(e,t);const i=(e||"").toLowerCase();return window.pro?.getIDCExchanges(t)?.includes(i)??!1}},370504:(e,t,i)=>{"use strict";i.d(t,{isSymbolAvailable:()=>w,requestFallbackSymbol:()=>C});var r=i(599612),n=i(967542),s=i(345848),o=i(47312);var a=i(84004);const l=window.pro;function c(e){return new Promise((t=>{if(!(e=e&&e.toLowerCase()))return void t(!1);if((0,o.isOpenedModals)())return void t(!1);let r=!1;(0,n.createIdcDelayAddServiceDialog)().then((n=>{n.open(),n.on("afterOpen",(()=>{(0,s.trackEvent)("IDC Add Delay Service","Dialog Shown",e)})),n.on("afterClose",(()=>{r||t(!1)})),n.on("action:add-service",(n=>{r=!0,n.destroy(),(0,a.addIDCCodes)(e).then((e=>{0===e?(l.invalidateShopConf(),l.updateShopConf(),async function(){const{showSubscriptionHasBeenChangedDialog:e}=await Promise.all([i.e(63228),i.e(92537),i.e(39759),i.e(18883),i.e(52186),i.e(19190),i.e(98681),i.e(67131),i.e(82332),i.e(94036),i.e(33595),i.e(7276),i.e(51989),i.e(97598),i.e(32227),i.e(59844),i.e(87288),i.e(30870)]).then(i.bind(i,287023));e({pushReload:!0})}(),t(!0)):t(!1)}))}))}))}))}var d=i(406103),h=i(712787),u=i(178100);const _=["ls"];var g=i(261963);var p=i(707934),m=i(583912),f=i(416234),v=i(125226);var y=i(572104),S=i(779372),b=i(212363);function w(e,t){return(0,r.check)(e).then((()=>(function(e){if((0,v.isFeatureEnabled)("force_to_upgrade_to_expert")&&window.user.force_to_upgrade)return void(0,S.showUpgradeToProDialog)({isForcedToUpgrade:window.user.force_to_upgrade});if((0,v.isFeatureEnabled)("force_to_complete_data")&&window.user.force_to_complete_data)return void(0,y.vorAgreementDialog)();const t=function(){if(window.user.market_profile_updated_timestamp&&!window.sessionStorage.getItem("market_profile_updated")){
const e=(new Date).getTime()-1e3*window.user.market_profile_updated_timestamp;return Math.floor(e/1e3/60/60/24/365)>0}return!1}();t&&(0,y.vorAgreementDialog)(void 0,t);if(!e)return;const i=window.pro.getUserExchangeByPerm(e);if((0,v.isFeatureEnabled)("required_agreement_for_rt")&&i){const{exchange_agreement:t,idc_service_codes:r,exchange_agreement_expert:n}=i;if(r)return;const s=(n||t)??e;return void(0,y.vorAgreementDialog)(s)}if(y.BIST_MIXED_KEY.startsWith(e)){window.pro.getUserExchangeByPerm(y.BIST_MIXED_KEY)&&(0,y.vorAgreementDialog)(y.BIST_MIXED_KEY)}}(t),!0))).catch((e=>{if(e.errCode===g.SymbolAvailabilityCodes.DELAY_NOT_AVAILABLE)(0,p.createGoProDialog)({feature:"idcFreeUser",closeOnOutsideClick:!1,goOnMarkets:!0});else if((0,d.isIDCExchange)(e.exchange)){if(e.errCode===g.SymbolAvailabilityCodes.NEED_SIGN_AGREEMENT)return t=e.exchange,new Promise((e=>{(t=t&&t.toLowerCase())?(0,o.isOpenedModals)()?e(!1):(0,n.createIdcDelayAgreementDialog)({exchange:t}).then((i=>{i.on("afterOpen",(()=>{(0,s.trackEvent)("IDC Delay","Dialog Shown",t)})),i.on("afterClose",(()=>{e(!1)})),i.on("action:sign-agreement",(()=>{window.saver.saveChartSilently(),(0,s.trackEvent)("IDC Delay","Go on Agreement",t)})),i.open()})):e(!1)}));if(e.errCode===g.SymbolAvailabilityCodes.NEED_ADD_SERVICE)return c(e.exchange)}var t;return Promise.resolve(!1)}))}function C(e,t){return new Promise((r=>{if("group_not_permitted"!==t.type)return void r(e);if(!t.symbolGroup)return void r(window.DEFAULT_SYMBOL);const n=t.symbolGroup,s=(0,u.isSfFlag)(n),a=(0,h.isMcxFlag)(n),l=(c=n,_.includes(c.toLowerCase()));var c,d;if(s||a||l){if((0,o.isOpenedModals)())return void r(window.DEFAULT_SYMBOL);d={exchange:(0,b.getExchange)(m.linking.proSymbol.value()),onSigninSuccess:()=>{r(e)},isRealtime:a},Promise.all([i.e(66766),i.e(92537),i.e(39759),i.e(18883),i.e(52186),i.e(19190),i.e(67131),i.e(82332),i.e(94036),i.e(33595),i.e(7276),i.e(51989),i.e(28569),i.e(32227),i.e(59844),i.e(87288),i.e(27901)]).then(i.bind(i,410778)).then((e=>e.createGoRegisterDialog(d))),w(e).then((t=>{t&&r(e)}))}const g=(0,f.getSymbolGroupData)(n);g?function(e){Promise.all([i.e(23682),i.e(92537),i.e(98185),i.e(18883),i.e(32937),i.e(46195),i.e(67131),i.e(34330),i.e(52671),i.e(32227),i.e(62526),i.e(87279)]).then(i.bind(i,534470)).then((t=>t.createAvailableExchangeDialog(e)))}({width:600,title:g.title,content:g.description,destroy:()=>r(window.DEFAULT_SYMBOL)}):r(window.DEFAULT_SYMBOL)}))}},599612:(e,t,i)=>{"use strict";i.r(t),i.d(t,{check:()=>l});var r=i(212363),n=i(803912),s=i(925470),o=i(746849),a=i(261963);function l(e,t=!0){return new Promise(((i,l)=>{const c=(0,r.getExchange)(e);c?(0,o.checkIfExchangeAvailable)(c).then((r=>r?i(e):(0,s.enabled)("IDC_AVAILABLE_DELAY")?t?void(0,n.fetch)(`/idc-sign-agreement-check/${c}/`,{credentials:"include"}).then((t=>t.json().then((t=>t.res===a.SymbolAvailabilityCodes.DELAY_NOT_AVAILABLE?l({exchange:c,errCode:t.res,reason:"delay not available",symbol:e}):t.res===a.SymbolAvailabilityCodes.NEED_SIGN_AGREEMENT?l({exchange:c,errCode:t.res,reason:"need sign agreement",
symbol:e}):t.res===a.SymbolAvailabilityCodes.NEED_ADD_SERVICE?l({exchange:c,errCode:t.res,reason:"need add service",symbol:e}):i(e))))).catch((()=>{i(e)})):i(e):l({exchange:c,errCode:a.SymbolAvailabilityCodes.DELAY_NOT_AVAILABLE,reason:"delay not available",symbol:e}))):i(e)}))}},261963:(e,t,i)=>{"use strict";i.d(t,{SymbolAvailabilityCodes:()=>r});const r=JSON.parse('{"OK":"OK","ERR":"ERR","SYMBOL_NOT_AVAILABLE_FOR_ANON":"SYMBOL_NOT_AVAILABLE_FOR_ANON","DELAY_NOT_AVAILABLE":"DELAY_NOT_AVAILABLE","NEED_SIGN_AGREEMENT":"NEED_SIGN_AGREEMENT","NEED_ADD_SERVICE":"NEED_ADD_SERVICE"}')},656130:(e,t,i)=>{"use strict";i.d(t,{generateChartUrl:()=>n});var r=i(314802);function n(e){const t=e.chartId?`/chart/${e.chartId}/`:"/chart/",i=new URL(t,location.href);return e.symbol&&i.searchParams.append("symbol",e.symbol),e.interval&&i.searchParams.append("interval",e.interval),e.style&&i.searchParams.append("style",e.style),(0,r.urlWithMobileAppParams)(i.href)}},975774:(e,t,i)=>{"use strict";i.d(t,{loadThemeOnChartInitialization:()=>o});var r=i(939926),n=i(308721),s=i(618856);async function o(e){await Promise.all(e.getAll().map(r.waitForModel));const t=(0,n.getCurrentTheme)().name;if(!e.chartModels().value().some((e=>null===e.model().getThemeNameIfStdTheme()))){const i=e.activeChartWidget.value().model().model().getThemeNameIfStdTheme();null!==i&&i!==t&&(0,s.loadTheme)(e,{themeName:t,standardTheme:!0,noUndo:!0})}}},131089:(e,t,i)=>{"use strict";i.d(t,{uploadSnapshot:()=>n});var r=i(803912);async function n(e,t,i){const n=JSON.stringify({panes:[{content:e,contentWidth:t,contentHeight:i,leftAxis:{contentWidth:0},rightAxis:{contentWidth:0}}],timeAxis:{contentWidth:0,contentHeight:0,lhsStub:{contentWidth:0},rhsStub:{contentWidth:0}}}),s=new FormData;s.append("images",n);try{const e=await(0,r.fetch)("/snapshot/",{body:s,method:"POST",credentials:"same-origin"}),t=await e.text();return e.ok?`${location.protocol}//${location.host}/x/${t}`:""}catch(e){return""}}},332450:(e,t,i)=>{"use strict";i.d(t,{CLOSE_POPUPS_AND_DIALOGS_COMMAND:()=>r,breakpointList:()=>n});const r="CLOSE_POPUPS_AND_DIALOGS_COMMAND",n=[1920,1440,1280,1024,768,480,0]},497763:(e,t,i)=>{"use strict";i.d(t,{SERIES_COLORS:()=>n,getColorByIndex:()=>o,getItemByIndex:()=>s});var r=i(790188);const n=[r.colorsPalette["color-tv-blue-a200"],r.colorsPalette["color-sky-blue-300"],r.colorsPalette["color-banana-yellow-900"],r.colorsPalette["color-deep-blue-a100"],r.colorsPalette["color-banana-yellow-700"],r.colorsPalette["color-tv-blue-300"],r.colorsPalette["color-grapes-purple-a100"],r.colorsPalette["color-tv-blue-400"],r.colorsPalette["color-minty-green-300"],r.colorsPalette["color-berry-pink-300"],r.colorsPalette["color-tv-blue-a100"],r.colorsPalette["color-tan-orange-a200"],r.colorsPalette["color-iguana-green-400"],r.colorsPalette["color-ripe-red-400"],r.colorsPalette["color-sky-blue-300"],r.colorsPalette["color-banana-yellow-600"],r.colorsPalette["color-berry-pink-a200"],r.colorsPalette["color-tv-blue-200"],r.colorsPalette["color-banana-yellow-900"]];function s(e,t){
const i=e[t%e.length];return i||e[0]}function o(e,t=n){return s(t,e)}},530254:(e,t,i)=>{"use strict";i.d(t,{MAX_VAL:()=>h,format:()=>u,getFractionalDigitsNumber:()=>g,getMetricPrefix:()=>_});var r=i(650151),n=i(960521),s=i(808708),o=i(51196),a=i(796814),l=i(969680);const c=new Map;let d=null;const h=1e100;function u(e,t,i=2){return Math.abs(e)>=h?"—":"volume"===t?function(e){d||(d=new o.VolumeFormatter);return d.format(e)}(e):"percents"===t?(0,l.forceLTRStrSsr)(function(e,t){let i="";e<0&&(i="−",e=-e);return i+function(e){if(c.has(e))return(0,r.ensureDefined)(c.get(e));const t=new s.NumericFormatter({precision:e});return c.set(e,t),t}(t).format(e)}(e,i)+"%"):(0,l.forceLTRStrSsr)(function(e){return(new a.FinancialsFormatter).format(e)}(e))}function _(e){const t=Math.abs(e);return t<995?{symbol:"",multiplier:1}:t<999995?{symbol:"K",multiplier:1e3}:t<999999995?{symbol:"M",multiplier:1e6}:t<999999999995?{symbol:"B",multiplier:1e9}:{symbol:"T",multiplier:1e12}}function g(e){const t=(0,n.Big)(e);return Math.max(t.c.length-t.e-1,0)}},436901:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_MAX_DATA_ARRAY_LENGTH:()=>r});const r=5},610203:(e,t,i)=>{"use strict";i.d(t,{PeriodId:()=>r,convertFrequencyToPeriod:()=>m,generateTooltipValues:()=>L,getChartSeriesArray:()=>A,getDataFromQuotes:()=>T,getFinancialsDataFromQuotes:()=>O,getFinancialsSets:()=>y,getFormattedPeriodsEnds:()=>k,getHistoricPeriodsDataFromQuotes:()=>x,getMaxDataLengthByPeriod:()=>N,getPerformanceSet:()=>v,getPeriodData:()=>P,getPeriodDataFromFinancials:()=>M,getPeriodsDataFromQuotes:()=>E,getTooltipValuesGeneratorWithOptions:()=>D,isQuoteValuesNull:()=>F,pastPerformanceColors:()=>p,useHistoricPeriodsDataFromQuotes:()=>W,usePeriodsDataFromQuotes:()=>R});var r,n=i(50959),s=i(444372),o=i(650151),a=i(429973),l=i(790188),c=i(812352),d=i(497763),h=i(530254),u=i(381909),_=i(436901),g=i(969680);!function(e){e.Year="FY",e.Quarter="FQ",e.HalfYear="FH"}(r||(r={}));const p=[l.colorsPalette["color-tv-blue-a200"],l.colorsPalette["color-sky-blue-300"]];function m(e){return e&&2===e?r.HalfYear:r.Quarter}function f(e){if(e)return["banking"===e?{title:s.t(null,void 0,i(684177)),fields:["interest_income","non_interest_income"]}:"total_revenue","net_income","net_margin"]}function v(e,t){return{id:"income statements",title:s.t(null,void 0,i(970074)),chartType:"compare",fields:f(e),currency:t}}function y(e,t){return[{id:"income statements",title:s.t(null,void 0,i(655923)),chartType:"compare",fields:f(e),currency:t},{id:"balance sheet",title:s.t(null,void 0,i(903010)),chartType:"compare",marginTitle:s.t(null,void 0,i(380297)),fields:["total_assets","total_liabilities"],currency:t},{id:"cash flow",title:s.t(null,void 0,i(94820)),chartType:"lines",fields:["cash_f_operating_activities","cash_f_investing_activities","cash_f_financing_activities"],currency:t}]}function S(e){return e.hasOwnProperty("title")}const b=()=>({total_revenue:s.t(null,void 0,i(278031)),net_income:s.t(null,void 0,i(23493)),total_assets:s.t(null,void 0,i(529920)),total_liabilities:s.t(null,void 0,i(490478)),
cash_f_operating_activities:s.t(null,void 0,i(471571)),cash_f_investing_activities:s.t(null,void 0,i(620296)),cash_f_financing_activities:s.t(null,void 0,i(636787)),net_margin:s.t(null,void 0,i(600767))});function w(e){return S(e)?e.title:(0,o.ensureDefined)(b()[e])}function C(e,t,i,r=_.DEFAULT_MAX_DATA_ARRAY_LENGTH){if(!S(e))return T(e,t,i,r);const n=e.fields.map((e=>T(e,t,i,r))),s=[];for(let e=0;e<n[0].length;e++){const t=n.map((t=>t[e]));s.push(t.every((e=>null===e))?null:t.reduce(((e,t)=>e+(t||0)),0))}return s}function T(e,t,i,r=_.DEFAULT_MAX_DATA_ARRAY_LENGTH){const n=i[t];if(!n)return[];return n[e].slice(0,r).reverse()}function P(e,t,i=_.DEFAULT_MAX_DATA_ARRAY_LENGTH){const r=e[t];if(r)return r.slice(0,i).reverse()}function A(e,t,i,r=0,n){if(!e.fields)return[];switch(e.chartType){case"compare":const s=[e.fields[0],e.fields[1]].map(((s,a)=>({type:"bar",name:w((0,o.ensureDefined)(s)),valueType:"numbers",values:I(C((0,o.ensureDefined)(s),t,(0,o.ensureDefined)(i))),defaultColor:(0,d.getColorByIndex)(a+r,n),showInLegend:!0,buildTooltip:D({unit:e.currency})})));let a;const l=e.fields[2];a=l?C(l,t,(0,o.ensureDefined)(i)):s[0].values.map(((e,t)=>{const i=s[1].values[t];return null===e||null===i?null:0===e?0:i/e*100}));const c={type:"line",name:e.marginTitle??w((0,o.ensureDefined)(l)),valueType:"percents",values:I(a),defaultColor:(0,d.getColorByIndex)(s.length+r),showInLegend:!0,buildTooltip:L};return[...s,c];case"lines":return e.fields.map(((n,s)=>({type:"line",name:w((0,o.ensureDefined)(n)),valueType:"numbers",values:I(C((0,o.ensureDefined)(n),t,(0,o.ensureDefined)(i))),defaultColor:(0,d.getColorByIndex)(s+r),showInLegend:!0,buildTooltip:D({unit:e.currency})})));default:return[]}}function I(e){return e.map((e=>null!==e&&isNaN(e)?null:e))}function L(e,t,i,r){const n=e.values[i];if(null==n)return null;const s=(0,h.format)(n,e.valueType);return[{title:r?.capitalizeFirstLetter??!0?(0,u.capitalizeFirstLetter)(e.name.toLowerCase()):e.name,color:r?.color??(0,o.ensureDefined)(e.defaultColor),value:r?.withForceLtr?(0,g.forceLTRStr)(s):s,unit:r?.unit,endSlot:r?.endSlot}]}function D(e){return(t,i,r)=>L(t,0,r,e)}function x(e){const{fiscal_period_fy_h:t,fiscal_period_fq_h:i,fiscal_period_fh_h:n}=e;if(t||i||n)return{[r.Year]:t,[r.Quarter]:i,[r.HalfYear]:n}}function E(e){const{fiscal_period_fy:t,fiscal_period_fq:i,fiscal_period_fh:n}=e;if(t||i||n)return{[r.Year]:t,[r.Quarter]:i,[r.HalfYear]:n}}function W(e){const{fiscal_period_fy_h:t,fiscal_period_fq_h:i,fiscal_period_fh_h:r}=e||{};return(0,n.useMemo)((()=>e?x(e):void 0),[t,i,r])}function R(e){const{fiscal_period_fy:t,fiscal_period_fq:i,fiscal_period_fh:r}=e||{};return(0,n.useMemo)((()=>e?E(e):void 0),[t,i,r])}function M(e){if(!e)return;const t=e[r.Year]?.fiscal_period,i=e[r.Quarter]?.fiscal_period,n=e[r.HalfYear]?.fiscal_period;return t||i||n?{[r.Year]:t,[r.Quarter]:i,[r.HalfYear]:n}:void 0}function k(e,t,i){if(!e)return[];const n=function(e){const{fiscal_period_end_fy_h:t,fiscal_period_end_fq_h:i,fiscal_period_end_fh_h:n}=e;if(t||i||n)return{[r.Year]:t,[r.Quarter]:i,[r.HalfYear]:n
}}(e);if(!n)return;const s=n[t];return s?s.slice(0,i).reverse().map((e=>e?(0,a.formatTime)(1e3*e,(0,c.getLocaleIso)(),"year","month"):"")):[]}function O(e){const{total_revenue_fy_h:t,total_revenue_fq_h:i,total_revenue_fh_h:n,net_income_fy_h:s,net_income_fq_h:o,net_income_fh_h:a,total_assets_fy_h:l,total_assets_fq_h:c,total_assets_fh_h:d,total_liabilities_fy_h:h,total_liabilities_fq_h:u,total_liabilities_fh_h:_,cash_f_operating_activities_fy_h:g,cash_f_operating_activities_fq_h:p,cash_f_operating_activities_fh_h:m,cash_f_investing_activities_fy_h:f,cash_f_investing_activities_fq_h:v,cash_f_investing_activities_fh_h:y,cash_f_financing_activities_fy_h:S,cash_f_financing_activities_fq_h:b,cash_f_financing_activities_fh_h:w,fiscal_period_fy_h:C,fiscal_period_fq_h:T,fiscal_period_fh_h:P,interest_income_fy_h:A,interest_income_fq_h:I,interest_income_fh_h:L,non_interest_income_fy_h:D,non_interest_income_fq_h:E,non_interest_income_fh_h:W,net_margin_fy_h:R,net_margin_fq_h:M,net_margin_fh_h:k,fund_view_mode:O}=e,N=x(e);if(N){const{[r.Year]:e,[r.Quarter]:x,[r.HalfYear]:B}=N,V=!e||"industrial"===O&&F(t),U=!x||"industrial"===O&&F(i),H=!B;return{[r.Year]:V?void 0:{total_revenue:t,net_income:s,total_assets:l,total_liabilities:h,cash_f_operating_activities:g,cash_f_investing_activities:f,cash_f_financing_activities:S,fiscal_period:C,interest_income:A,non_interest_income:D,net_margin:R},[r.Quarter]:U?void 0:{total_revenue:i,net_income:o,total_assets:c,total_liabilities:u,cash_f_operating_activities:p,cash_f_investing_activities:v,cash_f_financing_activities:b,fiscal_period:T,interest_income:I,non_interest_income:E,net_margin:M},[r.HalfYear]:H?void 0:{total_revenue:n,net_income:a,total_assets:d,total_liabilities:_,cash_f_operating_activities:m,cash_f_investing_activities:y,cash_f_financing_activities:w,fiscal_period:P,interest_income:L,non_interest_income:W,net_margin:k}}}}function F(e){return!e||e.every((e=>null===e))}function N(e){switch(e){case r.Year:return 20;case r.Quarter:return 32;case r.HalfYear:return 16}}},679493:(e,t,i)=>{"use strict";i.d(t,{IndicatorsPreloader:()=>m});var r=i(111332),n=i(884934),s=i(604061),o=i(888386),a=i(444372),l=i(304328),c=i(650151);async function d(){const[e,t]=await Promise.all([(0,r.requestFundamentalScripts)(),(0,l.getFinancialsDataV2)()]);return i=>{if(!i)return{};const r=(0,l.filterHiddenItems)(t),n=function(e,t){const i={};e.forEach((e=>{const t=(0,l.getIdWithoutPeriod)(e.id);t&&!i[t]&&(i[t]={...e,nestingLevel:-1,idWithoutPeriod:t,parentIdWithoutPeriod:(0,l.getIdWithoutPeriod)(e.parent),periodData:[],shortTitle:""})})),t.forEach((e=>{if(!e.extra.fund_id)return;const t=(0,l.getIdWithoutPeriod)(e.extra.fund_id),r=i[(0,c.ensureDefined)(t)];if(!r)return;const n={period:e.extra.financialPeriod,scriptIdPart:e.scriptIdPart,scriptName:e.scriptName,version:e.version};r.shortTitle=e.extra.shortDescription,r.tags=e.extra.tags,r.periodData.push(n)}));const r=Object.values(i),n=(e,t)=>e.period&&t.period?e.period.localeCompare(t.period):0;return r.forEach((e=>{e.periodData.length>1&&e.periodData.sort(n)})),r
}((0,l.filterByViewMode)(r,i),e),s=function(e){const t=[...e].map((e=>{if(e.children?.length){const t=(0,l.flattenTree)(e.children);return{...e,children:t}}return e}));return(0,l.splitByCategory)(t)}(function(e){const t=(0,l.toTree)(e);return(0,l.sortByOrdinal)(t)}(n));return function(e){const t={};return Object.keys(e).forEach((i=>{const r=[];e[i].forEach((e=>{const t=h([e])[0];if(t)if(t.children){const e=h(t.children).map((e=>u(e,!0)));r.push(u(t),...e)}else r.push(u(t))})),t[i]=r})),t}(s)}}function h(e){const t=e.filter((e=>void 0===e.indicatorVisible||e.indicatorVisible));return t.filter((e=>e.periodData.length>0))}function u(e,t=!1){const{id:r,name:n,shortTitle:s,idWithoutPeriod:o,periodData:l,tags:c}=e;return{id:r,shortTitle:s,periodData:l,tags:c,name:a.t(n,{context:"study"},i(783477)),solutionId:g(o),isNested:t}}const _=i(384898);function g(e){return _[e]}var p=i(640646);class m{constructor(e={}){this._options=e}getIndicatorPromises(){const{javaStudies:e=!0,standardScripts:t=!0,candlestickScripts:i=!0,publicPineStudies:a=!0,trendingStudies:l=!0,editorsPicksStudies:c=!0,financials:h=!0,userScripts:u=!0,inviteOnlyScripts:_=!0}=this._options,g=this._initIndicatorsPromises?.javaStudiesPromise??(e?(0,s.requestBuiltInJavaStudies)():void 0),p=this._initIndicatorsPromises?.standardScriptsPromise??(t?(0,n.requestBuiltinScripts)():void 0),m=this._initIndicatorsPromises?.candlestickScriptsPromise??(i?(0,r.requestCandlestickScripts)():void 0),f=this._initIndicatorsPromises?.publicPineStudiesPromise??(a?(0,s.fetchPublicPineStudies)((0,s.createPublicStudiesRequestParams)("top")):void 0),v=this._initIndicatorsPromises?.trendingStudiesPromise??(l?(0,s.fetchPublicPineStudies)((0,s.createPublicStudiesRequestParams)("trending")):void 0),y=this._initIndicatorsPromises?.editorsPicksStudiesPromise??(c?(0,s.fetchEditorsPicksStudies)():void 0),S=this._initIndicatorsPromises?.addonsPromise,b=this._initIndicatorsPromises?.pinePermissionsPromise??(_?o.PinePerm.listScripts():void 0),w=this._initIndicatorsPromises?.financialsPromise??(h?d():void 0),C=b?this._getInviteOnlyScriptsPromise(b):void 0,T=u?(0,n.requestUserScripts)():void 0;return this._initIndicatorsPromises={javaStudiesPromise:g,userScriptsPromise:T,standardScriptsPromise:p,candlestickScriptsPromise:m,publicPineStudiesPromise:f,trendingStudiesPromise:v,addonsPromise:S,pinePermissionsPromise:b,editorsPicksStudiesPromise:y,financialsPromise:w,inviteOnlyScriptsPromise:C},this._initIndicatorsPromises}async _getInviteOnlyScriptsPromise(e){try{const t=await e;return t?function(e){if(!e||!e.done)return e;const t=e;return new Promise(((e,i)=>{t.done((t=>{e(t)})).fail((e=>{i(e)}))}))}((0,p.info)(t)):Promise.resolve([])}catch{return Promise.resolve([])}}}},604061:(e,t,i)=>{"use strict";i.d(t,{createPublicStudiesRequestParams:()=>l,fetchEditorsPicksStudies:()=>o,fetchLoadMorePublicStudies:()=>a,fetchPublicPineStudies:()=>s,requestBuiltInJavaStudies:()=>c});var r=i(803912),n=i(87347);async function s(e){return(await(0,r.fetch)(`/pubscripts-library/?${e}`)).json()}async function o(){
return(await(0,r.fetch)("/pubscripts-library/editors-picks/")).json()}async function a(e){return(await(0,r.fetch)(e)).json()}function l(e){const t={offset:0,count:20,type:0,sort:e};return new URLSearchParams(Object.entries(t)).toString()}function c(){return(0,n.studyMetaInfoRepository)().findAllJavaStudies()}},988534:(e,t,i)=>{"use strict";i.d(t,{FinancialsDialogController:()=>s});var r=i(584317);let n;class s extends r.DialogRenderer{constructor(){super(...arguments),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)}}show(e){this._load(e).then((e=>e.show()))}hide(){this._dialog?.hide()}static getInstance(){return n||(n=new s),n}_load(e){return Promise.all([i.e(56662),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(52186),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(90579),i.e(6612),i.e(11069),i.e(50874),i.e(65743),i.e(61171),i.e(19190),i.e(67780),i.e(20563),i.e(87833),i.e(67691),i.e(14391),i.e(38452),i.e(98158),i.e(38752),i.e(40887),i.e(71450),i.e(84587),i.e(98681),i.e(34002),i.e(10299),i.e(97540),i.e(25563),i.e(92990),i.e(19715),i.e(72232),i.e(53271),i.e(19365),i.e(71803),i.e(82870),i.e(49760),i.e(82279),i.e(14100),i.e(48197),i.e(13485),i.e(84030),i.e(69965),i.e(93015),i.e(51513),i.e(80735),i.e(34943),i.e(44535),i.e(42486),i.e(59878),i.e(58875),i.e(99796),i.e(96908),i.e(15169),i.e(37463),i.e(79487),i.e(65786),i.e(51979),i.e(15377),i.e(93031),i.e(16570),i.e(11058),i.e(28158),i.e(37519),i.e(41652),i.e(36434),i.e(36463),i.e(21639),i.e(6507),i.e(11998),i.e(27624),i.e(98193),i.e(36053),i.e(71702),i.e(79700),i.e(99735),i.e(32227),i.e(60337),i.e(96349),i.e(70750),i.e(37009),i.e(29508),i.e(88979),i.e(40051),i.e(73164),i.e(17619),i.e(96854),i.e(88798),i.e(41722),i.e(2139),i.e(16663),i.e(24878)]).then(i.bind(i,571592)).then((t=>(this._dialog?.hide(),this._dialog?.visible().unsubscribe(this._subscribe),this._dialog=new t.FinancialsDialogRenderer(e),this._dialog.visible().subscribe(this._subscribe),this._dialog)))}}},199687:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_PERIOD:()=>l,PERIODS:()=>a,getFinancialsPages:()=>s,getStatementsCategories:()=>o});var r=i(444372),n=i(610203);function s(){return[{id:"overview",children:r.t(null,void 0,i(15797))},{id:"statements",children:r.t(null,void 0,i(723821))},{id:"statistics",children:r.t(null,void 0,i(768627))},{id:"dividends",children:r.t(null,void 0,i(137260))},{id:"earnings",children:r.t(null,void 0,i(844543))},{id:"revenue",children:r.t(null,void 0,i(278031))}]}function o(){return[{id:"income statements",children:r.t(null,void 0,i(655923))},{id:"balance sheet",children:r.t(null,void 0,i(903010))},{id:"cash flow",children:r.t(null,void 0,i(94820))}]}const a=(e=n.PeriodId.Quarter)=>[{id:n.PeriodId.Year,title:r.t(null,void 0,i(984847))},{id:e,title:e===n.PeriodId.HalfYear?r.t(null,void 0,i(228727)):r.t(null,void 0,i(934673))}],l=e=>a(e)[1].id},40541:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_CATEGORY_SETTINGS:()=>r,HISTORIC_VALUES_POSTFIX:()=>s,PEOPLE_COUNT_QUOTES:()=>n,PERIOD_POSTFIXES:()=>o});const r={"income statements":{
defaultItems:["total_revenue","gross_profit","oper_income","pretax_income","net_income"],additionalField:1,displayGroups:!1},"balance sheet":{defaultItems:["total_assets","total_liabilities"],additionalField:0,displayGroups:!1},"cash flow":{defaultItems:["cash_f_operating_activities","cash_f_investing_activities","cash_f_financing_activities"],additionalField:1,displayGroups:!1},statistics:{defaultItems:["price_earnings","price_cash_flow"],additionalField:2,displayGroups:!0},dividends:{defaultItems:["dps_common_stock_prim_issue","dividends_yield"],additionalField:0,displayGroups:!1},earnings:{defaultItems:[],additionalField:0,displayGroups:!1},revenue:{defaultItems:[],additionalField:0,displayGroups:!1}},n=["number_of_employees","number_of_shareholders"],s="_h",o=["_fy","_fq","_fh","_ttm"]},304328:(e,t,i)=>{"use strict";i.d(t,{addOrRemoveIdFromSet:()=>F,createSortedCategoryList:()=>P,filterByViewMode:()=>S,filterCategoryList:()=>A,filterConfig:()=>f,filterHiddenItems:()=>y,findParentsSet:()=>N,flattenTree:()=>C,getAdditionalFieldPostfix:()=>k,getAdditionalFieldValue:()=>B,getFieldsByPeriodData:()=>$,getFinancialsDataV2:()=>g,getIdWithoutPeriod:()=>O,getIndicatorPagePath:()=>H,getItemValueFromQuotes:()=>q,getItemValuesFromQuotes:()=>I,getOtherAvailablePeriod:()=>z,getPercentChange:()=>M,isCategoryId:()=>m,isEarningsValuesKind:()=>G,isPeriodAvailable:()=>j,isStatementsCategoryId:()=>p,prepareEarningsData:()=>R,sortByOrdinal:()=>w,splitByCategory:()=>T,toTree:()=>b,translateConfig:()=>v,valueFormatter:()=>V,valueFormatterWithZeroPrecision:()=>U});var r=i(650151),n=i(444372),s=i(803912),o=i(503246),a=i(436901),l=i(530254),c=i(610203),d=i(40541),h=i(199687),u=i(210075);const _="/financial/fundamentals_config_v2/";function g(){return(0,s.fetch)(_,{credentials:"same-origin",headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json()))}function p(e){return"balance sheet"===e||"income statements"===e||"cash flow"===e}function m(e){return"dividends"===e||"revenue"===e||"statistics"===e||"earnings"===e}function f(e,t){return e.filter((e=>{const i=!e.hidden&&e.financialVisible,r=e.fundViewMode===t;return i&&r}))}function v(e){return e.map((e=>{const{name:t,group:r,...s}=e;return{...s,name:n.t(t,{context:"study"},i(783477)),group:n.t(r,{context:"study"},i(783477))}}))}function y(e){return e.filter((e=>!e.hidden))}function S(e,t){return e.filter((e=>e.fundViewMode===t))}function b(e){const t=Symbol(),i={},n={},s=[];for(const o of e){const e=(0,r.ensureDefined)(O(o.id)),a=e,l=O(o.parent),c=l??t;c===t&&s.push(a);const d=i[a]={...o,nestingLevel:-1,idWithoutPeriod:e,parentIdWithoutPeriod:l,periodData:o.periodData||[],shortTitle:o.shortTitle||""};(n[c]=n[c]??[]).push(d)}for(const t of e){const e=(0,r.ensureDefined)(O(t.id));i[e].children=n[e],delete n[e]}(0,r.assert)(0===Object.keys(n).length);let o=0;for(;s.length>0&&o<e.length;){o++;const e=i[(0,r.ensureDefined)(s.shift())],t=e.parentIdWithoutPeriod;e.nestingLevel=t?i[t].nestingLevel+1:0,e.children?.forEach((e=>{s.push(e.idWithoutPeriod)}))}return n[t]}function w(e){
const t=[...e];return t.sort(((e,t)=>e.ordinal-t.ordinal)),t.forEach((e=>{e.children&&(e.children=w(e.children))})),t}function C(e,t,i){let r=[];return e.forEach((e=>{if(!e.children||!e.children.length)return void(r=[...r,e]);const n=i?e.children.filter(i):e.children;if(!n.length)return void(r=[...r,{...e,children:void 0}]);if(!!t&&t(e))return void(r=[...r,e]);const s=C(n,t,i);r=[...r,e,...s]})),r}function T(e){const t=[...e],i={dividends:[]};return t.forEach((e=>{const t=e.category.toLowerCase();i[t]?i[t].push(e):i[t]=[e]})),i}function P(e){if(!e.length)return{};const t=T(b(function(e){const t=new Map;for(const i of e){const e=(0,r.ensureDefined)(O(i.id)),n=e&&t.get(e);if(n)(0,r.ensureDefined)(n.periodData).push({period:i.period});else{const n={...i,idWithoutPeriod:(0,r.ensureDefined)(O(i.id)),nestingLevel:-1,periodData:[],shortTitle:""};n.periodData=[{period:i.period}],t.set(e,n)}}return Array.from(t.values())}(e))),i={};return Object.entries(t).forEach((([e,t])=>{i[e]=function(e){const t=w(e),i=new Map;return t.forEach((e=>{const{group:t,ordinal:r}=e,n=i.get(t);(void 0===n||n>r)&&i.set(t,r)})),t.sort(((e,t)=>(0,r.ensureDefined)(i.get(e.group))-(0,r.ensureDefined)(i.get(t.group))||e.ordinal-t.ordinal)),t}(t)})),i}function A(e,t,i){function r(e,t){const{children:n,...s}=e;if(n){const e=n.map((e=>r(e,t))).filter(Boolean);if(e.length)return{...s,children:e}}return e.name.toLowerCase().includes(t.toLowerCase())&&e.periodData.find((e=>e.period===i))?{...s,children:void 0}:null}return e.map((e=>r(e,t))).filter(Boolean)}function I(e,t,i=0,r,n,s=a.DEFAULT_MAX_DATA_ARRAY_LENGTH){const o=`${O(e)}_${r.toLowerCase()}`;let l=new Array(s).fill(null),h=[];if(t){const e=t[o+d.HISTORIC_VALUES_POSTFIX];if(e){const t=function(e,t,i,r){const n=e.length>i,s=e.slice(0,i).reverse(),o=[];if(r){const i=e.slice(0,e.length).reverse();i.forEach(((e,r)=>{if(0===r&&n)return;if(0===r)return void o.push(NaN);let s;if(t!==c.PeriodId.Year){const n=r-(t===c.PeriodId.Quarter?4:2);s=i[n]?M(Number(i[n]),Number(e)):NaN}else s=M(Number(i[r-1]),Number(e));o.push(s)}))}return{values:s,changes:o.slice(-i)}}(e,r,s,n);l=t.values,t.changes&&(h=t.changes)}if(0!==i&&3!==i){const e=t[O(o)+k(i)]||null,r=o.endsWith("_fq");return{values:l,changes:n?h:void 0,additional:e,additionalChange:!n||1===i&&r?void 0:M(Number(l[l.length-1]),Number(e))}}}return{values:l,changes:n?h:void 0,additional:0===i?void 0:null}}function L(e){return null===e.Estimate&&null===e.Actual}function D(e,t){const i=e.length-1;let r=t?i:0;const n=t?[...e].reverse().entries():e.entries();for(const[e,t]of n)if(!L(t)){r=e;break}return t?i-r:r}function x(e,t){if(!t||!t.length)return{estimateStartIndex:-1,items:[]};if(!function(e){return e.every((e=>null!==e.FiscalPeriod))}(t)||t.every(L))return{estimateStartIndex:-1,items:[]};const i=[...t].sort(((e,t)=>e.FiscalPeriod>t.FiscalPeriod?1:-1));let r=null;for(let e=i.length-1;e--;e>=0){if(i[e].IsReported){r=e;break}}const n=null!==r?r+1:D(i,!0)-4,s=Math.max(0,n-e),o=Math.min(i.length,n+4),a=i.slice(s,o),l=D(a,!1);return{estimateStartIndex:n<e?n-l:e-l,
items:a.slice(l)}}function E(e,t){if(e.reported.push(t.Actual),e.estimate.push(t.Estimate),null!==t.Actual&&null!==t.Estimate){const i=(t.Actual-t.Estimate)/Math.abs(t.Estimate)*100;e.surprise.push(isFinite(i)?i:null)}else e.surprise.push(null);return e.periods.push(t.FiscalPeriod),e}const W={[c.PeriodId.Year]:"_fy",[c.PeriodId.HalfYear]:"_fh",[c.PeriodId.Quarter]:"_fq"};function R(e,t,i){if(!e)return null;const r=W[t],n="earnings"+r+d.HISTORIC_VALUES_POSTFIX,s="revenues"+r+d.HISTORIC_VALUES_POSTFIX,o=i??(0,c.getMaxDataLengthByPeriod)(t),{items:a,estimateStartIndex:l}=x(o,e[n]),h=a.reduce(E,{reported:[],estimate:[],surprise:[],periods:[]}),{items:u}=x(o,e[s]),_=u.reduce(E,{reported:[],estimate:[],surprise:[],periods:[]}),g=e=>!e.reported.length&&!e.estimate.length;return{earnings:g(h)?null:h,revenues:g(_)?null:_,estimateStartIndex:l}}function M(e,t,i){if(0===e||e<0&&t>0)return NaN;const r=(t-e)/Math.abs(e)*100;return i?r:Number(r.toFixed(2))}function k(e){switch(e){case 2:return"_current";case 1:return"_ttm"}return""}function O(e){if(e)for(let t=0;t<d.PERIOD_POSTFIXES.length;t++){const i=d.PERIOD_POSTFIXES[t];if(e.endsWith(i))return e.slice(0,-i.length)}return e}function F(e,t){const i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i}function N(e,t){let i=new Set;const r=Symbol();for(let n=0;n<e.length;n++){const{idWithoutPeriod:s,parentIdWithoutPeriod:o=r,children:a}=e[n];if(a?.length){const e=N(a,t);i=new Set([...Array.from(i),...Array.from(e)])}(t.has(s)||i.size>0)&&o!==r&&i.add(o)}return i}function B(e){switch(e){case 2:return n.t(null,void 0,i(535770));case 1:return n.t(null,void 0,i(284634));case 3:return"";case 0:return}}function V(e){return"string"==typeof e?e:null===e?"—":(0,l.format)(e,"numbers")}function U(e,t){return"string"==typeof e?e:t&&d.PEOPLE_COUNT_QUOTES.includes(t)?(0,u.formatFinancialsWithZeroPrecisionAndPlaceholder)(e)??"—":V(e)}function H(e,t){const i=e.toLowerCase();if(!p(i)&&"statistics"!==i)throw new Error("Bad item category id");return`${o.pathsByCategoryId[i]}${t.replace(/_/g,"-")}/`}function z(e,t){const i=(0,h.PERIODS)(t);return e&&j(e,t)?(0,r.ensureDefined)(i.find((t=>t.id!==e))).id:(0,h.DEFAULT_PERIOD)(t)}function j(e,t){return(0,h.PERIODS)(t).some((t=>t.id===e))}function G(e){return["reported","estimate","surprise"].includes(e)}function $(e,t,i){const r={[c.PeriodId.Year]:[],[c.PeriodId.Quarter]:[],[c.PeriodId.HalfYear]:[]};return Object.keys(r).forEach((n=>{t.forEach((t=>{const s=q(t,e,n,i);r[n].push(s)}))})),r}function q(e,t,i,r){const n=`${O(e)}_${i.toLowerCase()}`;return r?t[n+d.HISTORIC_VALUES_POSTFIX]:t[n]}},316478:(e,t,i)=>{"use strict";i.d(t,{ForecastDialogController:()=>o});var r=i(584317),n=i(583912);let s;class o extends r.DialogRenderer{constructor(){super(...arguments),this._dialog=null,this._subscribe=e=>{this._setVisibility(e)}}show(e){this._load(e).then((e=>e.show()))}hide(){this._dialog?.hide()}async canBeShown(e){const t=e||n.linking.proSymbol.value(),r=new Set(["recommendation_mark","pro_name"]),s=await(async()=>{
const{snapshoter:e}=await i.e(62495).then(i.bind(i,960669));return e().getSnapshot(t,r)})();return!("error"===s.status||!s.values.recommendation_mark)}static getInstance(){return s||(s=new o),s}_load(e){return Promise.all([i.e(84239),i.e(47742),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(50874),i.e(61171),i.e(19190),i.e(20563),i.e(67691),i.e(98158),i.e(38752),i.e(40887),i.e(71450),i.e(98681),i.e(34002),i.e(10299),i.e(97540),i.e(25563),i.e(19715),i.e(72232),i.e(19365),i.e(48197),i.e(59546),i.e(93015),i.e(3579),i.e(51513),i.e(80735),i.e(34943),i.e(58875),i.e(65786),i.e(15377),i.e(11058),i.e(28158),i.e(37519),i.e(76848),i.e(23399),i.e(80259),i.e(41652),i.e(18182),i.e(36463),i.e(41941),i.e(21639),i.e(50290),i.e(4122),i.e(5700),i.e(32227),i.e(96349),i.e(80450),i.e(29508),i.e(88979),i.e(40051),i.e(17619),i.e(14337),i.e(25484),i.e(91128),i.e(85080)]).then(i.bind(i,231078)).then((t=>(this._dialog?.hide(),this._dialog?.visible().unsubscribe(this._subscribe),this._dialog=new t.ForecastDialogRenderer(e),this._dialog.visible().subscribe(this._subscribe),this._dialog)))}}},290382:(e,t,i)=>{"use strict";i.d(t,{SymbolSearchUI:()=>o});var r=i(650151),n=i(186335),s=i(583912);class o{async show(e){if(null!==o._provider){const e=await o._provider.getSymbol();return s.linking.setSymbolAndLogInitiator(e.symbol,"symbol search UI"),e}if(o._currentShowingInstance)throw new DOMException("SymbolSearchUI is already shown","InvalidStateError");try{o._currentShowingInstance=this,o.preload();const t=await o._implementation;return(0,r.assert)(null!==t),new Promise((i=>{t.showDefaultSearchDialog({...e,onSearchComplete:e=>{i({symbol:e})}})}))}finally{o._currentShowingInstance=null}}static setProvider(e){this._provider=e}static preload(){null===this._provider&&null===this._implementation&&(this._implementation=(0,n.loadNewSymbolSearch)())}}o._currentShowingInstance=null,o._provider=null,o._implementation=null},889110:(e,t,i)=>{"use strict";i.d(t,{defaultHintStateHandler:()=>n});var r=i(62802);const n={getHintState:(e,t)=>{if(!e||t)return!0;const i=r.getBool(e);return window.is_authenticated&&(i||void 0===i)},setHintState:e=>{e&&r.setValue(e,!1,{forceFlush:!0})}}},541183:e=>{e.exports={"css-value-header-toolbar-height":"38px"}},847291:e=>{e.exports={"top-left-button-height":"38px","top-left-button-width":"52px"}},947317:e=>{e.exports={"top-left-button-height":"38px","top-left-button-width":"52px",topLeftButton:"topLeftButton-hCWTCWBf",stub:"stub-hCWTCWBf"}},507778:(e,t,i)=>{"use strict";i.d(t,{backend:()=>V});var r={};i.r(r),i.d(r,{favorStandardStudyTemplate:()=>x,favorStudyTemplate:()=>D,getCharts:()=>y,getChartsCount:()=>S,getDrawingTemplates:()=>O,getStandardStudyTemplateById:()=>W,getStudyTemplateById:()=>E,getStudyTemplatesList:()=>A,invalidateStudyTemplatesList:()=>I,loadDrawingTemplate:()=>N,loadLayout:()=>b,openLayoutLink:()=>w,removeChart:()=>T,removeDrawingTemplate:()=>B,removeStudyTemplate:()=>R,renameStudyTemplate:()=>M,replaceStudyTemplate:()=>k,saveChart:()=>C,
saveDrawingTemplate:()=>F,saveStudyTemplate:()=>L});i(779893);var n=i(656130),s=i(430518);const o=(0,i(735566).getLogger)("Lib.AsyncGzip"),a=[];var l=i(803912);function c(e){if(e.ok)return e.json();throw new Error("not ok")}function d(e){if(e.ok)return e.json();throw new Error("not ok")}var h=i(314802),u=i(21931),_=i(87347),g=i(312692),p=i(37241),m=i(745679);var f=i(779893);const v="/api/v1/";async function y(e=null,t){const i=new URL("/my-charts/",window.location.origin);void 0!==t&&i.searchParams.append("limit",t.toString());const r=await(0,l.fetch)(i.toString(),{method:"GET",signal:e});if(!r.ok)throw new Error("Getting my charts response was not OK");return r.json()}function S(e,t){f.getJSON(v+"charts/count/",void 0,e).fail(t)}async function b(e){const t=new URL(`/chart/${e.url}/json/`,window.location.origin),i=await(0,l.fetch)(t.toString(),{method:"GET",credentials:"same-origin"});if(!i.ok)throw i;let r;const n=await i.json();return r="undefined"===n.content?await async function(){const e=(0,_.studyMetaInfoRepository)();await e.requestMetaInfo();const t=await e.findById({type:"java",studyId:"Volume@tv-basicstudies"}),i=(0,p.prepareStudyProperties)(t,{},null,e.studyVersioning(),[]),r={m_priceRange:null,m_isAutoScale:!0,m_isPercentage:!1,m_isIndexedTo100:!1,m_isLog:!1,m_isLockScale:!1,m_isInverted:!1,m_topMargin:.1,m_bottomMargin:.08,alignLabels:!0};return{name:"",layout:"s",charts:[{panes:[{mode:m.PaneMode.Regular,sources:[{type:"MainSeries",id:"_seriesId",zorder:0,state:{...(new u.SeriesPropertiesImpl).state(),style:1,symbol:"NASDAQ:AAPL",shortName:"AAPL",timeframe:"",interval:"1M",unitId:null,timezone:"UTC",currencyId:null}},{type:"study_Volume",id:"nAALGd",state:i.state(),metaInfo:t.state()}],mainSourceId:"_seriesId",stretchFactor:2e3,leftAxisesState:[],rightAxisesState:[{state:{id:"H9o2zbZ0NTjL",...r},sources:["_seriesId"]}],overlayPriceScales:{nAALGd:{id:"H9o2zbZ0NTjL",...r}},priceScaleRatio:null,isCollapsed:!1,isMaximized:!1}],timeScale:{m_barSpacing:6,m_rightOffset:10},chartProperties:new g.DefaultProperty({defaultName:"chartproperties"}).state(),version:3,timezone:"Etc/UTC",shouldBeSavedEvenIfHidden:!1,linkingGroup:null,lineToolsGroups:{groups:[]},chartId:"1"}],symbolLock:0,intervalLock:0,trackTimeLock:0,dateRangeLock:0,crosshairLock:1}}():JSON.parse(n.content),{name:n.name,chartWidgetCollectionState:r,uid:n.uid,lastModified:n.last_modified,id:n.id,description:n.description,username:n.username}}function w(e,t){const i=(0,n.generateChartUrl)({chartId:e.url}),r=document.createElement("a");r.href=i,!(0,h.isOnMobileAppPage)("new")&&/^\/chart(\/|$)/.test(location.pathname)&&(r.target=t?"_blank":"_self",r.rel="noopener"),r.click()}async function C(e,t,r,n){let c;try{c=await function(e){let t;const r=new Promise(((r,n)=>{let o=setTimeout(n,5e3,new Error("Loading timed out"));t=a.pop()||new s.Worker(new URL(i.p+i.u(31482),i.b),{name:"Async gzip worker"}),t.onerror=n,t.onmessageerror=n,t.onmessage=e=>{clearTimeout(o),"done"===e.data.type?r(e.data.payload):o=setTimeout(n,3e4,new Error("Processing timed out"))},
t.postMessage({type:"do",payload:e})}));return r.then((()=>{a.length<1?(delete t.onerror,delete t.onmessage,delete t.onmessageerror,a.push(t)):t.terminate()}),(e=>{o.logError(`Worker request failed: ${e.message}`),t.terminate()})),r}(n.content)}catch(e){}const d=new FormData;for(const e in n)"content"===e&&c?d.append(e,new Blob([c],{type:"application/gzip"}),"blob.gz"):d.append(e,String(n[e]));const h=await(0,l.fetch)("/savechart/",{method:"POST",credentials:"same-origin",body:d});if(!h.ok)throw h;return{result:await h.text(),response:h}}function T(e){return(0,l.fetch)(v+"charts/delete/",{method:"POST",credentials:"same-origin",body:JSON.stringify({uid:[e]}),headers:new Headers({"Content-Type":"application/json"})}).then((e=>{if(!e.ok)throw e;return e.json()})).then((e=>{if(e.error)throw e.error}))}let P=null;function A(){return null===P&&(P=(0,l.fetch)("/api/v1/study-templates",{credentials:"same-origin"}).then(c).then((e=>{const t=e.custom||[],i=e.standard||[],r=e.fundamentals||[],n=new Set([...i,...r].map((e=>e.name))),s=t.map((e=>({...e,is_default:!1,is_fundamental:!1,favorite_date:e.favorite_date?new Date(e.favorite_date).getTime():null})));for(const e of s)n.delete(e.name);const o=i.filter((e=>n.has(e.name))).map((e=>({...e,is_default:!0,is_fundamental:!1,favorite_date:e.favorite_date?new Date(e.favorite_date).getTime():null}))),a=r.filter((e=>n.has(e.name))).map((e=>({...e,is_default:!0,is_fundamental:!0,favorite_date:e.favorite_date?new Date(e.favorite_date).getTime():null})));return[...s,...o,...a]}))),P}function I(){P=null}function L(e){return t={name:e.name,content:e.content,meta_info:e.meta_info||{indicators:[]}},(0,l.fetch)("/api/v1/study-templates",{credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>{if(e.ok)return e.json().then((e=>({result:e})));switch(e.status){case 403:return e.json().then((e=>({error:e.code})));case 422:return e.json().then((e=>({error:e.code,id:e.id})));default:throw new Error("not ok")}}));var t}function D(e,t,i){(function(e,t){return(0,l.fetch)(`/api/v1/study-templates/${e}/favorite`,{credentials:"same-origin",method:t?"POST":"DELETE"}).then(c)})(e,t).then((e=>{i?.(e?.favorite_date?new Date(e.favorite_date).getTime():null)}))}function x(e,t,i){(function(e,t){return(0,l.fetch)(`/api/v1/study-templates/standard/${e}/favorite`,{credentials:"same-origin",method:t?"POST":"DELETE"}).then(c)})(e,t).then((e=>{i?.(e?.favorite_date?new Date(e.favorite_date).getTime():null)}))}function E(e){return function(e){return(0,l.fetch)(`/api/v1/study-templates/${e}`,{credentials:"same-origin"}).then(c)}(e)}function W(e,t){return function(e){return(0,l.fetch)(`/api/v1/study-templates/standard/${e}`,{credentials:"same-origin"}).then(c)}(e).then(t)}function R(e){return function(e){return(0,l.fetch)(`/api/v1/study-templates/${e}`,{credentials:"same-origin",method:"DELETE"}).then((e=>{if(!e.ok)throw new Error("not ok")}))}(e)}function M(e,t,i){(function(e,t){return(0,l.fetch)(`/api/v1/study-templates/${e}/rename/`,{
credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(c)})(e,{name:t}).then(i)}function k(e,t,i){(function(e,t){return(0,l.fetch)(`/api/v1/study-templates/${e}`,{credentials:"same-origin",method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(c)})(e,{name:t.name,content:t.content,meta_info:t.meta_info||{indicators:[]}}).then((e=>i({result:e})))}function O(e){return function(e){return(0,l.fetch)(`/drawing-templates/${e}/`,{credentials:"same-origin"}).then(d)}(e)}function F(e,t,i){return function(e,t,i){const r=new FormData;return r.append("name",t),r.append("tool",e),r.append("content",i),(0,l.fetch)("/save-drawing-template/",{method:"POST",credentials:"same-origin",body:r}).then(d)}(e,t,i)}function N(e,t){return async function(e,t){const i=await(0,l.fetch)(`/drawing-template/${e}/?templateName=${encodeURIComponent(t)}`,{credentials:"same-origin"}),r=await d(i);return JSON.parse(r.content)}(e,t)}function B(e,t){return function(e,t){const i=new FormData;return i.append("name",t),i.append("tool",e),(0,l.fetch)("/remove-drawing-template/",{method:"POST",credentials:"same-origin",body:i}).then(d)}(e,t)}const V=r},667887:(e,t,i)=>{"use strict";i.d(t,{closeMobileChartPickerCommand:()=>n,openMobileChartPickerCommand:()=>r});const r="OPEN_MOBILE_CHART_PICKER_COMMAND",n="CLOSE_MOBILE_CHART_PICKER_COMMAND"},516380:(e,t,i)=>{"use strict";i.d(t,{TOOLBAR_WIDTH_EXPANDED:()=>r});const r=52},769175:(e,t,i)=>{"use strict";i.d(t,{DrawingToolbarBootloader:()=>a});var r=i(647643),n=i(516380),s=i(510013),o=i(477600);class a extends s.ChunkLoader{constructor(e){super(),this._opts=e,r.isDrawingToolbarVisible.value()&&(this._opts.resizerBridge.negotiateWidth(n.TOOLBAR_WIDTH_EXPANDED),this._opts.resizerBridge.container.value().appendChild((0,o.createStubElem)()))}_startLoading(){return Promise.all([i.e(48753),i.e(98185),i.e(98933),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(61171),i.e(19190),i.e(67780),i.e(84587),i.e(66032),i.e(3359),i.e(15708),i.e(54320),i.e(24973),i.e(61173),i.e(30158),i.e(44213),i.e(10844),i.e(9323),i.e(47827),i.e(28260),i.e(78628),i.e(6376),i.e(99672),i.e(59901),i.e(6461),i.e(25022),i.e(90810),i.e(36178),i.e(79008),i.e(32227),i.e(87473),i.e(91890),i.e(40368),i.e(41957),i.e(12878)]).then(i.bind(i,385824)).then((e=>new e.DrawingToolbarRenderer(this._opts.resizerBridge.container.value(),{...this._opts})))}}},647643:(e,t,i)=>{"use strict";i.d(t,{isDrawingToolbarVisible:()=>l});var r=i(62802),n=i(213377),s=i(820028);const o=!n.enabled("hide_left_toolbar_by_default"),a=r.getBool("ChartDrawingToolbarWidget.visible",o),l=new s.WatchedValue(a)},808209:(e,t,i)=>{"use strict";i.d(t,{HeaderToolbarBootloader:()=>o});var r=i(738979),n=i(477600),s=i(510013);class o extends s.ChunkLoader{constructor(e,t){super(),this._toolsBootloader=e,this._headerProps=t,this._headerProps.resizerBridge.negotiateHeight(r.HEADER_TOOLBAR_HEIGHT_EXPANDED),this._headerProps.resizerBridge.container.value().appendChild((0,n.createStubElem)())}_startLoading(){
return Promise.all([this._toolsBootloader.load(),this._loadHeaderToolbar()]).then((([e,t])=>new t(this._headerProps.resizerBridge.container.value(),{...this._headerProps,tools:e})))}_loadHeaderToolbar(){return Promise.all([i.e(48161),i.e(60268),i.e(10755),i.e(32227),i.e(63005)]).then(i.bind(i,128898)).then((e=>e.HeaderToolbarRenderer))}}},738979:(e,t,i)=>{"use strict";i.d(t,{HEADER_TOOLBAR_HEIGHT_COLLAPSED:()=>s,HEADER_TOOLBAR_HEIGHT_EXPANDED:()=>n});var r=i(541183);const n=parseInt(r["css-value-header-toolbar-height"]),s=3},822176:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AutoSaveEnabledService:()=>n});var r=i(907364);class n extends r.CommonJsonStoreService{constructor(e,t){super(e,t,"AUTO_SAVE_ENABLED_CHANGED","Chart.autoSaveEnabled",!0)}}},111720:(e,t,i)=>{"use strict";i.d(t,{recentStudyTemplatesService:()=>l});var r=i(481251),n=i(907364),s=i(226722),o=i(62802);class a extends n.CommonJsonStoreService{constructor(e,t){super(e,t,"RECENT_STUDY_TEMPLATES_CHANGED","StudyTemplates.recent",[])}remove(e){this.set(this.get().filter((t=>t!==e)))}add(e){const t=this.get().filter((t=>e!==t)),i=[e,...t].slice(0,5);this.set(i)}}const l=(0,r.default)((()=>new a(s.TVXWindowEvents,o)))},755859:(e,t,i)=>{"use strict";i.d(t,{RangeBinding:()=>b});var r=i(547465),n=i(904653),s=i(444372),o=i(477786),a=i(839054);function l(e){const t=function(e){const t=e.value.value,r=o.Interval.parse(t);if(!r.isValid()){if("YTD"===t)return s.t(null,{context:"timeframe_title"},i(119273));if("ALL"===t)return s.t(null,{context:"timeframe_title"},i(858221));if("LASTSESSION"===t)return h(1)}if(r.isMinutes()){const e=r.multiplier();return e%60!=0?c(e):d(e/60)}if(r.isDays())return h(r.multiplier());if(r.isWeeks())return u(r.multiplier());if(r.isMonths()){const e=r.multiplier();return e%12!=0?_(e):g(e/12)}return e.description||e.text}(e),r=function(e){const t=e.targetResolution,i=o.Interval.parse(t);if(i.isMinutes()){const e=i.multiplier();return e%60!=0?p(e):m(e/60)}if(i.isDays())return f(i.multiplier());if(i.isWeeks())return v(i.multiplier());if(i.isMonths()){const e=i.multiplier();return e%12!=0?y(e):S(e/12)}return a.resolutionsMap[t].text}(e);return s.t(null,{replace:{timePeriod:t,timeInterval:r},context:"timeframe_title"},i(458426))}const c=e=>s.t(null,{plural:"{str} minutes",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(995484)),d=e=>s.t(null,{plural:"{str} hours",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(772495)),h=e=>s.t(null,{plural:"{str} days",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(263808)),u=e=>s.t(null,{plural:"{str} weeks",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(6088)),_=e=>s.t(null,{plural:"{str} months",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(712752)),g=e=>s.t(null,{plural:"{str} years",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(396325)),p=e=>s.t(null,{plural:"{str} minutes intervals",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(815489)),m=e=>s.t(null,{plural:"{str} hours intervals",count:e,replace:{str:`${e}`},context:"timeframe_title"
},i(414887)),f=e=>s.t(null,{plural:"{str} days intervals",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(300561)),v=e=>s.t(null,{plural:"{str} weeks intervals",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(960316)),y=e=>s.t(null,{plural:"{str} months intervals",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(548514)),S=e=>s.t(null,{plural:"{str} years intervals",count:e,replace:{str:`${e}`},context:"timeframe_title"},i(278971));class b{constructor(e){this._state={ranges:[]},this._firstBarTime1D=null,this._waitingUpdateAfterSymbolResolved=!0,this._change=new r.Delegate,this._rangeChangedListenerBound=this._onRangeChanged.bind(this);const{chartWidget:t}=this._context=e;t.withModel(null,(()=>{const e=t.model(),i=e.mainSeries();i.onStatusChanged().subscribe(this,this._updateAvailableRanges),i.dataEvents().symbolResolved().subscribe(this,(()=>this._updateRangesByQuotesData())),i.priceScale().properties().childs().lockScale.subscribe(this,(()=>this._updateAvailableRanges()));const r=e.model().appliedTimeFrame();r.subscribe(this._rangeChangedListenerBound),this._rangeChangedListenerBound(r.value()),this._updateRangesByQuotesData()}))}state(){return this._state}onChange(){return this._change}selectRange(e){this._setState({activeRange:e.value.value});const{chartWidgetCollection:t}=this._context,i={val:e.value,res:e.targetResolution};t.setTimeFrame(i)}destroy(){const{chartWidget:e}=this._context;e.withModel(null,(()=>{const t=e.model(),i=t.mainSeries();i.onStatusChanged().unsubscribeAll(this),i.dataEvents().symbolResolved().unsubscribeAll(this),i.quotesProvider().quotesUpdate().unsubscribeAll(this),i.priceScale().properties().childs().lockScale.unsubscribeAll(this),t.model().appliedTimeFrame().unsubscribe(this._rangeChangedListenerBound)})),this._change.destroy(),this._lastAbortController?.abort()}_setState(e){this._state=Object.assign({},this._state,e),this._change.fire(this._state)}_onRangeChanged(e){let t;null!==e&&"period-back"===e.val.type&&(t=e.val.value),this._setState({activeRange:t})}_updateRangesByQuotesData(){const{chartWidget:e}=this._context;if(!e.hasModel())return;this._lastAbortController?.abort();const t=new AbortController;this._lastAbortController=t;const i=e.model().mainSeries();i.quotesProvider().quotesUpdate().unsubscribeAll(this),this._waitingUpdateAfterSymbolResolved=!0,this._firstBarTime1D=null,Promise.race([(0,n.delay)(null,3e3),new Promise((e=>{const t=()=>{void 0!==i.quotes()?.open_price&&(i.quotesProvider().quotesUpdate().unsubscribeAll(this),e())};i.quotesProvider().quotesUpdate().subscribe(this,t),t()}))]).then((()=>{t.signal.aborted||(this._waitingUpdateAfterSymbolResolved=!1,this._updateAvailableRanges())}))}_updateAvailableRanges(e){const{availableTimeFrames:t,chartWidget:i}=this._context;if(!i.hasModel())return;const r=i.model().mainSeries(),n=r.symbolInfo(),s=r.status();if(2===s||1===s||this._waitingUpdateAfterSymbolResolved||e&&!n)return;const o=r.quotes()?.first_bar_time_1d??-1/0;if(this._firstBarTime1D===o)return;this._firstBarTime1D=o
;const a=t(n,s,o).map((e=>({...e,description:l(e)})));this._setState({ranges:a})}}},660702:(e,t,i)=>{"use strict";i.d(t,{TopLeftButtonBootloader:()=>l});var r=i(510013),n=i(847291);const s=parseInt(n["top-left-button-height"]),o=parseInt(n["top-left-button-width"]);var a=i(947317);class l extends r.ChunkLoader{constructor(e){super(),this._props=e,this._props.resizerBridge.negotiateHeight(s),this._props.resizerBridge.negotiateWidth(o),this._props.resizerBridge.container.value().appendChild(function(){const e=document.createElement("div");return e.classList.add(a.topLeftButton,a.stub),e}())}_startLoading(){return this._loadRenderer().then((e=>new e(this._props.resizerBridge.container.value(),this._props)))}_loadRenderer(){return Promise.all([i.e(96044),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(11069),i.e(65743),i.e(61171),i.e(19190),i.e(67780),i.e(95679),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(43329),i.e(98158),i.e(38752),i.e(40887),i.e(66032),i.e(93240),i.e(3359),i.e(19715),i.e(15708),i.e(54320),i.e(27702),i.e(13485),i.e(69965),i.e(67131),i.e(38490),i.e(82332),i.e(78257),i.e(63585),i.e(30158),i.e(44213),i.e(10844),i.e(85014),i.e(94036),i.e(50626),i.e(98559),i.e(4675),i.e(30683),i.e(26070),i.e(32841),i.e(52165),i.e(10330),i.e(28260),i.e(78628),i.e(75316),i.e(91887),i.e(29481),i.e(75973),i.e(61360),i.e(32613),i.e(56022),i.e(20923),i.e(62683),i.e(6376),i.e(74671),i.e(84981),i.e(99672),i.e(68961),i.e(22844),i.e(32227),i.e(35913),i.e(69264),i.e(29308),i.e(90223),i.e(13905),i.e(10379),i.e(19446),i.e(11790),i.e(29899),i.e(69544),i.e(39863)]).then(i.bind(i,298037)).then((e=>e.TopLeftButtonRenderer))}}},357938:(e,t,i)=>{"use strict";i.d(t,{isSupportedLineTool:()=>s,supportedLineTools:()=>o});var r=i(638456),n=i(125226);function s(e){return e in o}const o={cursor:{name:"cursor",onlySelectable:!0},dot:{name:"dot",onlySelectable:!0},arrow_cursor:{name:"arrow",onlySelectable:!0},eraser:{name:"eraser",onlySelectable:!0},measure:{name:"measure",onlySelectable:!0},zoom:{name:"zoom",onlySelectable:!0},brush:{name:"LineToolBrush"},highlighter:{name:"LineToolHighlighter"},text:{name:"LineToolText"},anchored_text:{name:"LineToolTextAbsolute",isAnchored:!0},note:{name:"LineToolNote"},text_note:{name:"LineToolTextNote"},anchored_note:{name:"LineToolNoteAbsolute",isAnchored:!0},signpost:{name:"LineToolSignpost"},callout:{name:"LineToolCallout"},balloon:{name:"LineToolBalloon"},comment:{name:"LineToolComment"},arrow_up:{name:"LineToolArrowMarkUp"},arrow_down:{name:"LineToolArrowMarkDown"},arrow_left:{name:"LineToolArrowMarkLeft"},arrow_right:{name:"LineToolArrowMarkRight"},price_label:{name:"LineToolPriceLabel"},price_note:{name:"LineToolPriceNote"},arrow_marker:{name:"LineToolArrowMarker"},flag:{name:"LineToolFlagMark"},image:{name:"LineToolImage"},table:{name:"LineToolTable"},vertical_line:{name:"LineToolVertLine"},horizontal_line:{name:"LineToolHorzLine"},cross_line:{name:"LineToolCrossLine"},
horizontal_ray:{name:"LineToolHorzRay"},trend_line:{name:"LineToolTrendLine"},info_line:{name:"LineToolInfoLine"},trend_angle:{name:"LineToolTrendAngle"},arrow:{name:"LineToolArrow"},ray:{name:"LineToolRay"},extended:{name:"LineToolExtended"},parallel_channel:{name:"LineToolParallelChannel"},disjoint_angle:{name:"LineToolDisjointAngle"},flat_bottom:{name:"LineToolFlatBottom"},anchored_vwap:{name:"LineToolAnchoredVWAP"},pitchfork:{name:"LineToolPitchfork"},schiff_pitchfork_modified:{name:"LineToolSchiffPitchfork"},schiff_pitchfork:{name:"LineToolSchiffPitchfork2"},inside_pitchfork:{name:"LineToolInsidePitchfork"},pitchfan:{name:"LineToolPitchfan"},gannbox:{name:"LineToolGannSquare"},gannbox_square:{name:"LineToolGannComplex"},gannbox_fixed:{name:"LineToolGannFixed"},gannbox_fan:{name:"LineToolGannFan"},fib_retracement:{name:"LineToolFibRetracement"},fib_trend_ext:{name:"LineToolTrendBasedFibExtension"},fib_speed_resist_fan:{name:"LineToolFibSpeedResistanceFan"},fib_timezone:{name:"LineToolFibTimeZone"},fib_trend_time:{name:"LineToolTrendBasedFibTime"},fib_circles:{name:"LineToolFibCircles"},fib_spiral:{name:"LineToolFibSpiral"},fib_speed_resist_arcs:{name:"LineToolFibSpeedResistanceArcs"},fib_wedge:{name:"LineToolFibWedge"},fib_channel:{name:"LineToolFibChannel"},xabcd_pattern:{name:"LineTool5PointsPattern"},cypher_pattern:{name:"LineToolCypherPattern"},abcd_pattern:{name:"LineToolABCD"},triangle_pattern:{name:"LineToolTrianglePattern"},"3divers_pattern":{name:"LineToolThreeDrivers"},head_and_shoulders:{name:"LineToolHeadAndShoulders"},elliott_impulse_wave:{name:"LineToolElliottImpulse"},elliott_triangle_wave:{name:"LineToolElliottTriangle"},elliott_triple_combo:{name:"LineToolElliottTripleCombo"},elliott_correction:{name:"LineToolElliottCorrection"},elliott_double_combo:{name:"LineToolElliottDoubleCombo"},cyclic_lines:{name:"LineToolCircleLines"},time_cycles:{name:"LineToolTimeCycles"},sine_line:{name:"LineToolSineLine"},long_position:{name:"LineToolRiskRewardLong"},short_position:{name:"LineToolRiskRewardShort"},forecast:{name:"LineToolPrediction"},date_range:{name:"LineToolDateRange"},price_range:{name:"LineToolPriceRange"},date_and_price_range:{name:"LineToolDateAndPriceRange"},bars_pattern:{name:"LineToolBarsPattern"},ghost_feed:{name:"LineToolGhostFeed"},projection:{name:"LineToolProjection"},rectangle:{name:"LineToolRectangle"},rotated_rectangle:{name:"LineToolRotatedRectangle"},circle:{name:"LineToolCircle"},ellipse:{name:"LineToolEllipse"},triangle:{name:"LineToolTriangle"},polyline:{name:"LineToolPolyline"},path:{name:"LineToolPath"},curve:{name:"LineToolBezierQuadro"},double_curve:{name:"LineToolBezierCubic"},arc:{name:"LineToolArc"},icon:{name:"LineToolIcon"},emoji:{name:"LineToolEmoji"},sticker:{name:"LineToolSticker"},regression_trend:{name:"LineToolRegressionTrend"},fixed_range_volume_profile:{name:"LineToolFixedRangeVolumeProfile"}};(0,n.isFeatureEnabled)("hide_tweet_drawingtool")||(o.tweet={name:"LineToolTweet"}),delete o.arrow_left,delete o.arrow_right,(0,r.isSymphonyEmbed)()||(o.idea={
name:"LineToolIdea"}),o.anchored_volume_profile={name:"LineToolAnchoredVolumeProfile"}},585223:(e,t,i)=>{"use strict";i.d(t,{ChartChangesWatcher:()=>o,changedAll:()=>s});var r=i(185419),n=i(547465);const s=3;class o{constructor(e,t,i){this._undoHistoryHasChanges=!1,this._changesMask=0,this._handleMetainfoChanged=()=>{this._changesMask=1|this._changesMask},this._recalculateHaveChanges=()=>{const e=this._changesMask,t=this._undoHistoryHasChanges?1:0,i=this._lineToolsHaveChanges.value()?2:0;this._changesMask=t|i,e!==this._changesMask&&this._onValueChanged.fire(0!==this._changesMask)},this._chartWidgetCollection=e,this._undoHistory=e.undoHistory,this._lineToolsHaveChanges=e.lineToolsSynchronizerHasChanges,this._chartSaver=t,this._globalEvents=i,this._onValueChanged=new n.Delegate,this._hasChangesWV=(0,r.createWVFromGetterAndSubscription)((()=>this.hasChanges()),this.getOnChange()),this._subscribe()}destroy(){this._unsubscribe(),this._onValueChanged.destroy(),this._hasChangesWV.destroy()}changes(){return this._changesMask}hasChanges(){return this._changesMask>0}hasChangesWV(){return this._hasChangesWV}getOnChange(){return this._onValueChanged}_subscribe(){this._globalEvents.subscribe("chart_loaded",this._handleChartLoaded,this),this._globalEvents.subscribe("layout_loaded",this._handleLayoutLoaded,this),this._globalEvents.subscribe("chart_migrated",this._handleChartMigrated,this),this._globalEvents.subscribe("lineToolsResavedFromContent",this._handleChartMigrated,this),this._undoHistory.undoStack().onChange().subscribe(this,this._handleUndoHistoryChange),this._chartSaver?.chartSaved().subscribe(this,this._handleChartSaved),this._lineToolsHaveChanges.subscribe(this._recalculateHaveChanges);this._chartWidgetCollection.metaInfo.name.subscribe(this._handleMetainfoChanged)}_unsubscribe(){this._globalEvents.unsubscribe("chart_loaded",this._handleChartLoaded,this),this._globalEvents.unsubscribe("layout_loaded",this._handleLayoutLoaded,this),this._globalEvents.unsubscribe("chart_migrated",this._handleChartMigrated,this),this._globalEvents.unsubscribe("lineToolsResavedFromContent",this._handleChartMigrated,this),this._undoHistory.undoStack().onChange().unsubscribe(this,this._handleUndoHistoryChange),this._chartSaver?.chartSaved().unsubscribe(this,this._handleChartSaved),this._lineToolsHaveChanges.unsubscribe(this._recalculateHaveChanges);this._chartWidgetCollection.metaInfo.name.unsubscribe(this._handleMetainfoChanged)}_setUndoHistoryHasChanges(e){this._undoHistoryHasChanges=e,this._recalculateHaveChanges()}_handleChartLoaded(){this._setUndoHistoryHasChanges(!1)}_handleLayoutLoaded(){this._setUndoHistoryHasChanges(!1)}_handleUndoHistoryChange(e){e?.affectsState()&&this._setUndoHistoryHasChanges(!0)}_handleChartMigrated(){this._setUndoHistoryHasChanges(!0)}_handleChartSaved(e){e&&this._setUndoHistoryHasChanges(!1)}}},77822:(e,t,i)=>{"use strict";i.d(t,{chartPageSoftRedirect:()=>n});var r=i(588948);function n(){if(!window.is_authenticated)return;if("/chart/"!==location.pathname&&"/chart"!==location.pathname)return;const{uid:e}=(0,
r.getInitData)();if("string"!=typeof e||!/[0-9a-zA-Z]{8,}/.test(e))return void console.error("Invalid chart uid: "+e);const t=new URL(location.href);t.pathname=`/chart/${encodeURI(e)}/`,history.replaceState(history.state,document.title,t.href)}},939926:(e,t,i)=>{"use strict";i.d(t,{waitForModel:()=>r});const r=e=>new Promise((t=>{e.withModel(null,(()=>{t(e.model().model())}))}))},637976:(e,t,i)=>{"use strict";function r(e){return e.getAll().some((e=>e.isInitialized()))}function n(e,t){const i=e.getAll(),r=()=>{t(),i.forEach((e=>{e.chartWidgetInitialized().unsubscribe(null,r)}))};i.forEach((e=>{e.chartWidgetInitialized().subscribe(null,r,!0)}))}i.d(t,{isAnyChartWidgetInitialized:()=>r,waitAnyChartWidgetInitialized:()=>n})},768479:(e,t,i)=>{"use strict";i.d(t,{createFavoriteDrawingToolbar:()=>a,getFavoriteDrawingToolbarPromise:()=>o});var r=i(738979);let n=null,s=null;function o(){return s}function a(){null===s&&(s=Promise.all([i.e(40701),i.e(92537),i.e(98185),i.e(98933),i.e(22956),i.e(61681),i.e(63039),i.e(6612),i.e(67780),i.e(95679),i.e(66032),i.e(3359),i.e(13672),i.e(3016),i.e(61667),i.e(93853),i.e(95275),i.e(1462),i.e(51979),i.e(47827),i.e(28260),i.e(88220),i.e(99590),i.e(75728),i.e(16804),i.e(36178),i.e(66427),i.e(32227),i.e(5483),i.e(91890),i.e(19507),i.e(22306)]).then(i.bind(i,509067)).then((({FavoriteDrawingToolbar:e})=>(n=null!==n?n:new e({left:window.innerWidth/2,top:r.HEADER_TOOLBAR_HEIGHT_EXPANDED+61}),n))))}},678792:(e,t,i)=>{"use strict";i.d(t,{autoplayDelayOptionItems:()=>s,findAutoplayDelayOptionItems:()=>o});var r=i(650151),n=i(444372);const s=[{label:"10x",description:n.t(null,void 0,i(172588)),value:100},{label:"7x",description:n.t(null,void 0,i(498583)),value:143},{label:"5x",description:n.t(null,void 0,i(475830)),value:200},{label:"3x",description:n.t(null,void 0,i(45648)),value:300},{label:"1x",description:n.t(null,void 0,i(866404)),value:1e3},{label:"0.5x",description:n.t(null,void 0,i(898636)),value:2e3},{label:"0.3x",description:n.t(null,void 0,i(816992)),value:3e3},{label:"0.2x",description:n.t(null,void 0,i(481558)),value:5e3},{label:"0.1x",description:n.t(null,void 0,i(624501)),value:1e4}];function o(e){const t=s.find((t=>t.value===e));return(0,r.assert)(void 0!==t,"This delay dosen't exist"),t}},313171:(e,t,i)=>{"use strict";i.d(t,{getReplayUiControllerInstance:()=>n});let r=null;function n(e,t){const n=i=>({controller:new i.ReplayUIController(e,t),createReplayWV:"createReplayWV"in i?i.createReplayWV:void 0})
;return r||(r=Promise.all([i.e(95605),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(52186),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(65743),i.e(61171),i.e(67780),i.e(95679),i.e(87833),i.e(76052),i.e(43329),i.e(66032),i.e(97540),i.e(25563),i.e(3359),i.e(72232),i.e(24973),i.e(79317),i.e(13672),i.e(38490),i.e(50626),i.e(32841),i.e(78251),i.e(44059),i.e(1462),i.e(46609),i.e(79487),i.e(81104),i.e(3361),i.e(47624),i.e(60268),i.e(29019),i.e(21720),i.e(56644),i.e(75728),i.e(23250),i.e(15404),i.e(20759),i.e(32227),i.e(91276),i.e(90223),i.e(95518),i.e(53961),i.e(62684),i.e(26655),i.e(13726),i.e(47286),i.e(6932)]).then(i.bind(i,606529)).then(n)),r}},519129:(e,t,i)=>{"use strict";i.d(t,{checkAuthBeforeSaveLoad:()=>s});var r=i(213377),n=i(541543);function s(e,t){r.enabled("saveload_requires_authentication")?(0,n.runOrSigninWithFeature)(e,{...t,feature:"savedCharts"}):e()}},934588:(e,t,i)=>{"use strict";i.d(t,{FAVORITE_LAYOUTS_LIMIT:()=>n,favoriteLayoutsHintStateHandler:()=>s});var r=i(889110);const n=20,s=r.defaultHintStateHandler},570632:(e,t,i)=>{"use strict";i.d(t,{LoadChartService:()=>p});var r=i(444372),n=i(779923),s=i(213377),o=i(507778),a=i(519129),l=i(584317),c=i(820028),d=i(904653),h=i(803912),u=i(638456),_=i(934588);function g(){return!(s.enabled("saveload_requires_authentication")&&!window.is_authenticated)}class p extends l.DialogRenderer{constructor(e=null){super(),this._chartWidgetCollection=null,this._promise=null,this._dialog=null,this._onLoginStateChange=()=>{g()||this._setState({chartList:[],favorites:{},recents:[]})},this._onActiveChartNameChange=e=>{const{chartList:t}=this._state.value(),i=this._chartWidgetCollection;if(!i)return;const r=[];let n;t.forEach((t=>{if(t.id===i.metaInfo.id.value())return n=t,void r.push({...t,name:e});r.push(t)})),n&&this._setState({chartList:r})},this._subscribe=e=>{this._setVisibility(e)},this._getChartEntry=e=>({id:e.id,url:e.url,name:e.name,symbol:e.short_symbol,interval:e.interval,toolsCount:0,modified:e.modified_iso,favorite:e.favorite,active:()=>this._isActiveChart(e.id),openAction:(t,i)=>this.loadChart(e,t,i),deleteAction:()=>this._deleteChart(e),favoriteAction:()=>this._handleFavorite(e)}),this._isActiveChart=e=>null!==this._chartWidgetCollection&&e===this._chartWidgetCollection.metaInfo.id.value(),this._deleteChart=e=>o.backend.removeChart(e.image_url).then((()=>{const{chartList:t,favorites:i}=this._state.value(),r=t.filter((t=>t.id!==e.id));if(this._favoriteChartsService){const t={...i};t[e.id]&&delete t[e.id],this._favoriteChartsService.set(t)}g()&&this._setState({chartList:r}),this._isActiveChart(e.id)&&(s.enabled("saveload_storage_customization")||(0,u.isSymphonyEmbed)()?null!==this._chartWidgetCollection&&this._chartWidgetCollection.clearChartMetaInfo():location.href="/chart/"+location.search)})),this._chartWidgetCollection=e;const t=this._favoriteChartsService?.get()||{};this._state=new c.WatchedValue({chartList:[],recents:[],favorites:t}),
this._chartWidgetCollection?.metaInfo.name.subscribe(this._onActiveChartNameChange),window.loginStateChange.subscribe(null,this._onLoginStateChange)}showLoadDialog(){(0,a.checkAuthBeforeSaveLoad)(this._showLoadDialog.bind(this),{source:"Load chart",sourceMeta:"Chart"})}show(){this.showLoadDialog()}hide(){this._dialog?.hide(),this._dialog?.visible().unsubscribe(this._subscribe)}state(){return this._state.readonly()}refreshChartList(e){return(g()?o.backend.getCharts():Promise.resolve([])).then((t=>{if(!g())return;const i=t.map(this._getChartEntry);this._setState({chartList:i,favorites:this._initFavorites(i)}),void 0!==e&&e()}))}getRecentCharts(e){g()&&o.backend.getCharts(e,4).then((e=>{if(!g())return;const t=e.map(this._getChartEntry).sort(((e,t)=>t.modified-e.modified));this._setState({recents:t,favorites:{...this._state.value().favorites,...this._initFavorites(t)}})})).catch((e=>{(0,d.isAbortError)(e)}))}async deleteAllFavorites(){this._setState({favorites:{}}),await(0,h.fetch)("/my-charts/all/change-favorite-state/",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({favorite:!1})})}async loadChart(e,t,s){if(!(0,u.isSymphonyEmbed)()&&t)o.backend.openLayoutLink(e,t);else{function a(){if((0,u.isSymphonyEmbed)()){const t=new URL(window.location.href);return t.pathname=`/chart/${e.url}/`,t.searchParams.append("symphony","true"),t}return`/chart/${e.url}/`}const l=a(),c=async()=>{const t=await o.backend.loadLayout(e);await(this._chartWidgetCollection?.loadLayoutState(t)),window.history.replaceState(null,"",l)};if(!s&&this._chartWidgetCollection?.hasChanges().value()){if(!await new Promise((e=>{(0,n.showConfirm)({id:"unsaved-changes",title:r.t(null,void 0,i(788964)),content:r.t(null,void 0,i(285296)),mainButtonText:r.t(null,void 0,i(477049)),cancelButtonText:r.t(null,void 0,i(904543)),onConfirm:({dialogClose:t})=>{e(!0),t()},onCancel:({dialogClose:t})=>{e(!1),t()}})})))return}await c()}}async loadChartByUrl(e,t,i){let r=this._state.value().chartList.find((t=>t.url===e));r||(await this.refreshChartList(),r=this._state.value().chartList.find((t=>t.url===e))),await(r?.openAction(t,i))}async _handleFavorite(e){const{favorites:t}=this._state.value(),i={...t};i[e.id]?delete i[e.id]:i[e.id]=!0,await this._changeFavoriteState(i,e.id,e.image_url),g()&&this._setState({favorites:i})}_showLoadDialog(){this.refreshChartList((()=>{const e=this._promise=Promise.all([i.e(45121),i.e(92537),i.e(98185),i.e(98933),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(14391),i.e(71450),i.e(97540),i.e(25563),i.e(72232),i.e(13485),i.e(93015),i.e(30158),i.e(44213),i.e(44535),i.e(30683),i.e(37463),i.e(51979),i.e(47827),i.e(28260),i.e(92091),i.e(10853),i.e(88130),i.e(50973),i.e(45324),i.e(7156),i.e(32227),i.e(87473),i.e(64940),i.e(73321),i.e(75009)]).then(i.bind(i,605265)).then((t=>{this._promise===e&&(this._dialog&&(this._dialog.hide(),this._dialog.visible().unsubscribe(this._subscribe)),this._dialog=new t.LoadChartDialogRenderer({
chartWidgetCollection:this._chartWidgetCollection,serviceState:this.state()}),this._dialog.visible().subscribe(this._subscribe),this._dialog.show())}))}))}_setState(e){this._state.setValue({...this._state.value(),...e})}async _changeFavoriteState(e,t,i){const{favorites:r}=this._state.value(),n=Boolean(e[t]);_.favoriteLayoutsHintStateHandler.getHintState("hint.favoriteLayouts")&&Object.keys(r).length<=_.FAVORITE_LAYOUTS_LIMIT&&Object.keys(e).length>_.FAVORITE_LAYOUTS_LIMIT&&_.favoriteLayoutsHintStateHandler.setHintState("hint.favoriteLayouts"),await(0,h.fetch)(`/my-charts/${i}/change-favorite-state/`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({favorite:n})})}_initFavorites(e){const t={};return e.filter((e=>e.favorite)).forEach((e=>{t[e.id]=!0})),t}}},297652:(e,t,i)=>{"use strict";i.d(t,{SaveChartService:()=>M});var r=i(213377),n=i(820028),s=i(822176),o=i(226722),a=i(62802),l=i(251954),c=i(585223),d=i(519129),h=i(125226);i(142492);const u=r.enabled("atsv2s");var _=i(444372),g=i(803912),p=i(552279),m=i(229534),f=i(503595),v=i(314802);const y=_.t(null,void 0,i(211218)),S=_.t(null,void 0,i(796225)),b=_.t(null,void 0,i(491547));function w(e,t={}){window.runOrSignIn((()=>{(0,f.asyncWindowOpen)(async function(e,t){let i,r;try{r=await(0,g.fetch)(`/charts/${e}/clone/`,{method:"POST",body:JSON.stringify(t),credentials:"include"});const n=r.headers.get("location");if(r.ok&&n)return(0,v.urlWithMobileAppParams)(n);i=(await r.json()).code}catch{}"count_limit"===i||"login_required"===i?(0,p.reloginOrGoPro)({feature:"savedChartsLimit"}):r||!1!==navigator.onLine?r&&r.status>=500||"feature_disabled"===i?(0,m.showErrorDialog)({content:S}):(0,m.showErrorDialog)({content:y}):(0,m.showErrorDialog)({content:b});return}(e,t))}),{source:"Clone_chart_layout"})}var C=i(507778),T=i(925470);async function P(){if(!window.is_authenticated)return!1;if(!r.enabled("saved_charts_count_restriction"))return!0;const e=(0,T.getConfig)("CHART_STORAGE")?.limit;if(void 0===e||e<=0)return!1;try{return e>await new Promise(C.backend.getChartsCount)}catch(e){if(403===e.status)return!1;throw e}}var A=i(779923);class I{constructor(e,t,i){this._visibility=new n.WatchedValue(!1),this._chartWidgetCollection=e,this._doSave=t,this._doLoad=i}hide(){this._hide?.(),this._visibility.setValue(!1)}visible(){return this._visibility.readonly()}_showDialog(e,t,i,r){return(0,A.showRename)({title:this._dialogTitle(),text:this._dialogText(),maxLength:64,emojiPicker:!0,initValue:e,onRename:async e=>{this._actionHandler(e,t,i,r)},onClose:()=>this._visibility.setValue(!1)})}_doSaveCurrentLayout(e,t,i,r){const n=this._chartWidgetCollection.metaInfo.name.value();this._chartWidgetCollection.metaInfo.name.setValue(e),this._doSave(t,i,(()=>{this._chartWidgetCollection.metaInfo.name.setValue(n),r?.()}))}_doOverwriteExistingLayout(e,t,i,r,n){const s=this._chartWidgetCollection.metaInfo.name.value();this._chartWidgetCollection.metaInfo.id.setValue(e),this._chartWidgetCollection.metaInfo.name.setValue(t),this._doSave(i,r,(()=>{
this._chartWidgetCollection.metaInfo.name.setValue(s),n?.()}))}}class L extends I{cloneChart(){this._cloneChart().then((()=>this._visibility.setValue(!0)))}show(){(0,d.checkAuthBeforeSaveLoad)((()=>this.cloneChart()),{source:"Clone chart"})}_dialogTitle(){return _.t(null,void 0,i(166134))}_dialogText(){return _.t(null,void 0,i(609541))+":"}_actionHandler({newValue:e,dialogClose:t}){r.enabled("saveload_storage_customization")?this._doCloneCurrentLayout(e):w(this._chartWidgetCollection.metaInfo.uid.value(),{name:e}),t()}async _cloneChart(){let e;await new Promise((e=>{window.runOrSignIn(e,{source:"Clone_chart_layout"})}));try{e=await P()}catch{return void(0,m.showErrorDialog)({content:_.t(null,void 0,i(673013))})}e?e&&(this._hide=await this._showDialog(this._getInitialRenameDialogInput())):(0,p.reloginOrGoPro)({feature:"savedChartsLimit"})}_doCloneCurrentLayout(e){const t=this._chartWidgetCollection.metaInfo.name.value();this._chartWidgetCollection.metaInfo.uid.deleteValue(),this._chartWidgetCollection.metaInfo.id.deleteValue(),this._chartWidgetCollection.metaInfo.name.setValue(e),this._doSave(void 0,void 0,(()=>{this._chartWidgetCollection.metaInfo.name.setValue(t)}))}_getInitialRenameDialogInput(){return _.t(null,{context:"ex: AAPL chart copy"},i(297559)).format({title:this._chartWidgetCollection.metaInfo.name.value()})}}var D=i(638456),x=i(240482);class E extends I{show(){this._showDialog()}_actionHandler({dialogClose:e}){e()}_dialogTitle(){return _.t(null,void 0,i(280050))}_dialogText(){return _.t(null,void 0,i(399709))}async _showDialog(){const e={title:this._dialogTitle(),text:this._dialogText(),maxLength:64,placeholder:_.t(null,void 0,i(845408)),onCreate:({newValue:e,onSameTab:t,dialogClose:i})=>{(0,x.openNewChart)({onSameTab:!(0,D.isSymphonyEmbed)()&&t,name:e}),this._actionHandler({newValue:e,dialogClose:i})}},t=P(),r=Promise.all([Promise.all([i.e(61560),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(65743),i.e(61171),i.e(67780),i.e(66032),i.e(79317),i.e(13672),i.e(30158),i.e(44213),i.e(30683),i.e(9323),i.e(60159),i.e(61144),i.e(30775),i.e(90320),i.e(32227),i.e(87473),i.e(62526),i.e(63469),i.e(45553),i.e(38890)]).then(i.bind(i,190916)),Promise.all([i.e(57605),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(65743),i.e(61171),i.e(67780),i.e(95679),i.e(76052),i.e(66032),i.e(79317),i.e(13672),i.e(30158),i.e(44213),i.e(30683),i.e(9323),i.e(60159),i.e(61144),i.e(30775),i.e(27459),i.e(32227),i.e(87473),i.e(45553),i.e(38606)]).then(i.bind(i,930083))]);if(await t){const[{showSimpleDialog:t},{Create:i}]=await r;return t(e,i)}(0,p.reloginOrGoPro)({feature:"savedChartsLimit"})}}class W extends I{show(e,t,i){const r="function"==typeof e?e:void 0;this._saveNewChart(r,t,i).then((()=>this._visibility.setValue(!0)))}_dialogTitle(){return _.t(null,void 0,i(443047))}_dialogText(){return _.t(null,void 0,i(609541))+":"}_actionHandler({newValue:e,dialogClose:t},i,r,n){this._doSaveCurrentLayout(e,i,r,n),t()}
async _saveNewChart(e,t,r){let n;try{n=await P()}catch{return void(0,m.showErrorDialog)({content:_.t(null,void 0,i(673013))})}if(!n)return void(0,p.reloginOrGoPro)({feature:"savedChartsLimit"});const s=this._chartWidgetCollection.metaInfo.name.value();this._hide=await this._showDialog(s,e,t,r)}}class R extends I{show(){(0,d.checkAuthBeforeSaveLoad)((()=>this._show()),{source:"Rename chart"})}_dialogTitle(){return _.t(null,void 0,i(422584))}_dialogText(){return _.t(null,void 0,i(609541))+":"}_actionHandler({newValue:e,dialogClose:t}){this._doSaveCurrentLayout(e),t()}async _show(){await this._renameChart(),this._visibility.setValue(!0)}async _renameChart(){const e=this._chartWidgetCollection.metaInfo.name.value();this._hide=await this._showDialog(e)}}class M{constructor(e,t){this._autosaveTimer=null,this._watchedAutoSaveEnabled=new n.WatchedValue,this._toggleAutoSaveEnabledHandler=this._toggleAutoSaveEnabled.bind(this),this._doSave=(e,t,i,r)=>{void 0!==e&&e();const n=this._chartChangesWatcher.changes();this._chartSaver.saveChartSilently((e=>{var i;e&&e.uid===this.layoutId()&&(i=e.uid,"/chart/"===location.pathname&&(location.href="/chart/"+i)),void 0!==t&&t(e)}),(()=>{void 0!==i&&i()}),{autoSave:Boolean(r),changes:n})},this._doLoad=()=>C.backend.getCharts(),this._chartWidgetCollection=e,this._chartSaver=t,this._createController=new W(e,this._doSave,this._doLoad),this._renameController=new R(e,this._doSave,this._doLoad),this._saveAsController=new L(e,this._doSave,this._doLoad),this._autoSaveEnabledSetting=new s.AutoSaveEnabledService(o.TVXWindowEvents,a),this._createEmptyController=new E(e,this._doSave,this._doLoad),this._chartSaver.chartSizeLimitExceeded().subscribe(null,(()=>{const e=this._chartWidgetCollection.activeChartWidget.value();Promise.all([i.e(65153),i.e(3016),i.e(41392),i.e(67799),i.e(66534),i.e(71761),i.e(11194),i.e(64935),i.e(25977),i.e(30938),i.e(26820)]).then(i.bind(i,809262)).then((({showSizeLimitExceededDialog:t})=>{t(e)}))})),this._chartChangesWatcher=new c.ChartChangesWatcher(e,t,l),e.saveKeysPressed().subscribe(this,this.saveChartOrShowTitleDialog);{const e=!!window.is_authenticated&&(this._autoSaveEnabledSetting?.get()??!0);e&&this._enableAutoSave(),this._watchedAutoSaveEnabled.setValue(e),this._watchedAutoSaveEnabled.subscribe(this._toggleAutoSaveEnabledHandler),this._autoSaveEnabledSetting?.getOnChange().subscribe(this,this._autoSaveEnabledSettingHandler)}}autoSaveEnabled(){return this._watchedAutoSaveEnabled}destroy(){this._watchedAutoSaveEnabled.unsubscribe(),delete this._watchedAutoSaveEnabled,this._autoSaveEnabledSetting?.destroy(),delete this._autoSaveEnabledSetting}getCreateController(){return this._createController}getRenameController(){return this._renameController}getSaveAsController(){return this._saveAsController}cloneChart(){this._saveAsController.cloneChart()}createEmptyChart(){this._createEmptyController?.show()}saveChartAs(){this._saveAsController.show()}renameChart(){this._renameController.show()}saveNewChart(e,t,i){this._createController.show(e,t,i)}saveExistentChart(e,t,i){
this._doSave(e,t,i)}changes(){return this._chartChangesWatcher.changes()}hasChanges(){return 0!==this._chartChangesWatcher.changes()}hasChangesWV(){return this._chartChangesWatcher.hasChangesWV()}getOnChanges(){return this._chartChangesWatcher.getOnChange()}saveChartOrShowTitleDialog(e,t,i){const r=window.saver.isSaveInProcess(),n=this._chartChangesWatcher.hasChanges(),s=!!this.layoutId();window.is_authenticated&&(r||!n&&s)||(0,d.checkAuthBeforeSaveLoad)((()=>{null!=this._chartWidgetCollection.metaInfo.id.value()?this.saveExistentChart(e,t,i):this.saveNewChart(e,t,i)}),{source:"Save chart",sourceMeta:"Chart"})}saveToJSON(e){return this._chartSaver.saveToJSON(e)}saveChartSilently(e,t,i){this._chartSaver.saveChartSilently(e,t,i)}setAutoSaveEnabled(e){window.is_authenticated&&window.saver.isSaveInProcess()||(0,d.checkAuthBeforeSaveLoad)((()=>{this._watchedAutoSaveEnabled.setValue(e)}),{source:"AutoSave chart"})}saveChartLineTools(e,t,i,r){return this._chartSaver.saveChartLineTools(e,t,i,r)}layoutId(){return this._chartWidgetCollection.metaInfo.uid.value()}chartSaved(){return this._chartSaver.chartSaved()}_autoSaveEnabledSettingHandler(e){this._watchedAutoSaveEnabled.setValue(e)}_toggleAutoSaveEnabled(e){window.is_authenticated&&(e?this._enableAutoSave():this._disableAutoSave(),this._autoSaveEnabledSetting?.set(e,{forceFlush:!0}))}_enableAutoSave(){this._chartChangesWatcher.getOnChange().subscribe(this,this._onStateChanged),this._chartChangesWatcher.hasChanges()&&this._doSave(void 0,void 0,void 0,!0)}_disableAutoSave(){this._stopAutosave(),this._chartChangesWatcher.getOnChange().unsubscribeAll(this)}_onStateChanged(e){e?this._startAutosave():this._stopAutosave()}_startAutosave(){r.enabled("charts_auto_save")&&null===this._autosaveTimer&&(this._autosaveTimer=setTimeout((()=>{this._autosaveTimer=null,window.is_authenticated?this._chartWidgetCollection.metaInfo.id.value()&&this._doSave(void 0,void 0,void 0,!0):this._startAutosave()}),u?2e3:(0,h.isFeatureEnabled)("chart_autosave_2min")?12e4:(0,h.isFeatureEnabled)("chart_autosave_3min")?18e4:(0,h.isFeatureEnabled)("chart_autosave_5min")?3e5:(0,h.isFeatureEnabled)("chart_autosave_7min")?42e4:(0,h.isFeatureEnabled)("chart_autosave_10min")?6e5:(0,h.isFeatureEnabled)("chart_autosave_20min")?12e5:(0,h.isFeatureEnabled)("chart_autosave_30min")?18e5:(0,h.isFeatureEnabled)("chart_autosave_year")?31536e6:6e4))}_stopAutosave(){null!==this._autosaveTimer&&(clearInterval(this._autosaveTimer),this._autosaveTimer=null)}}},924423:(e,t,i)=>{"use strict";i.d(t,{SharingChartService:()=>s});var r=i(820028),n=i(226722);class s{constructor(e,t,i=0){this._requestInProgress=!1,this._watchedSharingEnabled=new r.WatchedValue,this._sharingValueChangedEvent="SharingValueChanged",this._uid=t,this._chartId=i,this._watchedSharingEnabled.setValue(e),n.TVXWindowEvents.on(this._sharingValueChangedEvent,(e=>{const t=JSON.parse(e);this._chartId===t.chartId&&this._watchedSharingEnabled.setValue(t.value)}))}destroy(){this._watchedSharingEnabled.unsubscribe()}sharingEnabled(){
return this._watchedSharingEnabled.readonly()}setSharingEnabled(e){window.runOrSignIn((()=>this._setSharing(e)),{source:"Sharing chart"})}toggleSharing(){const e=!this._watchedSharingEnabled.value();return this.setSharingEnabled(e),e}async _setSharing(e){if(!1===this._requestInProgress&&this._watchedSharingEnabled.value()!==e){this._watchedSharingEnabled.setValue(e),this._sendSyncEvent({chartId:this._chartId,value:e});try{this._requestInProgress=!0,await this._saveSharingValue(e)}catch(t){this._watchedSharingEnabled.setValue(!e),this._sendSyncEvent({chartId:this._chartId,value:!e})}finally{this._requestInProgress=!1}}}_sendSyncEvent(e){n.TVXWindowEvents.emit(this._sharingValueChangedEvent,JSON.stringify(e))}_saveSharingValue(e){const t=JSON.stringify({is_private:!e});return fetch(`/api/v1/charts/${this._uid}/sharing/`,{headers:new Headers({"Content-Type":"application/json"}),method:"POST",credentials:"same-origin",body:t})}}},378435:(e,t,i)=>{"use strict";i.d(t,{getStudyTemplateDescString:()=>l,getStudyTemplateMetaInfo:()=>o,getStudyTemplateSaveData:()=>a});var r=i(816433),n=i(128090),s=i(331751);function o(e,t){return{indicators:e.orderedDataSources(!0).filter((e=>(0,n.isStudy)(e)&&!(0,s.isLollipopDataSource)(e))).map((e=>({id:e.metaInfo().id,description:e.title(r.TitleDisplayTarget.StatusLine,!0,void 0,!0)}))),interval:t}}function a(e,t,i,r){const n=t.studyTemplate(i,r);return{name:e,content:JSON.stringify(n),meta_info:o(t,n.interval)}}function l(e){const t=new Map;return e.forEach((e=>{const[i,r]=t.get(e.id)||[e.description,0];t.set(e.id,[i,r+1])})),Array.from(t.values()).map((([e,t])=>`${e}${t>1?` x ${t}`:""}`)).join(", ")}},406312:(e,t,i)=>{"use strict";i.d(t,{StudyTemplates:()=>h});var r=i(444372),n=i(507778),s=i(345848),o=i(547465),a=i(820028),l=i(779923);const c=(0,i(735566).getLogger)("Platform.StudyTemplates"),d=r.t(null,void 0,i(715096));class h{constructor(e){this._chartWidgetCollection=e.chartWidgetCollection,this._recentStudyTemplatesService=e.recentStudyTemplatesService,window.loginStateChange.subscribe(null,n.backend.invalidateStudyTemplatesList),this._list=new a.WatchedValue([]),this._onChange=new o.Delegate,this._list.subscribe((()=>this._onChange.fire()))}findRecordByName(e){return this._list.value().find((t=>t.name===e))||null}showSaveAsDialog(e){const t=this._chartWidgetCollection.activeChartWidget.value().model();Promise.all([i.e(58140),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(65743),i.e(61171),i.e(67780),i.e(95679),i.e(76052),i.e(66032),i.e(97540),i.e(25563),i.e(72232),i.e(13672),i.e(30158),i.e(44213),i.e(30683),i.e(79487),i.e(9323),i.e(60159),i.e(61144),i.e(30775),i.e(17519),i.e(32227),i.e(87473),i.e(45553),i.e(36631)]).then(i.bind(i,61995)).then((i=>{new i.StudyTemplateSaver({controller:t,onSave:(e,t)=>{t&&this._recentStudyTemplatesService?.add(t),this._list.setValue(e)}}).show(e)}))}applyTemplate(e){const t=this.findRecordByName(e);null!==t?window.runOrSignIn((async()=>{
const{id:e,name:i,is_default:r}=t,o=this._chartWidgetCollection.activeChartWidget.value(),a=e=>{(0,s.trackEvent)("GUI","Load Study Template"),o.model().applyStudyTemplate(JSON.parse(e.content),i)};r&&"number"==typeof e?await n.backend.getStandardStudyTemplateById(e,a):await n.backend.getStudyTemplateById(e).then(a)}),{source:"Study templates apply"}):c.logNormal(`Template ${e} not found in cache`)}deleteStudyTemplate(e,t,i){const r=this.findRecordByName(e);null!==r?this._removeTemplate(r,t,i):c.logNormal(`Template ${e} not found in cache`)}list(){return this._list.value()}getOnChange(){return this._onChange}refreshStudyTemplateList(e){n.backend.getStudyTemplatesList().then((t=>{this._list.setValue(t),void 0!==e&&e()}))}invalidate(){n.backend.invalidateStudyTemplatesList()}_removeTemplate(e,t,i){window.runOrSignIn((()=>{(0,l.showConfirm)({text:d.format({name:e.name}),onConfirm:({dialogClose:t})=>new Promise((r=>{n.backend.invalidateStudyTemplatesList(),n.backend.removeStudyTemplate(e.id).then((()=>{this.refreshStudyTemplateList((()=>{const n=this.list();this._list.setValue(n.filter((t=>t!==e))),this._recentStudyTemplatesService&&this._recentStudyTemplatesService.remove(e.id),r(),t(),i?.()}))}))}))},t)}),{source:"Study templates delete"})}}},569897:(e,t,i)=>{"use strict";i.d(t,{makeSnapshotRequest:()=>l,takeChartSnapshot:()=>a,takeChartSnapshotPromise:()=>o});i(142492);var r=i(444372),n=i(229534),s=i(803912);function o(e,t={}){return new Promise(((i,r)=>{a(e,i,r,t).catch(r)}))}async function a(e,t,i,r={}){const n=new FormData;if(void 0!==r.previews)for(const e of r.previews)n.append("previews[]",e);void 0!==r.cme&&n.append("cme",String(r.cme)),void 0!==r.wl&&n.append("wl",String(r.wl)),void 0!==r.onWidget&&n.append("onWidget",String(r.onWidget)),r.isReport&&n.append("isReport",String(r.isReport)),r.asyncSave&&n.append("asyncSave",String(r.asyncSave));const s=window.urlParams;s&&s.locale&&n.append("language",s.locale);const o=e.activeChartWidget.value(),a=o.widgetCustomer();void 0!==a&&n.append("customer",a);const c=o.model().model().timezoneExceptExchange().value()??"exchange";n.append("timezone",c),n.append("symbol",o.model().mainSeries().symbol());const d=await e.clientSnapshot({showHeaderMainSymbol:r.showHeaderMainSymbol}),h=await new Promise((e=>d.toBlob(e)));null!==h&&n.append("preparedImage",h),l(n,t,i,r)}async function l(e,t,o,a={}){try{const l=await(0,s.fetch)("/snapshot/",{body:e,method:"POST",credentials:"same-origin"}),c=await l.text();if(l.ok)t(c);else{if("suspicious_chart_snapshots_error"===c){const e=r.t(null,void 0,i(124760)).format({start_link:'<a class="tv-dialog__link js-send-report-link" href="#" data-issue-type="other">',end_link:"</a>"});a.onInvalidSnapshotImage&&a.onInvalidSnapshotImage();return(0,n.createErrorDialog)({title:r.t(null,void 0,i(161498)),content:e,btnType:"danger"}).then((e=>{e.on("afterOpen",(()=>{i.e(1484).then(i.bind(i,822045)).then((({bugDialogCreationHandler:t})=>{t(),e.$el.find(".js-send-report-link").click((()=>{e.close()}))}))})),e.open()}))}o()}}catch{o()}}},
792598:(e,t,i)=>{"use strict";i.d(t,{getDeviceId:()=>o});var r=i(623213);const n="device-id";let s;function o(){return s||(s=window.localStorage.getItem(n),s||(window.localStorage.setItem(n,(0,r.guid)()),s=window.localStorage.getItem(n),s||"N/A"))}},533126:(e,t,i)=>{"use strict";var r;i.d(t,{TradingPage:()=>r,maxPanelWidth:()=>n,minPanelWidth:()=>s,panelHeight:()=>o}),function(e){e.DOMPanel="domPanel",e.OrderPanel="orderPanel"}(r||(r={}));const n=400,s=315,o=451},893935:(e,t,i)=>{"use strict";i.d(t,{isBrokerHidden:()=>_,isMobileTradingAvailable:()=>h,isMobileTradingAvailableInApp:()=>u,isSmallScreen:()=>g});var r=i(638456),n=i(125226),s=i(314802),o=i(213377);const a=(0,n.isFeatureEnabled)("mobile_trading_ios")&&r.CheckMobile.iOS()&&(0,s.isOnMobileAppPage)("old"),l=(0,n.isFeatureEnabled)("mobile_trading_android")&&r.CheckMobile.Android()&&(0,s.isOnMobileAppPage)("new"),c=(0,n.isFeatureEnabled)("mobile_trading_web")&&r.CheckMobile.any()&&!r.CheckMobile.isIPad()&&g()&&!(0,s.isOnMobileAppPage)("any"),d=o.enabled("mobile_trading")&&(a||l||c);function h(){return d}function u(){return a||l}function _(e){return a?(0,n.isFeatureEnabled)(`hide_${e}_on_ios`):l?(0,n.isFeatureEnabled)(`hide_${e}_on_android`):!!c&&(0,n.isFeatureEnabled)(`hide_${e}_on_mobile_web`)}function g(){return window.matchMedia("(orientation: portrait) and (max-width: 567px)").matches||window.matchMedia("(orientation: landscape) and (max-height: 567px)").matches}},624505:(e,t,i)=>{"use strict";i.d(t,{settingsKeys:()=>r});const r={ACTIVE_BROKER:"trading.active_broker",PROPERTIES:"trading.chart.proterty",PROFIT_VIEW_TYPE:"trading.dom.profitViewType",ORDER_WIDGET_MODE:"trading.orderWidgetMode.",DOM_DURATION:"trading.domDuration.",TRADING_PANEL_OPENED:"trading.tradingPanelOpened",TRADING_PANEL_ACTIVE_PAGE:"trading.tradingPanelActivePage",PANEL_WIDTH:"trading.panelWidth",PANEL_INFO_HEIGHT:"trading.panelInfoHeight",ORDER_PANEL_SETTINGS:"trading.orderPanelSettings",FAVORITE_BROKERS:"trading.panelFavorite",SHOW_TOOLTIP_FOR_SELECT_BROKER:"trading.showTooltipForSelectBroker",SHOW_TOOLTIP_FOR_TRADE_BUTTON:"trading.showTooltipForTradeButton",LOGIN_COUNTER:"trading.brokerLogInCounter",LOGOUT_COUNTER:"trading.brokerLogOutCounter",DISABLED_CONFIRMATIONS:"trading.disabledConfirmations",MOVE_TRADED_SOURCE_WITH_SHIFT:"trading.chart.moveWithShift",REALTIME_DATA_ACCEPTED:"trading.realTimeDataAccepted",PAPER_COMPETITION_POPUP_SHOWN_TIMESTAMP:"trading.paperCompetitionPopupShownTimestamp",PAPER_COMPETITION_POPUP_SHOWN_TIMESTAMP_2:"trading.paperCompetitionPopupShownTimestamp2",LAST_RISK_QUANTITY_TYPE:"trading.lastRiskQuantityType",STATIC_DOM_HINT:"trading.staticDOMHint",PAPER_COMPETITION_SUBACCOUNT_HINT:"trading.paperCompetitionSubaccountHint",HASH_SALT:"trading.hashSalt",ORDER_PRESETS_HINT:"trading.orderPresetsHint",ORDER_TICKET_SEND_BUTTON_HINT:"trading.orderTicketSendBtnHint"}},464896:(e,t,i)=>{"use strict";i.d(t,{TradingViewApi:()=>Dt});var r=i(650151),n=i(735566),s=(i(5368),
i(583912)),o=i(251954),a=i(213377),l=i(547465),c=i(257381),d=i(227158),h=i(333126),u=i(384364),_=i(136734),g=i(314802),p=i(139130),m=i(244097),f=i(678792);class v{constructor(e,t,i){this._replayUIController=e,this._chartWidgetsCollection=t,this._position=i?.position,this._realizedPL=i?.realizedPL,this._currency=i?.currency,this._replayAvailability=i?.availability,this._symbolInfo=i?.symbolInfo}destroy(){this._position?.release(),this._realizedPL?.release(),this._replayAvailability?.release(),this._currency?.release(),this._symbolInfo?.release()}isReplayToolbarVisible(){return this._replayUIController.isReplayModeEnabled()}showReplayToolbar(){const e=this._replayUIController;return e.showReplayToolbar?e.showReplayToolbar(!(0,g.isOnMobileAppPage)("any")&&void 0):e.enableReplayMode(!(0,g.isOnMobileAppPage)("any")&&void 0)}hideReplayToolbar(e){return this._replayUIController.requestCloseReplay(e)}isReplayAvailable(){return(0,r.ensureDefined)(this._replayAvailability)}isReadyToPlay(){return this._replayUIController.readyToPlay()}autoplayDelayList(){return f.autoplayDelayOptionItems}autoplayDelay(){return this._replayUIController.autoplayDelay().value()}autoplayDelayWV(){return this._replayUIController.autoplayDelay()}changeAutoplayDelay(e){this._replayUIController.changeAutoplayDelay(e)}isReplayStarted(){return this._replayUIController.isReplayStarted()}isAutoplayStarted(){return this._replayUIController.isAutoplayStarted()}toggleAutoplay(){this._replayUIController.toggleAutoplay()}replayMode(){return p.replayModeProperty}replayTimingMode(){return m.replayTimingModeProperty}isJumpToBarModeEnabled(){return this._replayUIController.isJumpToBarModeEnabled()}async toggleJumpToBarMode(){m.replayTimingModeProperty.setValue("manual"),this._replayUIController.isReplayModeEnabled().value()?this._replayUIController.toggleJumpToBarMode():await this._replayUIController.enableReplayMode(!0)}getReplayDepth(e){return this._replayUIController.getReplayDepth(e)}getReplaySelectedDate(){return this._replayUIController.replaySelectedDate()}async selectDate(e){m.replayTimingModeProperty.setValue("date"),this._replayUIController.isReplayModeEnabled().value()||await this._replayUIController.enableReplayMode(!1),await this._replayUIController.selectDate(this._chartWidgetsCollection.activeChartWidget.value(),1e3*Math.floor(e/1e3))}async selectRandomDate(){if(m.replayTimingModeProperty.setValue("random"),this._replayUIController.isReplayModeEnabled().value()||await this._replayUIController.enableReplayMode(!1),null===this._replayUIController.getReplayDepth().value())return new Promise(((e,t)=>{this._replayUIController.getReplayDepth().subscribe((i=>{null!==i?this._replayUIController.selectRandomDate(this._chartWidgetsCollection.activeChartWidget.value()).then(e):t(new Error("Error getting the available data depth"))}),{once:!0})}));await this._replayUIController.selectRandomDate(this._chartWidgetsCollection.activeChartWidget.value())}doStep(){return this._replayUIController.doStep()}goToRealtime(){this._replayUIController.goToRealtime()}
stopReplay(){return this._replayUIController.requestCloseReplay(!0)}buy(e){this._replayUIController.tradingUIController().activeModel()?.addOrder({side:1,type:2,qty:e})}sell(e){this._replayUIController.tradingUIController().activeModel()?.addOrder({side:-1,type:2,qty:e})}position(){return(0,r.ensureDefined)(this._position)}realizedPL(){return(0,r.ensureDefined)(this._realizedPL)}currency(){return(0,r.ensureDefined)(this._currency)}symbolInfo(){return(0,r.ensureDefined)(this._symbolInfo)}closePosition(){this._replayUIController.tradingUIController().activeModel()?.closePosition()}replayStrategyFacade(){return(0,r.ensureNotNull)(this._replayUIController.tradingUIController().activeModel()).replayStrategyFacade()}replayResolutions(){return this._replayUIController.replayResolutions()}currentReplayResolution(){return this._replayUIController.currentReplayResolution()}autoReplayResolution(){return this._replayUIController.autoReplayResolution()}autoReplayResolutionTitle(){return this._replayUIController.autoReplayResolutionTitle()}changeReplayResolution(e){this._replayUIController.changeReplayResolution(e)}currentDate(){return this._replayUIController.replayCurrentDate()}}var y=i(44049);class S{constructor(){this._openedScripts=new y.AsyncResourceWrapper(i.e(28129).then(i.bind(i,395866)))}destroy(){this._openedScripts.destroy()}addOpenedScript(e){this._openedScripts.callFunction((t=>{t.openedPineScripts.addScript(e)}))}removeOpenedScript(e){this._openedScripts.callFunction((t=>{t.openedPineScripts.removeScript(e)}))}openEditor(){(0,r.assert)(!1,"Not implemented yet")}openNewScript(){(0,r.assert)(!1,"Not implemented yet")}openScript(e){(0,r.assert)(!1,"Not implemented yet")}saveScript(e){(0,r.assert)(!1,"Not implemented yet")}addOrUpdateOnChart(){(0,r.assert)(!1,"Not implemented yet")}}var b=i(939926),w=i(125226),C=i(1554),T=i(147627),P=i(103669),A=i(719885),I=i(988534),L=i(316478),D=i(113610),x=i(290382),E=i(240482),W=i(345848),R=i(308721),M=i(909740),k=i(618856);class O{constructor(e){this._toolbarThemeChanged=new l.Delegate,this._onWatchedThemeChanged=e=>{this._toolbarThemeChanged.fire(e)},this._opts=e,M.watchedTheme.subscribe(this._onWatchedThemeChanged)}destroy(){M.watchedTheme.unsubscribe(this._onWatchedThemeChanged)}isStdTheme(){const e=this._opts.chartWidgetCollection.getAll().every((e=>null!==e.model().model().getThemeNameIfStdTheme()));return Promise.resolve(e)}async setStdTheme(e,t=!0,i){await(0,k.loadTheme)(this._opts.chartWidgetCollection,{themeName:e,standardTheme:!0,syncState:t,noUndo:i})}setStdThemeForLayout(e,t=!0){(0,M.setTheme)(e),t&&(0,R.syncTheme)()}getCurrentThemeName(){return(0,R.getCurrentTheme)().name}toolbarThemeChanged(){return this._toolbarThemeChanged}}var F=i(357938),N=i(87913),B=i(820028),V=i(312692),U=i(607683),H=i(192784),z=i(444372),j=i(418450),G=i(477786),$=i(498889),q=i(807780),Y=i(697034);class J{constructor(e){this._timeScale=e}coordinateToTime(e){const t=this._timeScale.coordinateToIndex(e);return this._timeScale.indexToTimePoint(t)}barSpacingChanged(){
return this._timeScale.barSpacingChanged()}rightOffsetChanged(){return this._timeScale.rightOffsetChanged()}setRightOffset(e){this._timeScale.setRightOffset(e)}setBarSpacing(e){this._timeScale.setBarSpacing(e)}barSpacing(){return this._timeScale.barSpacing()}rightOffset(){return this._timeScale.rightOffset()}width(){return this._timeScale.width()}defaultRightOffset(){return this._timeScale.defaultRightOffset().spawn()}defaultRightOffsetPercentage(){return this._timeScale.defaultRightOffsetPercentage().spawn()}usePercentageRightOffset(){return this._timeScale.usePercentageRightOffset().spawn()}isEmpty(){return this._timeScale.isEmpty()}scrollToFirstBar(e){this._timeScale.scrollToFirstBar(e)}scrollToRealtime(e){this._timeScale.scrollToRealtime(!1,e)}pointsCount(){return this._timeScale.points().size()}leftVisibleBarUTCTime(){const e=this._timeScale.visibleBarsStrictRange()?.firstBar()??null;return null===e?null:this._timeScale.indexToTimePoint(e)}}var X=i(986818);const Q=new j.TranslatedString("change timezone",z.t(null,void 0,i(920137)));class Z{constructor(e){this._onTimezoneChanged=new l.Delegate,this._chartWidget=e,this._timezoneProperty=e.properties().childs().timezone,this._timezoneProperty.subscribe(this,(e=>{this._onTimezoneChanged.fire(e.value())})),e.onAboutToBeDestroyed().subscribe(this,(()=>{this._timezoneProperty.unsubscribeAll(this)}),!0)}availableTimezones(){return X.availableTimezones}getTimezone(){const e=this._timezoneProperty.value();return(0,r.ensureDefined)(this.availableTimezones().find((t=>t.id===e)))}setTimezone(e,t){(0,r.assert)((0,X.timezoneIsAvailable)(e),`Incorrect timezone: ${e}`),t?.disableUndo?this._timezoneProperty.setValue(e):this._chartWidget.model().setProperty(this._timezoneProperty,e,Q)}onTimezoneChanged(){return this._onTimezoneChanged}}class K{constructor(e,t){this._chartUndoModel=e,this._chartModel=e.model(),this._priceScale=t}getMode(){const e=this._priceScale.properties().childs();return e.percentage.value()?2:e.indexedTo100.value()?3:e.log.value()?1:0}setMode(e){this._priceScale.setMode({percentage:2===e,log:1===e,indexedTo100:3===e})}isInverted(){return this._priceScale.isInverted()}setInverted(e){this._priceScale.properties().childs().isInverted.setValue(e)}isLocked(){return this._priceScale.isLockScale()}setLocked(e){this._priceScale.setMode({lockScale:e})}isAutoScale(){return this._priceScale.isAutoScale()}setAutoScale(e){this._priceScale.setMode({autoScale:e})}getVisiblePriceRange(){return this._priceScale.priceRangeInPrice()}setVisiblePriceRange(e){this._priceScale.setPriceRangeInPrice(e),this._chartModel.lightUpdate()}hasMainSeries(){return this._priceScale.hasMainSeries()}getStudies(){return this._priceScale.getStudies().map((e=>e.id()))}currency(){const e=this._chartModel.availableCurrencies(),t=this._priceScale.currency(e);return null===t?null:{readOnly:t.readOnly,selectedCurrency:t.selectedCurrency,originalCurrencies:Array.from(t.originalCurrencies),currencies:e.getItems().filter((e=>!t.baseCurrencies.has(e))),symbols:Array.from(t.symbols)}}setCurrency(e){
const t=this.currency()?.currencies;t&&e&&!t.includes(e)?console.warn("The provided currency is not supported by your datafeed!"):this._chartUndoModel.setPriceScaleCurrency(this._priceScale,e)}unit(){const e=this._chartModel.availableUnits(),t=this._priceScale.unit(e);return null===t?null:{readOnly:0===t.availableGroups.size,selectedUnit:t.selectedUnit,originalUnits:Array.from(t.originalUnits),availableGroups:Array.from(t.availableGroups),symbols:Array.from(t.symbols)}}setUnit(e){!e||this._chartModel.availableUnits().unitGroupById(e)?this._chartUndoModel.setPriceScaleUnit(this._priceScale,e):console.warn("The provided unit is not supported by your datafeed!")}coordinateToPrice(e){const t=this._priceScale.mainSource()?.firstValue();return null==t?null:this._priceScale.coordinateToPrice(e,t)}measureUnitId(){const e=this._priceScale.measureUnitId(this._chartModel.availableUnits());return null===e?null:{selectedMeasureUnitId:e.selectedMeasureUnitId}}}var ee=i(128090);function te(e){return{id:e.id(),name:(t=e.toolname,Object.keys(F.supportedLineTools).find((e=>F.supportedLineTools[e].name===t))||null)};var t}function ie(e){return{id:e.id(),name:e.metaInfo().description}}var re=i(536794),ne=i(422063);const se=new j.TranslatedString("change pane height",z.t(null,void 0,i(314691)));class oe extends ne.UndoCommand{constructor(e,t,i){super(se),this._model=e,this._paneIndex=t,this._paneHeight=i,this._prevStretchFactors=this._model.panes().map((e=>e.stretchFactor()))}redo(){this._model.changePanesHeight(this._paneIndex,this._paneHeight)}undo(){const e=this._model.panes();for(let t=0;t<e.length;++t)e[t].setStretchFactor((0,r.ensureDefined)(this._prevStretchFactors[t]));this._model.fullUpdate()}}class ae{constructor(e,t){this._priceScales=new WeakMap,this._pane=e,this._chartWidget=t}hasMainSeries(){return this._pane.containsMainSeries()}getLeftPriceScales(){return this._pane.leftPriceScales().map(this._getPriceScaleApi,this)}getRightPriceScales(){return this._pane.rightPriceScales().map(this._getPriceScaleApi,this)}getMainSourcePriceScale(){const e=this._pane.mainDataSource();if(null===e)return null;const t=e.priceScale();return null===t||this._pane.isOverlay(e)?null:this._getPriceScaleApi(t)}getPriceScaleById(e){const t=this._pane.getPriceScaleById(e);return null===t?null:this._getPriceScaleApi(t)}setMaximized(e){this._pane.maximized().value()!==e&&this._chartWidget.model().toggleMaximizedPane(this._pane)}isMaximized(){return this._pane.maximized().value()}legendLoaded(){const e=this._chartWidget.paneByState(this._pane);return Boolean(e&&e.statusWidget())}getAllEntities(){const e=this._pane.model();return this._pane.sourcesByGroup().allIncludingHidden().filter((e=>!e.isSpeciallyZOrderedSource())).map((t=>function(e,t){return t===e.mainSeries()?{id:e.mainSeries().id(),name:"Main Series"}:(0,ee.isStudy)(t)?ie(t):(0,U.isLineTool)(t)?te(t):null}(e,t))).filter(re.notNull).filter((e=>null!==e.name))}getHeight(){return this._pane.height()}setHeight(e){const t=this._chartWidget.model().model(),i=t.panes();(0,
r.assert)(i.length>1,"Unable to change pane's height if there is only one pane");const n=i.indexOf(this._pane);(0,r.assert)(-1!==n,"Invalid pane index");const s=new oe(t,n,e);this._chartWidget.model().undoHistory().pushUndoCommand(s)}moveTo(e){const t=this.paneIndex();t!==e&&((0,r.assert)(e>=0&&e<this._chartWidget.paneWidgets().length,"Invalid pane index"),this._chartWidget.model().movePane(t,e))}paneIndex(){return this._chartWidget.model().model().panes().indexOf(this._pane)}collapse(){if(1===this._chartWidget.model().panes().length)throw new Error("Cannot collapse a single pane!");if(this._pane.collapsed().value())throw new Error("Cannot collapse current pane!");this._chartWidget.model().toggleCollapsedPane(this._pane)}restore(){if(1===this._chartWidget.paneWidgets().length)throw new Error("Cannot restore a single pane!");if(!this._pane.collapsed().value())throw new Error("Cannot restore current pane!");this._chartWidget.model().toggleCollapsedPane(this._pane)}isCollapsed(){return this._pane.collapsed().value()}_getPriceScaleApi(e){let t=this._priceScales.get(e);return void 0===t&&(t=new K(this._chartWidget.model(),e),this._priceScales.set(e,t)),t}}var le=i(816433),ce=i(232543),de=i(44669),he=i(408610),ue=i(250026),_e=i(400331),ge=i(658089),pe=i(267353),me=i(454184),fe=i(912614);var ve=i(154834);var ye=i(311908),Se=i(405071);class be{constructor(e,t){this._onStudyCompleted=new l.Delegate,this._onStudyError=new l.Delegate,this._isStudyDestroyed=!1,this._study=e,this._chartWidget=t,this._undoModel=this._chartWidget.model(),this._model=this._undoModel.model(),this._study.onAboutToBeDestroyed().subscribe(this,(()=>{this._study.onStatusChanged().unsubscribeAll(this),this._study.onAboutToBeDestroyed().unsubscribeAll(this),this._isStudyDestroyed=!0})),this._study.onStatusChanged().subscribe(this,(e=>{switch(e.type){case me.StudyStatusType.Completed:this._onStudyCompleted.fire();break;case me.StudyStatusType.Error:this._onStudyError.fire()}}))}isUserEditEnabled(){return this._study.userEditEnabled()}setUserEditEnabled(e){this._study.setUserEditEnabled(e)}getInputsInfo(){return void 0===(e=this._study.metaInfo()).inputs?[]:e.inputs.map((e=>({...e,id:e.id,localizedName:void 0!==e.name?(0,fe.getTranslatedInputTitle)(e.name):""})));var e}getInputValues(){const e=this._study.inputs({symbolsForChartApi:!1,asObject:!0});return Object.keys(e).map((t=>{const i=e[t];return{id:t,value:(0,re.isObject)(i)?i.v:i}}))}getStyleInfo(){return function(e){const t={};if(e.defaults){const i=(0,ve.default)(e.defaults);t.defaults=i}return void 0!==e.plots&&(t.plots=(0,ve.default)(e.plots)),void 0!==e.styles&&(t.styles=(0,ve.default)(e.styles)),void 0!==e.bands&&(t.bands=(0,ve.default)(e.bands)),void 0!==e.filledAreas&&(t.filledAreas=(0,ve.default)(e.filledAreas)),void 0!==e.palettes&&(t.palettes=(0,ve.default)(e.palettes)),t}(this._study.metaInfo())}getStyleValues(){const{styles:e,bands:t,filledAreas:i,palettes:r,graphics:n,ohlcPlots:s,filledAreasStyle:o}=this._study.properties().state();return{styles:e,bands:t,filledAreas:i,palettes:r,
graphics:n,ohlcPlots:s,filledAreasStyle:o}}setInputValues(e){const t=this.getInputValues();for(const i of e){void 0!==t.find((e=>e.id===i.id))?this._study.properties().childs().inputs.childs()[i.id].setValue(i.value):console.warn(`There is no such input: "${i.id}"`)}}mergeUp(){this._model.isMergeUpAvailableForSource(this._study)&&new ue.MergeUpUndoCommand(this._model,this._study,null).redo()}mergeDown(){this._model.isMergeDownAvailableForSource(this._study)&&new ue.MergeDownUndoCommand(this._model,this._study,null).redo()}unmergeUp(){this._model.isUnmergeAvailableForSource(this._study)&&new he.UnmergeUpUndoCommand(this._model,this._study,null).redo()}unmergeDown(){this._model.isUnmergeAvailableForSource(this._study)&&new he.UnmergeDownUndoCommand(this._model,this._study,null).redo()}paneIndex(){return this._model.panes().indexOf(this._model.paneForSource(this._study))}onDataLoaded(){return this._onStudyCompleted}onStudyError(){return this._onStudyError}mergeUpWithUndo(){this._model.isMergeUpAvailableForSource(this._study)&&this._undoModel.mergeSourceUp(this._study)}mergeDownWithUndo(){this._model.isMergeDownAvailableForSource(this._study)&&this._undoModel.mergeSourceDown(this._study)}unmergeUpWithUndo(){this._model.isUnmergeAvailableForSource(this._study)&&this._undoModel.unmergeSourceUp(this._study)}unmergeDownWithUndo(){this._model.isUnmergeAvailableForSource(this._study)&&this._undoModel.unmergeSourceDown(this._study)}priceScale(){return new K(this._undoModel,(0,r.ensureNotNull)(this._study.priceScale()))}symbolSource(){const e=(0,r.ensureNotNull)(this._study.symbolSource());return{symbol:e.symbol(),currencyId:e.currency(),unitId:e.unit()}}currency(){return this._study.currency()}changePriceScale(e){const t=(0,r.ensureNotNull)(this._model.paneForSource(this._model.mainSeries())),i=(0,r.ensureNotNull)(this._model.paneForSource(this._study));switch(e){case"no-scale":(0,r.assert)(i.actionNoScaleIsEnabled(this._study),"Unable to leave a pane without any non-overlay price scale"),new _e.MoveToNewPriceScaleUndoCommand(this._model,this._study,i,"overlay",null).redo();break;case"as-series":(0,r.assert)(i===t,"Study should be on the main pane"),new _e.MoveToExistingPriceScaleUndoCommand(this._model,this._study,i,this._model.mainSeries().priceScale(),null).redo();break;case"new-left":new _e.MoveToNewPriceScaleUndoCommand(this._model,this._study,i,"left",null).redo();break;case"new-right":new _e.MoveToNewPriceScaleUndoCommand(this._model,this._study,i,"right",null).redo();break;default:const n=this._model.dataSourceForId(e);if(null===n)throw new Error(`There is no study with entityId='${e}'`);const s=i===this._model.paneForSource(n);(0,r.assert)(s,"Both studies should be on the same pane");const o=(0,r.ensureNotNull)(n.priceScale()),a=(0,de.sourceNewCurrencyOnPinningToPriceScale)(this._study,o,this._model),l=(0,ge.sourceNewUnitOnPinningToPriceScale)(this._study,o,this._model);new _e.MoveToExistingPriceScaleUndoCommand(this._model,this._study,i,o,null).redo(),
null!==a&&new ce.SetPriceScaleCurrencyUndoCommand(this._model,o,a,null).redo(),null!==l&&new pe.SetPriceScaleUnitUndoCommand(this._model,o,l,null).redo()}}isVisible(){return this._study.properties().childs().visible.value()}setVisible(e){this._study.properties().childs().visible.setValue(e)}bringToFront(){this._model.bringToFront([this._study])}sendToBack(){this._model.sendToBack([this._study])}applyOverrides(e){(0,$.applyOverridesToStudy)(this._study,e)}hasPlots(){return this._study.metaInfo().plots.length>0}dataLength(){return this._study.status().type!==me.StudyStatusType.Completed?0:this._study.metaInfo().plots.length>0?this._study.data().size():this._model.mainSeries().bars().size()}isLoading(){const e=this._study.status();return e.type===me.StudyStatusType.Undefined||e.type===me.StudyStatusType.Loading}hasError(){return this._study.status().type===me.StudyStatusType.Error}hasPendingUnresolvedSymbols(){return this._study.hasPendingUnresolvedSymbols()}anyGraphicsReady(){return!(0,ye.isStudyGraphicsEmpty)(this._study.graphics())}graphicsViewsReady(){return this._study.graphicsViewsReady()}properties(){return this._study.properties()}setProperties(e){this._study.properties().mergeAndFire(e)}async applyToEntireLayout(){const{ActionsProvider:e}=await(0,Se.actionsProviderModule)();if(this._isStudyDestroyed)return;const t=new e(this._chartWidget),i=(await t.contextMenuActionsForSources([this._study],(0,r.ensureNotNull)(this._chartWidget.model().paneForSource(this._study)))).find((e=>"applyStudyToEntireLayout"===e.id));i&&i.execute()}status(){return{...this._study.status()}}title(){return this._study.title(le.TitleDisplayTarget.StatusLine)}symbolsResolved(){return this._study.symbolsResolved()}study(){return this._study}}const we=new Map([["LineToolBezierQuadro",3],["LineToolBezierCubic",4]]);function Ce(e){const t=we.get(e.toolname);if(void 0!==t)return t;const i=e.pointsCount();return-1===i?e.points().length:i}function Te(e){return"LineToolRiskRewardLong"===e||"LineToolRiskRewardShort"===e}const Pe=["alwaysShowStats","entryPrice","inputs.first bar time","inputs.last bar time","interval","linesWidths","points","snapTo45Degrees","stopPrice","symbol","symbolStateVersion","currencyId","unitId","targetPrice","zOrderVersion"];class Ae{constructor(e,t,i){this._source=e,this._undoModel=t,this._model=t.model(),this._pointsConverter=i}isSelectionEnabled(){return this._source.isSelectionEnabled()}setSelectionEnabled(e){this._source.setSelectionEnabled(e)}isSavingEnabled(){return this._source.isSavedInChart()}setSavingEnabled(e){this._source.setSavingInChartEnabled(e)}isShowInObjectsTreeEnabled(){return this._source.showInObjectTree()}setShowInObjectsTreeEnabled(e){this._source.setShowInObjectsTreeEnabled(e)}isUserEditEnabled(){return this._source.userEditEnabled()}setUserEditEnabled(e){this._source.setUserEditEnabled(e)}bringToFront(){this._model.bringToFront([this._source])}sendToBack(){this._model.sendToBack([this._source])}getProperties(){return this._source.properties().state(Pe)}setProperties(e,t){(0,
V.allowSavingDefaults)(!!t),this._source.properties().mergeAndFire(e),(0,V.allowSavingDefaults)(!1)}getPoints(){let e=this._source.points();const t=Ce(this._source);return e.length>t&&((0,r.assert)(Te(this._source.toolname)),e=e.slice(0,t)),this._pointsConverter.dataSourcePointsToPriced(e)}setPoints(e){if(this._source.isFixed())return;const t=Ce(this._source);if(t!==e.length)throw new Error(`Wrong points count. Required: ${t}, provided: ${e.length}`);const i=this._pointsConverter.apiPointsToDataSource(e);this._model.startChangingLinetool(this._source),this._model.changeLinePoints(this._source,i),this._model.endChangingLinetool(!0),this._source.createServerPoints()}getAnchoredPosition(){return this._source.positionPercents()}setAnchoredPosition(e){const t=this._source.fixedPoint(),i=this._source.linkKey().value(),r=void 0===t?null:this._source.screenPointToPoint(t);if(!this._source.isFixed()||void 0===t||null===i||null===r)return;const n={logical:r,screen:t},s=new Map;s.set(i,e),this._model.startMovingSources([this._source],n,null,new Map),this._model.moveSources(n,s),this._model.endMovingSources(!0)}ownerSourceId(){return(0,r.ensureNotNull)(this._source.ownerSource()).id()}changePoint(e,t){if(this._source.isFixed())return;const i=this._pointsConverter.apiPointsToDataSource([e])[0];this._model.startChangingLinetool(this._source,{...i},t),this._model.changeLinePoint({...i}),this._model.endChangingLinetool(!1),this._source.createServerPoints()}isHidden(){return this._source.isSourceHidden()}getRawPoints(){return this._source.points()}getNormalizedPoints(){return this._source.normalizedPoints()}setRawPoint(e,t){this._model.startChangingLinetool(this._source,{...t},e),this._model.changeLinePoint({...t}),this._model.endChangingLinetool(!1)}move(e,t){this._model.startMovingSources([this._source],{logical:e,screen:(0,r.ensureNotNull)(this._source.pointToScreenPoint(e))},null,new Map),this._model.moveSources({logical:t,screen:(0,r.ensureNotNull)(this._source.pointToScreenPoint(t))},new Map),this._model.endMovingSources(!1)}dataAndViewsReady(){return this._source.dataAndViewsReady()}zorder(){return this._source.zorder()}symbol(){return this._source.properties().symbol.value()}currency(){return this._source.properties().currencyId.value()}unit(){return this._source.properties().unitId.value()}share(e){this._undoModel.shareLineTools([this._source],e)}setVisible(e,t=!1){this._undoModel.setProperty(this._source.properties().visible,e,null,t)}sharingMode(){return this._source.sharingMode().value()}lineDataSource(){return this._source}template(){return this._source.template()}}class Ie{constructor(e,t){this._series=e,this._undoModel=t,this._model=t.model()}isUserEditEnabled(){return this._series.userEditEnabled()}setUserEditEnabled(e){this._series.setUserEditEnabled(e)}mergeUp(){this._model.isMergeUpAvailableForSource(this._series)&&new ue.MergeUpUndoCommand(this._model,this._series,null).redo()}mergeDown(){this._model.isMergeDownAvailableForSource(this._series)&&new ue.MergeDownUndoCommand(this._model,this._series,null).redo()}
unmergeUp(){this._model.isUnmergeAvailableForSource(this._series)&&new he.UnmergeUpUndoCommand(this._model,this._series,null).redo()}unmergeDown(){this._model.isUnmergeAvailableForSource(this._series)&&new he.UnmergeDownUndoCommand(this._model,this._series,null).redo()}mergeUpWithUndo(){this._model.isMergeUpAvailableForSource(this._series)&&this._undoModel.mergeSourceUp(this._series)}mergeDownWithUndo(){this._model.isMergeDownAvailableForSource(this._series)&&this._undoModel.mergeSourceDown(this._series)}unmergeUpWithUndo(){this._model.isUnmergeAvailableForSource(this._series)&&this._undoModel.unmergeSourceUp(this._series)}unmergeDownWithUndo(){this._model.isUnmergeAvailableForSource(this._series)&&this._undoModel.unmergeSourceDown(this._series)}detachToRight(){new _e.MoveToNewPriceScaleUndoCommand(this._model,this._series,this._pane(),"right",null).redo()}detachToLeft(){new _e.MoveToNewPriceScaleUndoCommand(this._model,this._series,this._pane(),"left",null).redo()}detachNoScale(){new _e.MoveToNewPriceScaleUndoCommand(this._model,this._series,this._pane(),"overlay",null).redo()}changePriceScale(e){const t=(0,r.ensureNotNull)(this._model.paneForSource(this._series));switch(e){case"new-left":new _e.MoveToNewPriceScaleUndoCommand(this._model,this._series,t,"left",null).redo();break;case"new-right":new _e.MoveToNewPriceScaleUndoCommand(this._model,this._series,t,"right",null).redo();break;case"no-scale":(0,r.assert)(t.actionNoScaleIsEnabled(this._series),"Unable to leave a pane without any non-overlay price scale"),new _e.MoveToNewPriceScaleUndoCommand(this._model,this._series,t,"overlay",null).redo();break;default:const i=this._model.dataSourceForId(e);if(null===i)throw new Error(`There is no study with entityId='${e}'`);const n=this._model.paneForSource(i)===t;(0,r.assert)(n,"Study should be on the main pane");const s=(0,r.ensureNotNull)(i.priceScale());new _e.MoveToExistingPriceScaleUndoCommand(this._model,this._series,t,s,null).redo()}}isVisible(){return this._series.properties().childs().visible.value()}setVisible(e){this._series.properties().childs().visible.setValue(e)}bringToFront(){this._model.bringToFront([this._series])}sendToBack(){this._model.sendToBack([this._series])}entityId(){return this._series.id()}chartStyleProperties(e,t){return t?this._series.properties().childs()[Le(e)].state():this._series.properties().childs()[Le(e)].state(["inputs","inputsInfo"])}setChartStyleProperties(e,t){this._series.properties().childs()[Le(e)].mergeAndFire(t)}barsCount(){return this._series.bars().size()}endOfData(){return this._series.endOfData()}symbolSource(){return{symbol:this._series.symbol(),currencyId:this._series.currency(),unitId:this._series.unit()}}isLoading(){return this._series.isLoading()}isInReplay(){return this._series.isInReplay()}data(){return this._series.data()}priceScale(){return new K(this._undoModel,this._series.priceScale())}seriesErrorMessage(){return this._series.seriesErrorMessage()}compositeStatusVW(){return this._series.compositeStatusVW()}properties(){return this._series.properties()}
lastConfirmedBarUTCTime(){return this._series.bars().last()?.value[0]??null}_pane(){return(0,r.ensureNotNull)(this._model.paneForSource(this._series))}}function Le(e){switch(e){case 0:return"barStyle";case 1:return"candleStyle";case 2:return"lineStyle";case 14:return"lineWithMarkersStyle";case 15:return"steplineStyle";case 3:return"areaStyle";case 16:return"hlcAreaStyle";case 4:return"renkoStyle";case 5:return"kagiStyle";case 6:return"pnfStyle";case 7:return"pbStyle";case 8:return"haStyle";case 9:return"hollowCandleStyle";case 10:return"baselineStyle";case 11:return"rangeStyle";case 12:return"hiloStyle";case 13:return"columnStyle";case 17:return"volFootprintStyle";case 18:return"tpoStyle";case 19:return"volCandlesStyle";case 20:return"svpStyle";case 21:return"hlcBarsStyle";default:(0,r.ensureNever)(e)}throw new Error(`unsupported chart style: ${e}`)}var De=i(100148),xe=i(755859);class Ee{constructor(e){this._drawer=null,this._context=e,this._rangeBindings=new xe.RangeBinding(e)}drawer(){return Promise.all([i.e(52170),i.e(92537),i.e(98185),i.e(98933),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(65743),i.e(61171),i.e(67780),i.e(43329),i.e(66032),i.e(97540),i.e(25563),i.e(72232),i.e(61667),i.e(50626),i.e(32841),i.e(44059),i.e(79487),i.e(81104),i.e(3361),i.e(47624),i.e(29019),i.e(39440),i.e(32227),i.e(90223),i.e(95518),i.e(26655),i.e(8866)]).then(i.bind(i,976648)).then((e=>(null===this._drawer&&(this._drawer=new e.DateRangeDrawerApi(this._context)),this._drawer)))}state(){return this._rangeBindings.state()}onChange(){return this._rangeBindings.onChange()}selectRange(e){this._rangeBindings.selectRange(e)}goToTime(e){const t=this._context.chartWidget.model().model();t.gotoTime(e).then((e=>{const i=t.mainSeries();void 0===e?i.clearGotoDateResult():i.setGotoDateResult(e)}))}}var We=i(508914);class Re{constructor(e){this._chartWidget=e}latestUpdatesLollipop(){const e=this._chartWidget.model().model(),t=e.dataSourceForId("latestUpdates");return t?{clickAtLollipop:()=>{const i=(0,r.ensureNotNull)(e.paneForSource(t)),n=(0,r.ensureNotNull)(this._chartWidget.paneByState(i)),s=n.getRenderingInfo(),o=n.canvasElement();t.clickAtLollipop(s,o,"0")}}:null}}var Me=i(87347),ke=i(415992),Oe=i(854004);function Fe(e,t){const{symbolChanged:i,currencyChanged:r,unitChanged:n,styleChangeRequiresRestart:s}=e.compareSymbolParams(t);return!(i||r||n||s)}function Ne(e,t){e.isLoading()&&!e.isFailed()||t(e.isFailed());const i=e.seriesSource().symbolInstanceId(),r=e.dataEvents(),n=e.symbolParams(),s=()=>{r.completed().unsubscribe(null,o),(Fe(e,n)||e.seriesSource().symbolInstanceId()===i)&&t(!1)},o=()=>{r.error().unsubscribe(null,s),(Fe(e,n)||e.seriesSource().symbolInstanceId()===i)&&t(!0)};r.completed().subscribe(null,s,!0),r.error().subscribe(null,o,!0)}var Be=i(659923),Ve=i(807958),Ue=i(651231),He=i(482707),ze=i(470416),je=(i(437642),i(776734)),Ge=i(113885),$e=i(839800);class qe{constructor(e,t){this._controller=e,this._model=t}createGroupFromSelection(){
return this._controller.createGroupFromSelection().id}removeGroup(e){const t=(0,r.ensureDefined)(this._groupById(e));this._controller.removeGroup(t)}groups(){return this._controller.groups().map((e=>e.id))}shapesInGroup(e){const t=(0,r.ensureDefined)(this._groupById(e));return(0,$e.sortSources)(t.lineTools()).map((e=>e.id()))}excludeShapeFromGroup(e,t){const i=(0,r.ensureDefined)(this._groupById(e)),n=(0,r.ensureNotNull)(this._model.dataSourceForId(t));(0,r.assert)((0,U.isLineTool)(n),"Passed shapeId is not a line tool"),this._controller.excludeLineToolFromGroup(i,n)}addShapeToGroup(e,t){const i=(0,r.ensureDefined)(this._groupById(e)),n=(0,r.ensureNotNull)(this._model.dataSourceForId(t));(0,r.assert)((0,U.isLineTool)(n),"Passed shapeId is not a line tool"),this._controller.addLineToolToGroup(i,n)}availableZOrderOperations(e){const t=(0,r.ensureDefined)(this._groupById(e));return this._controller.availableZOrderOperations(t)}bringToFront(e){const t=(0,r.ensureDefined)(this._groupById(e));this._controller.bringToFront(t)}bringForward(e){const t=(0,r.ensureDefined)(this._groupById(e));this._controller.bringForward(t)}sendBackward(e){const t=(0,r.ensureDefined)(this._groupById(e));this._controller.sendBackward(t)}sendToBack(e){const t=(0,r.ensureDefined)(this._groupById(e));this._controller.sendToBack(t)}insertAfter(e,t){const i=(0,r.ensureDefined)(this._groupById(e)),n=(0,r.ensureNotNull)(this._groupById(t)||this._model.dataSourceForId(t));this._controller.insertAfter(i,n)}insertBefore(e,t){const i=(0,r.ensureDefined)(this._groupById(e)),n=(0,r.ensureNotNull)(this._groupById(t)||this._model.dataSourceForId(t));this._controller.insertBefore(i,n)}groupVisibility(e){return(0,r.ensureDefined)(this._groupById(e)).visibility()}setGroupVisibility(e,t){const i=(0,r.ensureDefined)(this._groupById(e));this._controller.setGroupVisibility(i,t)}groupLock(e){return(0,r.ensureDefined)(this._groupById(e)).locked()}setGroupLock(e,t){const i=(0,r.ensureDefined)(this._groupById(e));this._controller.setGroupLock(i,t)}getGroupName(e){return(0,r.ensureDefined)(this._groupById(e)).name().value()}setGroupName(e,t){const i=(0,r.ensureDefined)(this._groupById(e));this._controller.setGroupName(i,t)}canBeGroupped(e){const t=e.map((e=>(0,r.ensureNotNull)(this._model.dataSourceForId(e))));return!t.some((e=>!(0,U.isLineTool)(e)))&&this._controller.canBeGroupped(t)}_groupById(e){return this._controller.groups().find((t=>t.id===e))}}var Ye=i(529751),Je=i(841355),Xe=i(507778),Qe=i(378435),Ze=i(181227),Ke=i(320257);const et=new j.TranslatedString("change price to bar ratio",z.t(null,void 0,i(702509))),tt=new j.TranslatedString("toggle lock scale",z.t(null,void 0,i(949695)));function it(e,t){return t.map((t=>(0,r.ensureNotNull)(e.dataSourceForId(t))))}class rt{constructor(e,t){this._visibleBarsChanged=new l.Delegate,this._crosshairMoved=new l.Delegate,this._dataSourceHovered=new l.Delegate,this._ranges=null,this._panes=new WeakMap,this._studies=new WeakMap,this._lineDataSources=new WeakMap,this._selectionApi=null,this._lollipopSourcesApi=null,
this._prevVisibleRange=null,this._prevHoveredSourceId=null,this._chartWidget=e,this._activateChart=t,this._timezoneApi=new Z(e),this._chartWidget.withModel(this,(()=>{this._chartWidget.model().crosshairSource().moved().subscribe(this,this._onCrosshairMoved),this._chartWidget.model().model().hoveredSourceChanged().subscribe(this,this._onHoveredSourceChanged),this._chartWidget.model().timeScale().logicalRangeChanged().subscribe(this,this._onLogicalRangeChanged)})),this._widgetLinkingGroupIndex=e.linkingGroupIndex().spawn(),this._widgetLinkingGroupIndex.subscribe((e=>this._apiLinkingGroupIndex.setValue(e))),this._apiLinkingGroupIndex=new B.WatchedValue(this._widgetLinkingGroupIndex.value()),this._apiLinkingGroupIndex.subscribe((e=>{this._widgetLinkingGroupIndex.value()!==e&&(this._chartWidget.hasModel()?this._chartWidget.model().setLinkingGroupIndex(e):this._widgetLinkingGroupIndex.setValue(e))})),this._chartWidget.onAboutToBeDestroyed().subscribe(this,this._destroy,!0)}setActive(){this._activateChart()}getPriceToBarRatio(){return this._chartWidget.model().model().mainSeriesScaleRatioProperty().value()}setPriceToBarRatio(e,t){const i=this._chartWidget.model(),r=i.model(),n=r.mainSeriesScaleRatioProperty();t?.disableUndo?new Oe.SetScaleRatioPropertiesCommand(n,e,null,r).redo():i.setScaleRatioProperty(n,e,et)}isPriceToBarRatioLocked(){return this._chartWidget.model().model().mainSeries().priceScale().isLockScale()}setPriceToBarRatioLocked(e,t){const i=this._chartWidget.model(),r=i.model(),n=r.mainSeries().priceScale();t?.disableUndo?new ke.SetPriceScaleModeCommand({lockScale:e},n,null,r).redo():i.setPriceScaleMode({lockScale:e},n,tt)}id(){return this._chartWidget.id()}onDataLoaded(){return this._makeSubscriptionFromDelegate(this._chartWidget.model().mainSeries().dataEvents().completed())}onSymbolChanged(){return this._makeSubscriptionFromDelegate(this._chartWidget.model().mainSeries().dataEvents().symbolResolved())}onIntervalChanged(){return this._makeSubscriptionFromDelegate(this._chartWidget.model().mainSeries().onIntervalChanged())}onVisibleRangeChanged(){return this._makeSubscriptionFromDelegate(this._visibleBarsChanged)}onChartTypeChanged(){const e=this._chartWidget.model().mainSeries().onStyleChanged();return this._makeSubscriptionFromDelegate(e)}onSeriesTimeframe(){return this._makeSubscriptionFromDelegate(this._chartWidget.model().mainSeries().dataEvents().seriesTimeFrame())}onSeriesError(){return this._makeSubscriptionFromDelegate(this._chartWidget.model().mainSeries().dataEvents().seriesError())}dataReady(e){const t=!this._chartWidget.hasModel()||!this._chartWidget.model().mainSeries()||this._chartWidget.model().mainSeries().data().isEmpty();return e&&(t?this.onDataLoaded().subscribe(null,e,!0):e()),!t}whenChartReady(e){this._chartWidget.withModel(this,e)}crossHairMoved(){return this._makeSubscriptionFromDelegate(this._crosshairMoved)}onHoveredSourceChanged(){return this._makeSubscriptionFromDelegate(this._dataSourceHovered)}setVisibleRange(e,t){throw new Error("Not implemented")}async setSymbol(e,t){(0,
re.isFunction)(t)&&(t={dataReady:t});const{dataReady:i,doNotActivateChart:r}=t||{};if(e===this.symbol()||this._chartWidget.hasModel()&&this._chartWidget.model().mainSeries().symbolSameAsResolved(e))return i?.(),!0;r||this._activateChart();const n=await this._chartWidget.chartWidgetCollection().setSymbol(e,void 0,this._chartWidget);return n&&Ne(this._chartWidget.model().mainSeries(),(e=>{!e&&i&&i()})),n}async setResolution(e,t){(0,re.isFunction)(t)&&(t={dataReady:t});const{dataReady:i,doNotActivateChart:r}=t||{},n=G.Interval.normalize(e);if(null===n||n===this.resolution())return i?.(),!0;r||this._activateChart();const s=await this._chartWidget.chartWidgetCollection().setResolution(n,void 0,this._chartWidget);return s&&Ne(this._chartWidget.model().mainSeries(),(e=>{!e&&i&&i()})),s}async setChartType(e,t){if(this._chartWidget.model().mainSeries().properties().childs().style.value()===e)return t?.(),!0;const i=this._chartWidget.chartWidgetCollection().setChartStyleToWidget(e,this._chartWidget);return Ne(this._chartWidget.model().mainSeries(),(e=>{!e&&t&&t()})),i}resetData(){this._chartWidget.model().mainSeries().rerequestData()}executeActionById(e){this._chartWidget.executeActionById(e)}getCheckableActionState(e){return this._chartWidget.getCheckableActionState(e)}refreshMarks(){this._chartWidget.refreshMarks()}clearMarks(e){this._chartWidget.clearMarks(e)}getBarsMarksSources(){return this._chartWidget.model().barsMarksSources()}getAllShapes(){return this._chartWidget.model().model().allLineTools().map(te).filter((e=>null!==e.name))}getAllStudies(){return this._chartWidget.model().model().allStudies(!0).map(ie)}getStudyTemplateSnapshot(e,t,i){return(0,Qe.getStudyTemplateSaveData)(e,this._chartWidget.model().model(),t,i)}getStudyTemplateDescString(){const e=(0,Qe.getStudyTemplateMetaInfo)(this._chartWidget.model().model());return(0,Qe.getStudyTemplateDescString)(e.indicators)}async applyStudyTemplateByRecord(e){if(!e)return;const{name:t,id:i,is_default:r}=e,n=e=>this._chartWidget.model().applyStudyTemplate(JSON.parse(e.content),t);r?await Xe.backend.getStandardStudyTemplateById(i,n):await Xe.backend.getStudyTemplateById(i).then(n)}chartTemplate(){return this._chartWidget.model().model().template()}applyChartTempalte(e){this._chartWidget.chartWidgetCollection().applyTheme(e)}getAllPanesHeight(){const e=this._chartWidget.model().model().panes();if(this._chartWidget.hasMaximizedPane()){let t=0,i=0;e.forEach((e=>{t+=e.height(),i+=e.stretchFactor()}));const r=i/t;return e.map((e=>Math.round(e.stretchFactor()/r*100)/100))}return e.map((e=>e.height()))}setAllPanesHeight(e){const t=this._chartWidget.model().model(),i=t.panes();(0,r.assert)(i.length===e.length,"There`s a mismatch between the number of heights you provided and the number of panes.");const n=i.reduce(((e,t)=>e+t.stretchFactor()),0)/e.reduce(((e,t)=>e+t));e.forEach(((e,t)=>{const r=e*n;i[t].setStretchFactor(r)})),t.fullUpdate()}maximizeChart(){this._chartWidget.requestFullscreen()}isMaximized(){return this._chartWidget.inFullscreen()}restoreChart(){
this._chartWidget.exitFullscreen()}restoreChartPreferences(){this._chartWidget.model().restorePreferences()}availableZOrderOperations(e){const t=it(this._chartWidget.model().model(),e);return this._chartWidget.model().availableZOrderOperations(t)}sendToBack(e){const t=it(this._chartWidget.model().model(),e);this._chartWidget.model().sendToBack(t)}bringToFront(e){const t=it(this._chartWidget.model().model(),e);this._chartWidget.model().bringToFront(t)}bringForward(e){const t=it(this._chartWidget.model().model(),e);this._chartWidget.model().bringForward(t)}sendBackward(e){const t=it(this._chartWidget.model().model(),e);this._chartWidget.model().sendBackward(t)}insertAfter(e,t){const i=this._chartWidget.model().model(),n=it(i,e),s=(0,r.ensureNotNull)(i.dataSourceForId(t));this._chartWidget.model().insertAfter(n,s)}insertBefore(e,t){const i=this._chartWidget.model().model(),n=it(i,e),s=(0,r.ensureNotNull)(i.dataSourceForId(t));this._chartWidget.model().insertBefore(n,s)}sessions(){return this._chartWidget.model().model().sessions()?.get()??null}chartModel(){return this._chartWidget.model().model()}chartUndoModel(){return this._chartWidget.model()}chartWidget(){return this._chartWidget}getTimeScaleLogicalRange(){return this._chartWidget.model().timeScale().logicalRange()}setEntityVisibility(e,t){console.warn("`setEntityVisibility` is deprecated. Use shape/study API instead");const i=this._chartWidget.model().model().dataSourceForId(e);if(!i)return;const r=i.properties();r&&r.visible&&r.visible.setValue(t)}async createStudy(e,t,i,r,n,s){if("function"==typeof n)return console.warn('"createStudy" does not take "callback" parameter anymore'),Promise.resolve(null);if(s=s||{},"string"!=typeof e)return this._createStudy(e);e=e.toLowerCase();const o=await(0,Me.studyMetaInfoRepository)().findAllJavaStudies(),a=Ve.StudyMetaInfo.findStudyMetaInfoByDescription(o,e);if(s.checkLimit){const e=this._chartWidget.model().canCreateStudy({id:a.id});if(!e.success)return(0,Be.showTooManyStudiesNotice)(e.limitValue),Promise.resolve(null)}const l=(s.disableUndo?this._chartWidget.model().model():this._chartWidget.model()).createStudyInserter({type:"java",studyId:a.id},[]);if(l.setForceOverlay(!!t),s.priceScale&&l.setPreferredPriceScale(function(e){switch(e){case"no-scale":return"overlay";case"as-series":return"as-series";case"new-left":return"left";case"new-right":return"right";default:throw new Error(`The pricescale "${e}" is invalid, the only valid options are "no-scale", "as-series", "new-left" and "new-right".`)}}(s.priceScale)),s.allowChangeCurrency&&l.setAllowChangeCurrency(!0),s.allowChangeUnit&&l.setAllowChangeUnit(!0),Array.isArray(r)){console.warn("Passing study inputs as an ordered array is now deprecated. Please use an object where keys correspond to the inputs of your study instead.");const e={};for(let t=0;t<a.inputs.length;++t)e[a.inputs[t].id]=r[t];r=e}return l.insert((()=>Promise.resolve({inputs:r||{},parentSources:[]}))).then((e=>(n&&(0,$.applyOverridesToStudy)(e,n),i&&e.setUserEditEnabled(!1),e.id())))}waitForStudyCreated(e){
return this._chartWidget.model().model().waitForStudy(e)}compileFailedStudies(){return this._chartWidget.model().model().studiesWV().value().filter((e=>e.isPine()&&e.hasCompileError()))}getStudyById(e){const t=this._chartWidget.model().model().getStudyById(e);if(null===t)throw new Error("There is no such study");return this._getStudyApi(t)}getSeries(){const e=this._chartWidget.model(),t=e.mainSeries();return new Ie(t,e)}createShape(e,t){return this.createMultipointShape([e],t)}async createMultipointShape(e,t){const i=()=>new Error(`Cannot create "${n.shape}" shape`),n=Object.assign({},{filled:!0},t),s=F.supportedLineTools[n.shape]||F.supportedLineTools.flag;(0,W.trackEvent)("API","CreateDrawing",s.name),(0,je.getTracker)().then((e=>{null!==e&&e.trackChartApiDrawingCreation(s.name)}));const o=this._chartWidget.model().model(),a=o.mainSeries();if(o.timeScale().isEmpty())throw i();const l=void 0!==n.ownerStudyId?o.dataSourceForId(n.ownerStudyId)??a:a,c=o.paneForSource(l),d=this._convertUserPointsToDataSource(e);if(null===d||null===c)throw i();if(s.onlySelectable)throw new Error(`Cannot create "${n.shape}" shape`);if("LineToolIcon"===s.name){const e=n;if(e.icon=e.icon||e.overrides&&e.overrides.icon,!n.hasOwnProperty("icon"))throw new Error("icon must be specified in options");e.overrides=e.overrides||{},e.overrides.icon=e.icon}await(0,Ze.ensureLineToolLoaded)(s.name);const h=(0,U.createLineToolProperties)(o.backgroundTheme().spawnOwnership(),s.name,!o.readOnly());if((0,U.prepareLineToolPropertiesByOwnerSource)(h,l),n.overrides)for(const e in n.overrides)h.hasChild(e)?(0,r.ensureDefined)(h.child(e)).mergeAndFire(n.overrides[e]):Te(s.name)&&-1!==["profitLevel","stopLevel"].indexOf(e)&&h.addProperty(e,n.overrides[e]);let u;void 0!==h.hasChild("text")&&n.text&&(0,r.ensureDefined)(h.child("text")).setValue(n.text),h.hasChild("filled")&&n.filled&&(0,r.ensureDefined)(h.child("filled")).setValue(!0),u=n.disableUndo?this._chartWidget.model().model():this._chartWidget.model(),n.template&&this.chartModel().undoModel().applyLineToolsTemplate({properties:h,data:n.template});const _=u.createLineTool({pane:c,point:d[0],linetool:s.name,properties:h,ownerSource:l,actionSource:"API"});if(null===_)throw h.destroy(),i();if(_.properties()!==h&&h.destroy(),Te(s.name)){if(d.length>2)throw new Error(`Wrong points count for ${n.shape}. Required 1 or 2`);2===d.length&&(_.startChanging(1,d[1]),_.setPoint(1,d[1]),_.endChanging(!0,!1))}else{const e=_.pointsCount();if(e!==d.length&&-1!==e)throw new Error(`Wrong points count for ${n.shape}. Required ${e}`);const t=new Je.EnvironmentState(void 0,!0),i=(0,Ye.isLineDrawnWithPressedButton)(s.name);for(let e=1;e<d.length&&this._chartWidget.model().lineBeingCreated();e++)_.setLastPoint(d[e]),u.continueCreatingLine(d[e],t,e<d.length-1||i);(0,Ye.isLineToolFinishRequiredWhenCreatedByApi)(s.name)&&(_.finish(),u.finishLineTool(_),u.continueCreatingLine(d[d.length-1],t,!1))}if(n.lock&&_.setUserEditEnabled(!1),n.disableSelection&&_.setSelectionEnabled(!1),
n.disableSave&&(void 0===_.customization&&(_.customization={}),_.customization.disableSave=!0),n.hasOwnProperty("showInObjectsTree")&&(void 0===_.customization&&(_.customization={}),_.customization.showInObjectsTree=n.showInObjectsTree),n.zOrder){const e=this._chartWidget.model().availableZOrderOperations([_]);"top"===n.zOrder&&e.bringToFrontEnabled?u.bringToFront([_]):"bottom"===n.zOrder&&e.sendToBackEnabled&&u.sendToBack([_])}return _.id()}getShapeById(e){const t=this._chartWidget.model().model().getLineToolById(e);if(null===t)throw new Error("There is no such shape");return this._getLineDataSourceApi(t)}removeEntity(e,t){const i=this._chartWidget.model().model().dataSourceForId(e);i?t&&t.disableUndo?new Ge.RemoveSourcesUndoCommand(this._chartWidget.model().model(),[i],null).redo():this._chartWidget.model().removeSource(i,!0,!0):console.warn(`Can't find a source with id: ${e}`)}removeEntityWithUndo(e){const t=this._chartWidget.model().model().dataSourceForId(e);t&&this._chartWidget.model().removeSource(t,!1)}removeAllShapes(){this._chartWidget.removeAllDrawingTools()}removeAllStudies(){this._chartWidget.removeAllStudies()}selection(){return null===this._selectionApi&&(this._selectionApi=new De.SelectionApi(this._chartWidget.model().model())),this._selectionApi}showPropertiesDialog(e){const t=this._chartWidget.model().model().dataSourceForId(e);if(null===t)throw new Error(`Study or shape ${e} does not exist`);this._chartWidget.showChartPropertiesForSource(t)}createStudyTemplate(e){return this._chartWidget.model().model().studyTemplate(e.saveSymbol,e.saveInterval)}applyStudyTemplate(e){this._chartWidget.model().applyStudyTemplate(e,""+1e3*Math.random())}drawOnAllCharts(e){(0,N.drawOnAllCharts)().setValue(e)}createOrderLine(){return this._createTradingPrimitive("LineToolOrder")}createPositionLine(){return this._createTradingPrimitive("LineToolPosition")}createExecutionShape(){return this._createTradingPrimitive("LineToolExecution")}symbol(){return this._chartWidget.symbolWV().value()}symbolExt(){const e=this._chartWidget.model().mainSeries().symbolInfo();return null===e?null:{symbol:e.name,full_name:e.full_name,exchange:e.exchange,description:e.description,type:e.type,pro_name:e.pro_name,typespecs:e.typespecs,delay:e.delay}}resolution(){return this._chartWidget.model().mainSeries().interval()}marketStatus(){return this._chartWidget.model().mainSeries().marketStatusModel().currentSession().spawn()}getVisibleRange(){const e={from:0,to:0},t=this._chartWidget.model().timeScale(),i=t.visibleBarsStrictRange();if(null===i)return e;const n=i.firstBar(),s=i.lastBar(),o=this._convertIndexToPublicTime(s);if(null===o)return e;const a=Math.max((0,r.ensureNotNull)(t.points().range().value()).firstIndex,n);return e.from=(0,r.ensureNotNull)(this._convertIndexToPublicTime(a)),e.to=o,e}getVisiblePriceRange(){if(console.warn("`getVisiblePriceRange` is deprecated. Use Price Scale API instead"),!this._chartWidget.model().mainSeries())return null;return this._chartWidget.model().mainSeries().priceScale().priceRangeInPrice()}
scrollPosition(){return console.warn("`scrollPosition` is deprecated. Use rightOffset from Time Scale API instead"),this._chartWidget.model().timeScale().rightOffset()}defaultScrollPosition(){return console.warn("`defaultScrollPosition` is deprecated. Use defaultRightOffset from Time Scale API instead"),this._chartWidget.model().timeScale().defaultRightOffset().value()}priceFormatter(){return this._chartWidget.model().mainSeries().priceScale().formatter()}chartType(){return this._chartWidget.model().mainSeries().properties().childs().style.value()}setTimezone(e){this._chartWidget.setTimezone(e)}getTimezone(){return this._chartWidget.getTimezone()}getTimezoneApi(){return this._timezoneApi}getPanes(){return this._chartWidget.model().model().panes().map((e=>this._getPaneApi(e)))}exportData(e){return Promise.reject("Data export is not supported")}setDragExportEnabled(e){console.error("feature is not enabled")}canZoomOut(){return!this._chartWidget.model().zoomStack().isEmpty()}zoomOut(){this.canZoomOut()&&this._chartWidget.model().zoomFromViewport()}setZoomEnabled(e){this._chartWidget.model().model().setZoomEnabled(e)}setScrollEnabled(e){this._chartWidget.model().model().setScrollEnabled(e)}shapesGroupController(){return new qe(this._chartWidget.model().lineToolsGroupController(),this._chartWidget.model().model())}isSelectBarRequested(){return this._chartWidget.selectPointMode().value()!==N.SelectPointMode.None}requestSelectBar(){return this.isSelectBarRequested()?Promise.reject("already requested"):new Promise(((e,t)=>{this._chartWidget.requestSelectPoint({pointType:"time"}).then((t=>{e(this._convertTimeToPublic((0,r.ensureDefined)(t.point.time)))})).catch((()=>{t("cancelled")}))}))}cancelSelectBar(){this.isSelectBarRequested()&&this._chartWidget.cancelRequestSelectPoint()}barTimeToEndOfPeriod(e){const t=this._prepareEndOfPeriodArgs();return function(e,t,i){if(i.isDays())return t;if(e.moveTo(1e3*t),i.isIntraday()){const i=e.indexOfBar(1e3*t);if(i<0)throw new Error(`${t} is out of the instrument session `);return e.endOfBar(i)/1e3}return e.startOfBar(Y.SessionStage.LASTBAR_SESSION)/1e3}(t.barBuilder,e,t.intervalObj)}endOfPeriodToBarTime(e){const t=this._prepareEndOfPeriodArgs();return function(e,t,i){if(i.isDays())return t;const r=1e3*t-1;if(e.moveTo(r),i.isIntraday()){const i=e.indexOfBar(r);if(i<0)throw new Error(`${t} is out of the instrument session `);return e.startOfBar(i)/1e3}return e.startOfBar(0)/1e3}(t.barBuilder,e,t.intervalObj)}createAnchoredShape(e,t){const i=()=>new Error(`Cannot create "${t.shape}" shape`),r=t.shape;if((0,F.isSupportedLineTool)(r)&&!0!==F.supportedLineTools[r].isAnchored)throw console.warn(`${r} is not an anchored shape. It can be created using createShape or createMultipointShape`),i();const n=this._chartWidget.model().model(),s=n.mainSeries();if(n.timeScale().isEmpty())throw i();const o=void 0!==t.ownerStudyId?n.dataSourceForId(t.ownerStudyId):s,a=this._convertPositionPercentToPricedPoint(e,o);if(null===a)throw i();return this.createMultipointShape([a],t)}properties(){
return this._chartWidget.properties()}setBarSpacing(e){this._chartWidget.model().timeScale().setBarSpacing(e)}scrollChartByBar(e){this._chartWidget.model().scrollChartByBar(e)}mergeAllScales(e){this._chartWidget.model().mergeAllScales(e)}chartPainted(){return this._chartWidget.chartPainted()}applyOverrides(e){this._chartWidget.applyOverrides(e)}addOverlayStudy(e,t,i){return this._chartWidget.addOverlayStudy(e,t,i)}lineToolsSynchronizer(){return this._chartWidget.lineToolsSynchronizer()}cloneLineTool(e){const t=this._chartWidget.model(),i=t.model().dataSourceForId(e);return t.cloneLineTools([i],!1)[0]}shareLineTools(e,t){const i=this._chartWidget.model(),r=e.map((e=>i.model().dataSourceForId(e)));i.shareLineTools(r,t)}getLollipopSourcesApi(){return this._lollipopSourcesApi||(this._lollipopSourcesApi=new Re(this._chartWidget)),this._lollipopSourcesApi}clickAtLatestUpdatesLollipop(){0}linkingGroupIndex(){return this._apiLinkingGroupIndex.spawn()}loadingScreenActive(){return this._chartWidget.screen.isShown()}symbolResolvingActive(){for(const e of this._chartWidget.model().model().symbolSources())if(e.symbolResolvingActive().value())return!0;return!1}hasModel(){return this._chartWidget.hasModel()}disableAllUtilitySources(){{const e=this._chartWidget.properties().childs(),t=this._chartWidget.model().mainSeries().properties().childs();[t.esdShowDividends,t.esdShowSplits,t.esdShowEarnings,t.showContinuousContractSwitches,t.showFuturesContractExpiration,t.showLastNews,e.chartEventsSourceProperties.childs().visible].forEach((e=>e.setValue(!1)))}}chartProto(){return Ke.ChartWidget.prototype}ranges(){return null===this._ranges&&(this._ranges=new Ee({chartWidget:this._chartWidget,chartWidgetCollection:this._chartWidget.chartWidgetCollection(),availableTimeFrames:We.availableTimeFrames})),this._ranges}getTimeScale(){return new J(this._chartWidget.model().timeScale())}async loadChartTemplate(e){await(0,k.loadTheme)(this._chartWidget.chartWidgetCollection(),{themeName:e,standardTheme:!1,noUndo:!1,onlyActiveChart:!0})}setTimeFrame(e){this.setActive(),this._chartWidget.loadRange(e)}async syncTime(e){if(this._chartWidget.hasModel()){const t=this._chartWidget.model().model(),i=t.mainSeries().syncModel();if(i)return t.syncTimeWithModel(i.syncSourceTarget(),e)}}syncDateRange(e,t){this._chartWidget.hasModel()&&this._chartWidget.model().model().gotoTimeRange(e,t)}getLineToolsState(e=1,t,i){this._canUseLineToolsSynchronizer("getLineToolsState");const n=i??!1;return(0,r.ensureNotNull)(this.lineToolsSynchronizer()).getDTO(e,t,n)}async applyLineToolsState(e){this._canUseLineToolsSynchronizer("applyLineToolsState"),await(0,r.ensureNotNull)(this.lineToolsSynchronizer()).applyDTO(e)}reloadLineToolsFromServer(){this._canUseLineToolsSynchronizer("reloadLineToolsFromServer"),(0,r.ensureNotNull)(this.lineToolsSynchronizer()).reloadAllLineTools()}studyMetaIntoRepository(){return(0,Me.studyMetaInfoRepository)()}replayStatus(){return this._chartWidget.model().model().replayStatus()}replayStudyStrategyProperties(){
return this._chartWidget.model().model().replayStudyStrategyProperties()}insertStudyWithoutCheck(e,t,i,r,n){return this._chartWidget.model().insertStudyWithoutCheck(new Ve.StudyMetaInfo(e,n),t,i,r)}copyEntityToClipboard(e){const t=this._chartWidget.model().model().dataSourceForId(e);t&&this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy([t])}pasteFromClipboard(){this._chartWidget.chartWidgetCollection().clipboard.uiRequestPaste()}_destroy(){this._chartWidget.hasModel()&&(this._chartWidget.model().crosshairSource().moved().unsubscribeAll(this),this._chartWidget.model().timeScale().logicalRangeChanged().unsubscribe(this,this._onLogicalRangeChanged)),this._widgetLinkingGroupIndex.destroy()}async _createTradingPrimitive(e){const t=this._chartWidget.model(),i=t.model(),n=(0,r.ensureNotNull)(i.paneForSource(i.mainSeries()));await(0,Ze.ensureLineToolLoaded)(e);const s={pane:n,point:(()=>{const e=(0,r.ensureNotNull)(t.mainSeries().bars().last());return{index:e.index,price:e.value[4],interval:i.mainSeries().interval()}})(),linetool:e,actionSource:"API"};return i.createLineTool(s).adapter()}_createStudy(e){return new Promise(((t,i)=>{this._chartWidget.insertStudy(e,[]).then((e=>{null===e?i("Failed to create study"):t(e.id())}))}))}_convertTimeToPublic(e){return this._getTimeConverter().convertInternalTimeToPublicTime(e)}_convertIndexToPublicTime(e){return null===this._chartWidget.model().mainSeries().symbolInfo()?null:this._getTimeConverter().convertTimePointIndexToPublicTime(e)}_convertPositionPercentToPricedPoint(e,t){const i=this._chartWidget.model().timeScale(),r=t.priceScale(),n=t.firstValue();if(null==n||!isFinite(n)||null===r)return null;const s=i.coordinateToIndex(e.x*i.width()),o=i.indexToTimePoint(s);if(null===o)return null;return{price:r.coordinateToPrice(e.y*r.height(),n),time:o}}_convertUserPointsToDataSource(e){const t=this._chartWidget.model().model(),i=t.mainSeries(),n=t.timeScale().points(),s=i.data();if(t.timeScale().isEmpty())return null;const o=e.map((e=>e.time||0)),a=this._alignPoints(o),l=(e,t,o)=>{const a=n.closestIndexLeft(e)||0,l={index:a,price:NaN},c=(0,r.ensureNotNull)(n.valueAt(a)),d=(0,r.ensureNotNull)(n.range().value());if(e>c&&a===d.lastIndex){const t=(0,r.ensureNotNull)(i.syncModel()).distance(c,e);t.success&&(l.index=l.index+t.result)}else if(e<c&&a===d.firstIndex){const t=(0,r.ensureNotNull)(i.syncModel()).distance(e,c);t.success&&(l.index=l.index-t.result)}if((0,re.isNumber)(t))l.price=t;else{let e=o?["open","high","low","close"].indexOf(o)+1:1;e<=0&&(e=1),l.price=(0,r.ensure)((0,r.ensureNotNull)(s.valueAt(a))[e])}return l},c=[];for(let t=0;t<e.length;t++){const i=e[t];c.push(l(a[t],i.price,i.channel))}return c}_convertTimeFromPublic(e){return this._getTimeConverter().convertPublicTimeToInternalTime(e)}_getTimeConverter(){const e=this._chartWidget.model().mainSeries();return(0,Ue.getChartWidgetApiTimeConverter)(e.interval(),(0,r.ensureNotNull)(e.symbolInfo(),"main series symbol info"),this._chartWidget.model().model())}_onHoveredSourceChanged(e){const t=null!==e&&(0,
ze.isPriceDataSource)(e)?e.id():null,i=this._prevHoveredSourceId;this._prevHoveredSourceId=t,t!==i&&this._dataSourceHovered.fire(t)}_onCrosshairMoved(e){{const t=this._convertIndexToPublicTime(e.index);if(null===t)return;return void this._crosshairMoved.fire({price:e.price,time:t})}}_makeSubscriptionFromDelegate(e){return{subscribe:e.subscribe.bind(e),unsubscribe:e.unsubscribe.bind(e),unsubscribeAll:e.unsubscribeAll.bind(e)}}_prepareEndOfPeriodArgs(){const e=this._chartWidget.model().model(),t=e.timezone(),i=(0,r.ensureNotNull)(e.mainSeries().symbolInfo()),n=e.mainSeries().interval(),s=new q.SessionInfo(t,i.session,i.session_holidays,i.corrections);return{barBuilder:(0,q.newBarBuilder)(n,s,s),intervalObj:G.Interval.parse(n)}}_getPaneApi(e){let t=this._panes.get(e);return void 0===t&&(t=new ae(e,this._chartWidget),this._panes.set(e,t)),t}_getStudyApi(e){let t=this._studies.get(e);return void 0===t&&(t=new be(e,this._chartWidget),this._studies.set(e,t)),t}_getLineDataSourceApi(e){let t=this._lineDataSources.get(e);return void 0===t&&(t=new Ae(e,this._chartWidget.model(),{apiPointsToDataSource:this._convertUserPointsToDataSource.bind(this),dataSourcePointsToPriced:e=>{const t=(0,r.ensureNotNull)(this._chartWidget.model().mainSeries().syncModel()),i=this._chartWidget.model().timeScale();return e.map((e=>{const r=i.normalizeBarIndex(e.index);return{price:e.price,time:this._convertTimeToPublic(t.projectTime(r.time_t,r.offset))}}))}}),this._lineDataSources.set(e,t)),t}_alignPoints(e){const t=this._chartWidget.model().model(),i=t.mainSeries(),r=i.interval(),n=i.symbolInfo();if(t.timeScale().isEmpty()||!G.Interval.isDWM(r)||null===n)return e;const s=(0,He.createDwmAligner)(r,n);return null===s?e:e.map((e=>s.timeToSessionStart(1e3*e)/1e3))}_onLogicalRangeChanged(){const e=this._chartWidget.model().mainSeries(),t=e.data().isEmpty();if(null!==this._chartWidget.model().timeScale().visibleBarsStrictRange()&&t)return void e.dataEvents().completed().subscribe(this,this._onLogicalRangeChanged,!0);const i=this.getVisibleRange();null!==this._prevVisibleRange&&(0,re.deepEquals)(this._prevVisibleRange,i)[0]||(this._prevVisibleRange=i,this._visibleBarsChanged.fire(i))}_canUseLineToolsSynchronizer(e){0}}var nt=i(626185),st=i(316485),ot=i(779923),at=i(64262),lt=i(332450),ct=i(707310),dt=i(825957),ht=i(313171),ut=i(699576),_t=i(904653),gt=i(884934);let pt=null;var mt=i(593789),ft=i(314892);const vt="alert_service";class yt{constructor(e,t){this.ALERT_DIALOG_CREATE_INVOCATION_ID=ft.ALERT_DIALOG_CREATE_INVOCATION_ID,this._messageDelegate=new l.Delegate,this._onAlertsCreated=e=>{this._onAlertsMessage({m:"alerts_created",p:e})},this._onAlertsUpdated=e=>{this._onAlertsMessage({m:"alerts_updated",p:e})},this._onAlertsDeleted=e=>{this._onAlertsMessage({m:"alerts_deleted",p:e})},this._onAlertFired=e=>{this._onAlertsMessage({m:"alert_fired",p:e})},this._onFiresDeleted=e=>{this._onAlertsMessage({m:"fires_deleted",p:e})},this._getDataSourceHub=e,this._alertsPushApi=t,this._subscribeToPushApi()}destroy(){this._unsubscribeFromPushApi()}
showCreateAlertDialog(e){return new Promise(((t,i)=>{(0,mt.invokeAlertEditor)({type:"create_alert",actionSource:vt,dataSourceHub:this._getDataSourceHub(),onDialogOpened:t,onAborted:i,method:e?.method,source:e?.source})}))}getAlertDialogInvocations(){return ft.alertEditorInvocationHandler.getDialogInvocations()}showEditAlertDialog(e,t){return new Promise(((i,r)=>{(0,mt.invokeAlertEditor)({type:"edit_alert",alertId:Number(e),actionSource:vt,dataSourceHub:this._getDataSourceHub(),onDialogOpened:i,onAborted:r,method:t?.method,source:t?.source})}))}subscribe(e){this._messageDelegate.subscribe(null,e)}unsubscribe(e){e?this._messageDelegate.unsubscribe(null,e):this._messageDelegate.unsubscribeAll(null)}_subscribeToPushApi(){this._alertsPushApi.on("alerts_created",this._onAlertsCreated),this._alertsPushApi.on("alerts_updated",this._onAlertsUpdated),this._alertsPushApi.on("alerts_deleted",this._onAlertsDeleted),this._alertsPushApi.on("alert_fired",this._onAlertFired),this._alertsPushApi.on("fires_deleted",this._onFiresDeleted)}_unsubscribeFromPushApi(){this._alertsPushApi.off("alerts_created",this._onAlertsCreated),this._alertsPushApi.off("alerts_updated",this._onAlertsUpdated),this._alertsPushApi.off("alerts_deleted",this._onAlertsDeleted),this._alertsPushApi.off("alert_fired",this._onAlertFired),this._alertsPushApi.off("fires_deleted",this._onFiresDeleted)}_onAlertsMessage(e){this._messageDelegate.fire({source:"pricealerts",data:e})}}var St=i(991016),bt=i(707934),wt=i(556466),Ct=i(262078),Tt=i(667887),Pt=i(613122);function At(){throw new Error("not implemented")}const It=(0,g.isOnMobileAppPage)("any")&&(!a.enabled("mobile_apps_distinguish_pro_full_name")||(0,w.isFeatureEnabled)("ignore_mobile_apps_distinguish_pro_full_name"));function Lt(e){const t=new B.WatchedValue(e.value()),i=t=>{(0,V.allowSavingDefaults)(!0),e.setValue(t),(0,V.allowSavingDefaults)(!1)};return t.subscribe(i),e.subscribe(t,(()=>{t.setValue(e.value())})),t.spawn((()=>{e.unsubscribeAll(t),t.unsubscribe(i)}))}class Dt extends ct.TradingViewAuthApi{constructor(e){super(),this.linking=s.linking,this._lockDrawingsWatchedValue=null,this._hideDrawingsWatchedValue=null,this._hideIndicatorsWatchedValue=null,this._studyTemplatesDrawer=null,this._fontIconsSettingsDrawer=null,this._favoriteDrawingsToolbar=null,this._webview=null,this._themesApi=null,this._newsApiDeferredPromise=null,this._newsApiRejectionReason=null,this._watchlistApiDeferredPromise=null,this._watchlistApiRejectionReason=null,this._widgetbarApiDeferredPromise=null,this._widgetbarApiRejectionReason=null,this._isDestroyed=!1,this._widgebarApi=null,this._chartWidgets=new WeakMap,this._layoutSettingsDrawer=null,this._magnetEnabledWV=null,this._magnetModeWV=null,this._magnetSnapsToIndicatorsWV=null,this._drawOnAllCharts=(0,nt.convertPropertyToWatchedValue)((0,N.drawOnAllCharts)()),this._replayApi=null,this._pineEditorApi=null,this._backtestingStrategyApi=null,this._supportTicketData=null,this._activeChartWidgetChangedDelegate=new l.Delegate,this._alerts=null,this._activateChart=e=>{
this.setActiveChart(this._chartIndex(e))};const{chartApiInstance:t,chartWidgetCollection:i,studyMarket:r,saveChartService:n,loadChartService:a,sharingChartService:c=null,webview:d=null,favoriteServices:h,alertsServices:u,supportTicketData:_=null}=e;this._chartApiInstance=t,this._chartWidgetCollection=i,this._studyMarket=r,this._saveChartService=n,this._sharingChartService=c,this._loadChartService=a,this._favoriteServices=h,this._intervalsService=new C.IntervalsService(t?.defaultResolutions),this._alertsWidgetDialog=new T.AlertsWidgetDialog((()=>i.activeChartWidget.value())),this._detailsDialogController=P.DetailsDialogController.getInstance(),this._supportedChartStylesSpawn=s.linking.supportedChartStyles.spawn(),this._chartWidgetCollection.onAboutToBeDestroyed.subscribe(null,(()=>this.destroy()),!0),this._webview=d,this._alertService=u?new yt((()=>this._chartWidgetCollection.activeChartWidget.value().model().model()),u.alertsPushApi):null,this._supportTicketData=_;const g=i.lock;if(this._symbolSync=g.symbol.spawn(),this._intervalSync=g.interval.spawn(),this._dateRangeSync=g.dateRange.spawn(),this._crosshairSync=g.crosshair.spawn(),this._timeSync=g.trackTime.spawn(),this._chartWidgetCollection.activeChartWidget.subscribe((()=>{this._activeChartWidgetChangedDelegate.fire()})),It){const e=this.linking.symbol,t=this.linking.proSymbol,i=Object.create(t);i.setValue=(t,i)=>e.setValue(t,i),this.linking=Object.create(this.linking,{symbol:{configurable:!1,get:()=>i}})}o.subscribe("toggle_currency_menu_inner",((...e)=>{this._toggleUnitConversionMenu("toggle_currency_menu",...e)}),this),o.subscribe("toggle_unit_menu_inner",((...e)=>{this._toggleUnitConversionMenu("toggle_unit_menu",...e)}),this)}destroy(){this._supportedChartStylesSpawn.destroy(),this._intervalsService?.destroy(),this._themesApi?.destroy(),this._widgebarApi?.destroy(),this._widgetbarApiRejectionReason="This ITradingViewApi instance has been destroyed",this._symbolSync.destroy(),this._intervalSync.destroy(),this._dateRangeSync.destroy(),this._crosshairSync.destroy(),this._timeSync.destroy(),this._drawOnAllCharts.destroy(),this._pineEditorApi?.destroy(),this._isDestroyed=!0,this._magnetEnabledWV?.destroy(),this._magnetModeWV?.destroy(),this._magnetSnapsToIndicatorsWV?.destroy(),o.unsubscribeAll("toggle_currency_menu_inner",this),o.unsubscribeAll("toggle_unit_menu_inner",this)}themes(){return null===this._themesApi&&(this._themesApi=new O({chartWidgetCollection:this._chartWidgetCollection})),this._themesApi}dialogs(){return{Indicators:this._studyMarket,Compare:this._chartWidgetCollection.getCompareDialogRenderer(),ObjectsTree:h.ObjectTreeDialogController.getInstance(),ChartProperties:this._chartWidgetCollection.getChartPropertiesDialogRenderer(),ChartLayoutSaveAs:this._saveChartService?.getSaveAsController()??null,ChartLayoutRename:this._saveChartService?.getRenameController()??null,ChartLayoutCreate:this._saveChartService?.getCreateController()??null,ChartLayoutLoad:this._loadChartService,Alerts:this._alertsWidgetDialog,Details:this._detailsDialogController,
FinancialsCharts:I.FinancialsDialogController.getInstance(),Technicals:A.TechnicalsDialogController.getInstance(),Forecast:L.ForecastDialogController.getInstance()}}subscribe(e,t){o.subscribe(e,t,void 0)}unsubscribe(e,t){o.unsubscribe(e,t,void 0)}onActiveChartChanged(){return this._activeChartWidgetChangedDelegate}webview(){return this._webview||At(),this._webview}connect(){this._chartApiInstance&&!this._chartApiInstance.connected()&&this._chartApiInstance.connect(),Ct.pushStreamMultiplexer.forceConnect()}disconnect(){this._chartApiInstance&&this._chartApiInstance.connected()&&this._chartApiInstance.disconnect(),Ct.pushStreamMultiplexer.isConnected()&&Ct.pushStreamMultiplexer.disconnect()}onConnectionStatusChanged(e){Ct.pushStreamMultiplexer.onStatus(e)}isConnected(){return Ct.pushStreamMultiplexer.status()===wt.ConnectionStatus.Open}supportTicketData(){return this._supportTicketData}setPublishChartOptions(e){(0,St.setPublishChartOptions)(e)}publishChart(e){return(0,St.publishChart)(e)}studyTemplatesDrawerApi(){return Promise.all([i.e(23854),i.e(98185),i.e(98933),i.e(63039),i.e(6612),i.e(67780),i.e(84587),i.e(66032),i.e(13672),i.e(30158),i.e(44213),i.e(10844),i.e(30683),i.e(51979),i.e(47827),i.e(28260),i.e(43946),i.e(6376),i.e(93014),i.e(99700),i.e(33425),i.e(32227),i.e(63469),i.e(17170)]).then(i.bind(i,560046)).then((e=>(this._studyTemplatesDrawer||(this._studyTemplatesDrawer=new e.ToolWidgetTemplatesDrawerMenuRenderer(this._chartWidgetCollection)),this._studyTemplatesDrawer)))}fontIconsSettingsDrawer(){return Promise.all([i.e(80039),i.e(98185),i.e(66032),i.e(30158),i.e(44213),i.e(9323),i.e(6461),i.e(90810),i.e(95225),i.e(32227),i.e(87473),i.e(63469),i.e(41957),i.e(64558)]).then(i.bind(i,444206)).then((e=>(this._fontIconsSettingsDrawer||(this._fontIconsSettingsDrawer=new e.IconsSettingsDrawerApi),this._fontIconsSettingsDrawer)))}intervalsService(){return this._intervalsService}alertService(){return this._alertService}async alerts(){if(null!==this._alerts)return this._alerts;{const e=await i.e(60054).then(i.bind(i,583485));return this._alerts=e.initAlertsNamespace(),this._alerts}}supportedChartTypes(){return this._supportedChartStylesSpawn}setBrokerName(e){this._chartWidgetCollection.setBroker(e)}getDrawOnAllCharts(){return(0,N.drawOnAllCharts)().value()}drawOnAllCharts(e){return(0,N.drawOnAllCharts)().setValue(e)}drawOnAllChartsEnabled(){return this._drawOnAllCharts}getDrawOnAllChartsMode(){return(0,N.drawOnAllChartsMode)().value()}drawOnAllChartsMode(e){(0,N.drawOnAllChartsMode)().setValue(e)}currencies(){return this._chartApiInstance?.availableCurrencies()??Promise.reject()}units(){return this._chartApiInstance?.availableUnits()??Promise.reject()}disableTrackingEvents(){(0,W.disableTrackingEvents)()}getSaveChartService(){return this._saveChartService}symbolSync(){return this._symbolSync}intervalSync(){return this._intervalSync}dateRangeSync(){return this._dateRangeSync}crosshairSync(){return this._crosshairSync}timeSync(){return this._timeSync}setSymbolSearchUI(e){x.SymbolSearchUI.setProvider({
getSymbol:()=>e.getSymbol()})}chart(e=0){if(e<0||e>=this.chartsCount())throw Error("Incorrect index: "+e);return this._getChartWidgetApi(this._chartWidgetCollection.getAll()[e])}activeChart(){return this._getChartWidgetApi(this._activeChartWidget())}setActiveChart(e){if(e>=0&&e<this.chartsCount()){const t=this._chartWidgetCollection.getAll()[e];t&&(this._activeChartWidget().inFullscreen()?t.requestFullscreen():this._chartWidgetCollection.activeChartWidget.setValue(t))}}async replayApi(){if(null===this._chartApiInstance)throw new Error("replay api isn't available");if(null!==this._replayApi)return this._replayApi;{await Promise.all(this._chartWidgetCollection.getAll().map(b.waitForModel));const{controller:e,createReplayWV:t}=await(0,ht.getReplayUiControllerInstance)(this._chartWidgetCollection,(0,r.ensureNotNull)(this._chartApiInstance));if(null===this._replayApi){const i=t?.(this._chartWidgetCollection,e);this._replayApi=new v((0,r.ensureNotNull)(e),this._chartWidgetCollection,i)}return this._replayApi}}async backtestingStrategyApi(){if(null===this._chartApiInstance)throw new Error("backtesting api isn't available");if(null!==this._backtestingStrategyApi)return this._backtestingStrategyApi;{await Promise.all(this._chartWidgetCollection.getAll().map(b.waitForModel));const{backtestingStrategyFacade:e}=await function(e){const t=t=>({backtestingStrategyFacade:new t.BacktestingStrategyFacade(e)});return pt||(pt=Promise.all([i.e(16564),i.e(32227),i.e(19465),i.e(14105)]).then(i.bind(i,323706)).then(t)),pt}(this._chartWidgetCollection);return null===this._backtestingStrategyApi&&(this._backtestingStrategyApi=e),this._backtestingStrategyApi}}pineEditorApi(){return this._pineEditorApi=this._pineEditorApi??new S,this._pineEditorApi}activeChartIndex(){return this._chartIndex(this._activeChartWidget())}chartsCount(){return u.layouts[this.layout()].count}layout(){return this._chartWidgetCollection.layout.value()}layoutName(){return this._chartWidgetCollection.metaInfo.name.value()}layoutNameWatchedValue(){return this._chartWidgetCollection.metaInfo.name.readonly()}async layoutSettingsDrawer(){{const e=await Promise.all([i.e(7374),i.e(66032),i.e(15708),i.e(54320),i.e(10844),i.e(78628),i.e(74671),i.e(99672),i.e(72202),i.e(32227),i.e(45289)]).then(i.bind(i,320284));return this._layoutSettingsDrawer||(this._layoutSettingsDrawer=new e.LayoutSettingsDrawerApi(this._chartWidgetCollection)),this._layoutSettingsDrawer}}setLayout(e,t){t?.withUndo?this._chartWidgetCollection.setChartLayoutWithUndo(e):this._chartWidgetCollection.setLayout(e)}resetLayoutSizes(e){this._chartWidgetCollection.resetLayoutSizes(e)}unloadUnusedCharts(){this._chartWidgetCollection.unloadUnusedCharts()}moveActiveChart(e){this._chartWidgetCollection.moveActiveChartWithUndo(e)}async openPublicationViewPopup(e){await(0,Pt.openPublicationViewPopup)({uid:e})}async closePublicationViewPopup(){await(0,Pt.closeCurrentPublicationViewPopup)()}undoRedoState(){return this._chartWidgetCollection.undoHistory.state()}clearUndoHistory(){
return this._chartWidgetCollection.undoHistory.clearStack()}undo(){this._chartWidgetCollection.undoHistory.undo()}redo(){this._chartWidgetCollection.undoHistory.redo()}async selectLineTool(e,t){if(!(0,F.isSupportedLineTool)(e))return;const i=F.supportedLineTools[e].name;if("icon"===e){const e=t?.icon;void 0!==e&&N.iconTool.setValue(e)}if(await(0,U.initLineTool)(i),"emoji"===e){const e=t?.emoji;void 0!==e&&N.emojiTool.setValue(e)}if("sticker"===e){const e=t?.sticker;void 0!==e&&N.stickerTool.setValue(e)}N.tool.setValue(i)}favoriteDrawingsToolbar(){return i.e(65551).then(i.bind(i,738724)).then((e=>(this._favoriteDrawingsToolbar||(this._favoriteDrawingsToolbar=new e.FavoriteDrawingsApi),this._favoriteDrawingsToolbar)))}sharingChart(){return this._sharingChartService}watchlist(){At()}setWatchlistApiPromise(e){At()}news(){At()}setNewsApiPromise(e){At()}widgetbar(){At()}setWidgetbarApiPromise(e){At()}getChartStorage(){return(0,D.getChartStorage)()}setDebugMode(e){a.setEnabled("charting_library_debug_mode",e)}setFeatureEnabled(e,t){"chart_crosshair_menu"!==e?a.setEnabled(e,t):addPlusButtonProperty.setValue(t)}magnetEnabled(){return null===this._magnetEnabledWV&&(this._magnetEnabledWV=Lt((0,N.properties)().childs().magnet)),this._magnetEnabledWV}magnetMode(){return null===this._magnetModeWV&&(this._magnetModeWV=Lt((0,N.properties)().childs().magnetMode)),this._magnetModeWV}magnetSnapsToIndicators(){return null===this._magnetSnapsToIndicatorsWV&&(this._magnetSnapsToIndicatorsWV=Lt((0,N.properties)().childs().magnetSnapsToIndicators)),this._magnetSnapsToIndicatorsWV}flushBufferedData(){H.flushDelegate.fire()}chartWidgetCollectionState(e){return this._chartWidgetCollection.state(e)}chartWidgetCollectionSeriesStatuses(){return this._chartWidgetCollection.chartSeriesStatuses()}watermark(){At()}setContextMenuOptions(e){Dt.setContextMenuOptions(e)}changeSymbol(e,t,i){s.linking.interval.setValue((0,r.ensureNotNull)(G.Interval.normalize(t))),s.linking.setSymbolAndLogInitiator(e,"API"),i&&this.activeChart().onDataLoaded().subscribe(null,i,!0)}closePopupsAndDialogs(){c.ContextMenuManager.hideAll(),o.emit(lt.CLOSE_POPUPS_AND_DIALOGS_COMMAND)}startFullscreen(){return this._chartWidgetCollection.startFullscreen()}exitFullscreen(){return this._chartWidgetCollection.exitFullscreen()}getFavoriteChartStylesService(){if(this._favoriteServices)return this._favoriteServices.favoriteChartStylesService;At()}getFavoriteIntervalsService(){if(this._favoriteServices)return this._favoriteServices.favoriteIntervalsService;At()}getFavoriteCurrencyUnitConversionApi(){if(this._favoriteServices)return this._favoriteServices.favoriteCurrencyUnitConversionApi;At()}getIntervals(){let e=[];const t=(0,at.getCustomResolutions)();return null!==this._chartApiInstance&&(e=this._chartApiInstance.defaultResolutions()),(0,at.mergeResolutions)(e,t)}getLinetoolsFavoritesStore(){if(this._favoriteServices)return this._favoriteServices.lineToolsFavoritesService;At()}getSavedCharts(e){Xe.backend.getCharts().then(e)}getStudiesList(){At()}getStudyInputs(e){At()}
getStudyStyles(e){At()}getSymbolInterval(e){const t={symbol:this.linking.proSymbol.value(),interval:this.linking.interval.value()};return e?.(t),t}hasChartChanges(){return this._chartWidgetCollection.hasChanges()}async loadChart(e){At()}async loadChartFromServer(e){await(this._loadChartService?.loadChart(e,!1))}async loadLayoutFromServerByLayoutId(e,t,i){await(this._loadChartService?.loadChartByUrl(e,!!t,i))}layoutId(){return this._chartWidgetCollection.metaInfo.uid.value()}async createNewLayout(e){{const t=await(0,E.createNewChart)(e);if(void 0===t)return null;const i=new URL(t);return window.history.replaceState(null,"",i),/\/chart\/([^/]+)\/?$/.exec(i.pathname)?.[1]??null}}lockAllDrawingTools(){return null===this._lockDrawingsWatchedValue&&(this._lockDrawingsWatchedValue=new B.WatchedValue((0,N.lockDrawings)().value()),this._lockDrawingsWatchedValue.subscribe((e=>{(0,N.lockDrawings)().setValue(e)})),(0,N.lockDrawings)().subscribe(this,(()=>{(0,r.ensureNotNull)(this._lockDrawingsWatchedValue).setValue((0,N.lockDrawings)().value())}))),this._lockDrawingsWatchedValue}hideAllDrawingTools(){return null===this._hideDrawingsWatchedValue&&(this._hideDrawingsWatchedValue=new B.WatchedValue((0,N.hideAllDrawings)().value()),this._hideDrawingsWatchedValue.subscribe((e=>{(0,N.hideAllDrawings)().setValue(e)})),(0,N.hideAllDrawings)().subscribe(this,(()=>{(0,r.ensureNotNull)(this._hideDrawingsWatchedValue).setValue((0,N.hideAllDrawings)().value())}))),this._hideDrawingsWatchedValue}hideAllIndicators(){return null===this._hideIndicatorsWatchedValue&&(this._hideIndicatorsWatchedValue=new B.WatchedValue((0,N.hideAllIndicators)().value()),this._hideIndicatorsWatchedValue.subscribe((e=>{(0,N.hideAllIndicators)().setValue(e)})),(0,N.hideAllIndicators)().subscribe(this,(()=>{(0,r.ensureNotNull)(this._hideIndicatorsWatchedValue).setValue((0,N.hideAllIndicators)().value())}))),this._hideIndicatorsWatchedValue}logs(){return{getLogHistory:n.getLogHistory,enable:window.lon,disable:window.loff}}mainSeriesPriceFormatter(){return this._chartWidgetCollection.activeChartWidget.value().model().mainSeries().priceScale().formatter()}onContextMenu(e){o.subscribe("onContextMenu",(t=>{t.callback(e(t.unixtime,t.price))}),void 0)}onGrayedObjectClicked(e){o.subscribe("onGrayedObjectClicked",e,void 0)}removeChartFromServer(e,t){Xe.backend.removeChart(e).then(t)}saveChart(e,t){if(!this._saveChartService)return;const i=this._saveChartService.saveToJSON(t);return e&&e(JSON.parse(i.content))}saveChartToServer(e,t,i){this._saveChartService&&this._saveChartService.saveChartSilently(e,t,i)}selectedLineTool(){const e=Object.keys(F.supportedLineTools),t=N.tool.value();for(let i=0;i<e.length;++i)if(F.supportedLineTools[e[i]].name===t)return e[i];throw new Error("Unknown tool")}autosave(){if(!this._saveChartService)throw new Error("Saving service is not available");return this._saveChartService.autoSaveEnabled()}setForceFullscreenMode(){this._chartWidgetCollection.setViewMode(d.CollectionViewMode.ForceFullscreen),this._activeChartWidget().requestFullscreen()}
setMultichartMode(){this._chartWidgetCollection.setViewMode(d.CollectionViewMode.Multichart),this._activeChartWidget().exitFullscreen()}setDateRangeLinkingEnabled(e){this._chartWidgetCollection.lock.dateRange.setValue(e)}studyMetaIntoRepository(){return(0,Me.studyMetaInfoRepository)()}deferredStudiesReady(){return st.DeferredStudies.ready()}hasPendingStudiesModuleLoading(){return(0,ee.hasPendingStudiesModuleLoading)()}hasPendingLineToolsModuleLoading(){return(0,Ze.hasPendingLineToolsModuleLoading)()}shouldBeSaved(){return!this._chartWidgetCollection.readOnly()&&(this._saveChartService?.hasChanges()||!1)}setIntervalLinkingEnabled(e){this._chartWidgetCollection.lock.interval.setValue(e)}setTimeFrame(e){this._chartWidgetCollection.setTimeFrame(e)}showConfirmDialog(e){let t=e.callback;const i=e=>{t&&(t(e),t=null)};(0,ot.showConfirm)({title:e.title,text:e.body||"",onClose:()=>{i(!1)},onConfirm:e=>{i(!0),e.dialogClose()}})}showLoadChartDialog(){this._loadChartService?.showLoadDialog()}persistentLogger(){return(0,_.getPersistentLogger)()}showNoticeDialog(e){(0,ot.showWarning)({title:e.title,text:e.body||"",onClose:e.callback})}showSupportDialog(){(0,dt.showSupportDialog)()}showSaveAsChartDialog(){const e=this._saveChartService;e&&window.runOrSignIn((()=>{e.saveChartAs()}),{source:"Save as chart dialogue"})}showRenameChartDialog(){{const e=this._saveChartService;if(!e)return;e.renameChart()}}saveChartOrShowTitleDialog(e,t,i){{const r=this._saveChartService;if(!r)return;r.saveChartOrShowTitleDialog(e,t,i)}}showCreateAlertDialog(){this._alertService&&this._alertService.showCreateAlertDialog()}createGoProDialog(e){(0,bt.createGoProDialog)(e)}setUserInfo(e){e&&(!1===e.profile_data_filled&&delete e.profile_data_filled,window.loginUser(e))}openMobileChartPicker(){o.emit(Tt.openMobileChartPickerCommand)}closeMobileChartPicker(){o.emit(Tt.closeMobileChartPickerCommand)}takeClientScreenshot(e){return this._chartWidgetCollection.clientSnapshot(e)}takeScreenshot(){return this._chartWidgetCollection.takeScreenshot()}trading(){return(0,ut.tradingService)()}waitTrading(){return(0,ut.waitTradingService)()}viewMode(){return this._chartWidgetCollection.viewMode.value()}viewModeWatchedValue(){return this._chartWidgetCollection.viewMode}async dummyBrokerController(){{const e=new((await Promise.all([i.e(92409),i.e(38326)]).then(i.bind(i,676537))).DummyBrokerController);return e.startBroker=async()=>{const e=(0,r.ensureNotNull)(this.trading());await e.selectBroker("DUMMY"),await(0,_t.delay)(null,1e3),e.activeBroker()?.signIn("","",1)},e}}pineLibApi(){return{saveNew:gt.saveNew,saveNext:gt.saveNext,requestBuiltinScripts:gt.requestBuiltinScripts}}resetCache(){window.ChartApiInstance.resetCache()}static setContextMenuOptions(e){void 0!==e.items_processor&&c.ContextMenuManager.setCustomItemsProcessor(e.items_processor),void 0!==e.renderer_factory&&c.ContextMenuManager.setCustomRendererFactory(e.renderer_factory)}_getChartWidgetApi(e){let t=this._chartWidgets.get(e);return void 0===t&&(t=new rt(e,this._activateChart.bind(null,e)),
this._chartWidgets.set(e,t)),t}_chartIndex(e){return this._chartWidgetCollection.getAll().indexOf(e)}_activeChartWidget(){return this._chartWidgetCollection.activeChartWidget.value()}_toggleUnitConversionMenu(e,t,i,n,s){if(t)return void o.emit(e,t,-1,-1,"");const a=this._chartWidgetCollection.getAll(),l=a.findIndex((e=>e.model().model().id()===i));if(-1===l)return;const c=(0,r.ensureDefined)(a[l]).paneWidgets().findIndex((e=>e.state().id()===n));-1!==c&&o.emit(e,t,l,c,s)}}},707310:(e,t,i)=>{"use strict";i.d(t,{TradingViewAuthApi:()=>n});var r=i(707934);class n{loginRequired(){return window.loginRequiredDelegate}onGoProDialog(e,t){(0,r.onGoProDialog)(e,t)}}},210075:(e,t,i)=>{"use strict";i.d(t,{formatFinancialsWithZeroPrecisionAndPlaceholder:()=>o});var r=i(796814),n=i(433646);const s=new r.FinancialsFormatter(2,0);function o(e,t){const i=(0,n.getNumberOrUndefined)(e);if(void 0!==i&&Math.abs(i)<r.FINANCIALS_FORMATTER_MAX_VALUE)return s.format(i,t)}},796814:(e,t,i)=>{"use strict";i.d(t,{FINANCIALS_FORMATTER_MAX_VALUE:()=>o,FinancialsFormatter:()=>a});var r=i(444372),n=i(969680),s=i(51196);const o=1e100;class a extends s.VolumeFormatter{constructor(e=2,t){super({precision:e,minPrecision:t??e,dimensionPrecision:e,dimensionMinPrecision:t??e})}format(e,t){if(Math.abs(e)>=o)return r.t(null,void 0,i(696935));const s=super.format(e,t);if(s.length>0){const e=s.slice(-1);if("K"===e||"M"===e||"B"===e||"T"===e)return(0,n.forceLTRStrSsr)(s)}return s}parse(e,t){return super.parse((0,n.stripLTRStrSsr)(e),t)}}},701482:(e,t,i)=>{"use strict";i.d(t,{drawSelection:()=>o,getSymbolCoordinatesInfo:()=>s});var r=i(969680),n=i(688857);function s(e){const{symbolPosition:t,textWidth:i,textByLines:s,lineHeight:o,font:a,textAlign:l,lineSpacing:c=0}=e;let[d,h]=function(e,t){let i=0;switch(e){case"center":i=t/2;break;case"start":i=(0,r.isRtl)()?t:0;break;case"end":i=(0,r.isRtl)()?0:t;break;case"right":i=t}return[i,0]}(l,i);const u=(0,r.isRtl)(),_=o+c;let g=0,p=0,m="";for(let e=0;e<s.length;e++){let r=t-g;const{wrappedLinePart:o,wrappedLineEnd:c,hidden:f,text:v}=s[e],y=e<s.length-1?s[e+1]:null;if(f||(m=v),y&&r>v.length){g+=v.length+(o&&!c?0:1),f||(h+=_);continue}f&&(h-=_);const S=o&&!c&&v.length===r&&y&&!y.hidden;if(f&&(m+=" ",r=m.length),"center"===l)if(S)d=i/2;else{const e=(0,n.measureText)(m,a).width,t=(0,n.measureText)(m.slice(0,r),a).width,s=i/2;d=u?s+e/2-t:s-e/2+t}else if("right"===l&&!u||"left"===l&&u||"end"===l)if(S)d=i;else{const e=(0,n.measureText)(m.slice(r),a).width;d=u?e:i-e}else if(S)d=0;else{const e=(0,n.measureText)(m.slice(0,r),a).width;d=u?i-e:e}S?(p=e+1,h+=_):p=e;break}return{x:d,y:h,lineNumber:p}}function o(e,t,i){const{lines:s,selectionStart:o,selectionEnd:l,left:c,right:d,color:h,font:u,lineHeight:_,lineSpacing:g=0}=i;e.save();const p=(c+d)/2,m=_+g,f=(0,r.isRtl)();e.fillStyle=h;const{horizontalPixelRatio:v,verticalPixelRatio:y}=t;if(o.lineNumber===l.lineNumber){const t=Math.round(o.x*v),i=Math.round(o.y*y),r=Math.round(l.x*v);e.fillRect(Math.min(t,r),i,Math.abs(t-r),Math.round(m*y))}else{const t=(0,n.measureText)(" ",u).width
;let i=0;for(let r=o.lineNumber;r<=l.lineNumber;r+=1){const n=r===o.lineNumber,h=r===l.lineNumber,_=s[r];if(_.hidden)continue;const g=a(_.text,u);let S,b,w=!1;"center"===e.textAlign?(S=n?o.x:f?p+g/2:p-g/2,b=h?l.x:f?p-g/2:p+g/2):"right"===e.textAlign||f&&"start"===e.textAlign||!f&&"end"===e.textAlign?(S=n?o.x:d-g,b=h?l.x:d,w=!0):(S=n?o.x:c,b=h?l.x:c+g);let C=Math.min(S,b),T=Math.max(S,b);h||_.wrappedLinePart&&!_.wrappedLineEnd||(w?C-=t:T+=t);const P=Math.round(C*v),A=Math.round(T*v),I=Math.round((o.y+i*m)*y),L=Math.round((o.y+(i+1)*m)*y);e.fillRect(P,I,A-P,L-I),i+=1}}e.restore()}function a(e,t){return(0,n.measureText)(e,t).width}},989488:(e,t,i)=>{"use strict";let r;async function n(e=null){return r||(r=async function(e){const{ScriptUpdater:t}=await Promise.all([i.e(16388),i.e(50687),i.e(32943),i.e(35524),i.e(7351),i.e(73618),i.e(40309),i.e(35168),i.e(5053),i.e(70333)]).then(i.bind(i,468610));return new t(e)}(e))}i.d(t,{loadScriptUpdaterAsync:()=>n})},618856:(e,t,i)=>{"use strict";i.r(t),i.d(t,{loadTheme:()=>s});var r=i(308721),n=i(85858);async function s(e,t){const{themeName:i,standardTheme:s,syncState:o=!0,noUndo:a=!1,applyOverrides:l=!1,onlyActiveChart:c=!1}=t,d=await(s?Promise.resolve((0,r.getStdTheme)(i)):(0,r.getTheme)(i)),h=!s;if(void 0!==d.content){const t=!s||c;l&&(void 0!==(u=d.content).chartProperties&&(0,n.applyDefaultsOverrides)(u.chartProperties),void 0!==u.mainSourceProperties&&(0,n.applyDefaultsOverrides)(u.mainSourceProperties,void 0,!0,"mainSeriesProperties")),await e.applyTheme({theme:d.content,onlyActiveChart:t,restoreNonThemeDefaults:h,themeName:i,standardTheme:s,syncState:o,noUndo:a})}var u;return d}},148433:(e,t,i)=>{"use strict";i.d(t,{latestUpdatesAvailableOnDevice:()=>o});var r=i(125226),n=i(314802);let s;s=!(i(638456).CheckMobile.iOS()&&"14"===navigator.userAgent.match(/(Version\/|iPhone OS |iPad; CPU OS )(\d+)/)?.[2])&&((0,n.isOnMobileAppPage)("old")?(0,r.isFeatureEnabled)("ios_app_news_and_minds"):((0,n.isOnMobileAppPage)("new"),!0));const o=s},320994:(e,t,i)=>{"use strict";i.d(t,{BitmapCoordinatesPaneRenderer:()=>n});var r=i(327714);class n{draw(e,t){new r.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useBitmapCoordinateSpace((e=>this._drawImpl(e)))}drawBackground(e,t){new r.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useBitmapCoordinateSpace((e=>this._drawBackgroundImpl(e)))}_drawBackgroundImpl(e){}}},708162:(e,t,i)=>{"use strict";i.d(t,{CompositeRenderer:()=>r});class r{constructor(){this._renderers=[],this._globalAlpha=1}setGlobalAlpha(e){this._globalAlpha=e}append(e){e&&this._renderers.push(e)}insert(e,t){this._renderers.splice(t,0,e)}clear(){this._renderers.length=0}isEmpty(){return 0===this._renderers.length}draw(e,t){for(let i=0;i<this._renderers.length;i++)e.save(),e.globalAlpha=this._globalAlpha,this._renderers[i].draw(e,t),e.restore()}drawBackground(e,t){e.save(),e.globalAlpha=this._globalAlpha;for(let i=0;i<this._renderers.length;i++){const r=this._renderers[i];r.drawBackground&&r.drawBackground(e,t)}e.restore()}hitTest(e,t){let i=null
;for(let r=this._renderers.length-1;r>=0;r--){const n=this._renderers[r].hitTest(e,t);null!==n&&(null===i||n.target()>i.target())&&(i=n)}return i}doesIntersectWithBox(e,t){return this._renderers.some((i=>!!i.doesIntersectWithBox&&i.doesIntersectWithBox(e,t)))}}},820807:(e,t,i)=>{"use strict";i.d(t,{MediaCoordinatesPaneRenderer:()=>n});var r=i(327714);class n{draw(e,t){new r.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useMediaCoordinateSpace((e=>this._drawImpl(e)))}drawBackground(e,t){new r.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useMediaCoordinateSpace((e=>this._drawBackgroundImpl(e)))}_drawBackgroundImpl(e){}}},315167:(e,t,i)=>{"use strict";i.d(t,{TextRenderer:()=>E,calculateLabelPosition:()=>p,fontSize:()=>I,getTextAlignInBox:()=>x,getTextBoundaries:()=>m,lineSpacing:()=>A,needTextExclusionPath:()=>f,wordWrap:()=>S});var r=i(86441),n=i(650151),s=i(934026),o=i(969680),a=i(560770),l=i(731974),c=i(338242),d=i(701482),h=i(536794),u=i(688857),_=i(660439),g=i(960433);function p(e,t,i,n,s){const o=.5*(t.x+i.x);let a=i.y;return t.y>i.y?(a-=e.height/2+n.y,a=Math.max(e.height/2,a)):(a+=e.height/2+n.y,a=Math.min(s-e.height/2,a)),new r.Point(o,a)}function m(e,t,i){if(e.isOutOfScreen(t,i))return null;const r=e.getPolygonPoints();return 0===r.length?null:r}function f(e){const t=e.getLinesInfo().lines;if(t.length%2==0)return!1;if(""===t[Math.floor(t.length/2)].text.trim())return!1;return!0}function v(e){const t=[];do{const i=e.match(/\s+/);if(!i||void 0===i.index||-1===i.index){t.push({word:e,spaces:""});break}t.push({word:e.slice(0,i.index),spaces:i[0]}),e=e.slice(i.index+i[0].length)}while(e.length);return t}function y(e,t,i,r){const n=[],s=[];for(let t=0;t<e.length;++t)s.push(t);for(;e.length;){const o=Math.max(1,(0,_.upperbound)(s,r,((r,n)=>(0,u.measureText)(e.slice(0,n+1),t,i).width>r),0,e.length));n.push(e.slice(0,o)),e=e.slice(o)}return n}function S(e,t,i,r=!0,n){n=(0,h.isString)(n)?parseInt(n):n;const s=(e+="").split(/\r\n|\r|\n|$/).map((e=>({text:e,hidden:!1,wrappedLinePart:!1,wrappedLineEnd:!1})));if(!(0,h.isNumber)(n)||!isFinite(n)||n<=0)return s;if((0,u.measureText)("x",t,i).width>n)return s;const o=[];for(let e=0;e<s.length;e++){const a=s[e];if((0,u.measureText)(a.text,t,i).width<=n){o.push(a);continue}const l=v(a.text),c=!0;let d="",h=0;for(;h<l.length;){const e=l[h];let s=`${d}${e.word}`,a=(0,u.measureText)(s,t,i).width;if(a>n){if(""!==d)o.push({text:d,hidden:!1,wrappedLinePart:c,wrappedLineEnd:!1}),d="";else if(1===s.length)o.push({text:s,hidden:!1,wrappedLinePart:c,wrappedLineEnd:!0}),e.word="";else{const r=y(s,t,i,n);for(let e=0;e<r.length-1;e+=1)o.push({text:r[e],hidden:!1,wrappedLinePart:c,wrappedLineEnd:!1});e.word=r[r.length-1]}continue}let _=s.length;if(s=`${d}${e.word}${e.spaces}`,a=(0,u.measureText)(s,t,i).width,a<n){d=s,h+=1;continue}const g=y(s,t,i,n);for(let e=0;e<g.length;e+=1){const t=g[e];_-=t.length;const i={text:t,hidden:e>0,wrappedLinePart:c,wrappedLineEnd:h===l.length-1&&e===g.length-1};i.hidden&&r||o.push(i)}d="",h+=1}""!==d&&o.push({text:d,wrappedLinePart:c,hidden:!1,
wrappedLineEnd:!0})}return o}function b(e,t,i){if(0===i)return e.clone();const n=(e.x-t.x)*Math.cos(i)-(e.y-t.y)*Math.sin(i)+t.x,s=(e.x-t.x)*Math.sin(i)+(e.y-t.y)*Math.cos(i)+t.y;return(0,r.point)(n,s)}function w(e){return void 0!==e.boxPaddingVert?e.boxPaddingVert*D(e):void 0!==e.boxPadding?e.boxPadding*D(e):I(e)/3}function C(e){return void 0!==e.boxPaddingHorz?e.boxPaddingHorz*D(e):void 0!==e.boxPadding?e.boxPadding*D(e):I(e)/3}function T(e){return void 0!==e.boxPaddingLeft?e.boxPaddingLeft*D(e):C(e)}function P(e){return void 0!==e.boxPaddingRight?e.boxPaddingRight*D(e):C(e)}function A(e){let t=e.lineSpacing;return void 0===t&&e.lineHeight&&(t=(e.lineHeight-1)*L(e)),(t??0)*D(e)}function I(e){return Math.ceil(L(e)*D(e))}function L(e){return e.fontsize||e.fontSize||30}function D(e){const t=Math.min(1,Math.max(.2,e.scale||1));if(1===t)return t;const i=L(e);return Math.ceil(t*i)/i}function x(e){const{horzAlign:t,extendLeft:i=!1,extendRight:n=!1,width:s,leftPoint:o,rightPoint:l}=e,c=(o.x<=s||i)&&(l.x>=0||n);let d,h,u=t;switch(u){case a.HorizontalAlign.Left:h=o.y,i?d=c?0:l.x:(d=o.x,u=a.HorizontalAlign.Right);break;case a.HorizontalAlign.Right:h=l.y,n?d=c?s:o.x:(d=l.x,u=a.HorizontalAlign.Left);break;default:d=((i&&c?0:o.x)+(n&&c?s:l.x))/2,h=(o.y+l.y)/2;break}return[(0,r.point)(d,h),u]}class E{constructor(e,t){this._data=null,this._textWidthCache=new g.TextWidthCache,this._internalData=null,this._boxSize=null,this._box=null,this._polygonPoints=null,this._linesInfo=null,this._fontInfo=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._hitTest=t||new l.HitTestResult(l.HitTarget.MovePoint,{areaName:l.AreaName.Text}),void 0!==e&&this.setData(e)}setHitTest(e){this._hitTest=e}data(){return this._data}updateData(e){this.setData({...(0,n.ensureNotNull)(this._data),...e})}setData(e){null!==e?((0,n.assert)(!e.decorator||void 0===e.wordWrapWidth,"Decorator is not supported with wordWrapWidth"),void 0===e.text&&(e.text=""),e.horzTextAlign||(e.horzTextAlign=e.horzAlign),!function(e,t){if(null===e||null===t)return null===e==(null===t);if(void 0===e.points!=(void 0===t.points))return!1;if(void 0!==e.points&&void 0!==t.points){if(e.points.length!==t.points.length)return!1;for(let n=0;n<e.points.length;++n)if(i=e.points[n],r=t.points[n],i.x!==r.x||i.y!==r.y)return!1}var i,r
;return e.text===t.text&&e.decorator===t.decorator&&e.vertAlign===t.vertAlign&&e.horzAlign===t.horzAlign&&e.horzTextAlign===t.horzTextAlign&&e.font===t.font&&e.offsetX===t.offsetX&&e.offsetY===t.offsetY&&e.bold===t.bold&&e.italic===t.italic&&e.fontsize===t.fontsize&&e.fontSize===t.fontSize&&e.backgroundRoundRect===t.backgroundRoundRect&&e.forceTextAlign===t.forceTextAlign&&e.wordWrapWidth===t.wordWrapWidth&&e.forceCalculateMaxLineWidth===t.forceCalculateMaxLineWidth&&e.lineHeight===t.lineHeight&&e.lineSpacing===t.lineSpacing&&e.scale===t.scale&&e.boxPadding===t.boxPadding&&e.boxPaddingVert===t.boxPaddingVert&&e.boxPaddingLeft===t.boxPaddingLeft&&e.boxPaddingRight===t.boxPaddingRight&&e.boxPaddingHorz===t.boxPaddingHorz&&e.angle===t.angle&&e.maxHeight===t.maxHeight&&e.outlineBorder?.width===t.outlineBorder?.width&&e.outlineBorder?.color===t.outlineBorder?.color}(this._data,e)?(this._data=e,this._internalData=null,this._boxSize=null,this._polygonPoints=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._linesInfo=null,this._fontInfo=null,this._box=null):this._data=e):this._data=null}hitTest(e){return null===this._data||void 0===this._data.points||0===this._data.points.length?null:(0,s.pointInPolygon)(e,this.getPolygonPoints())?this._hitTest:null}doesIntersectWithBox(e){return null!==this._data&&void 0!==this._data.points&&0!==this._data.points.length&&(0,s.pointInBox)(this._data.points[0],e)}measure(){if(null===this._data)return{boxWidth:0,boxHeight:0,width:0,height:0};const e=this._getBoxSize();return{boxWidth:e.boxWidth,boxHeight:e.boxHeight,width:e.textBoxWidth,height:e.textBoxHeight}}rect(){if(null===this._data)return{x:0,y:0,width:0,height:0};const{boxLeft:e,boxTop:t,boxWidth:i,boxHeight:r}=this._getBox();return{x:e,y:t,width:i,height:r}}isOutOfScreen(e,t){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return!0;const{boxLeft:i,boxWidth:n}=this._getBox();if(i+n<0||i>e){const i=(0,r.box)((0,r.point)(0,0),(0,r.point)(e,t));return this.getPolygonPoints().every((e=>!(0,s.pointInBox)(e,i)))}return!1}setPoints(e,t){(0,n.ensureNotNull)(this._data).points=e,this._hitTest=t||new l.HitTestResult(l.HitTarget.MovePoint)}setPoint(e,t,i){const r=(0,n.ensureNotNull)(this._data);this.setData({...r,points:[e],offsetX:t??r.offsetX,offsetY:i??r.offsetY})}point(){return this._data?.points?.[0]??null}fontStyle(e){return null===this._data?"":this._getFontInfo().fontStyle}lineHeight(){return null===this._data?0:I(this._data)}lineSpacing(){return null===this._data?0:A(this._data)}draw(e,t){if(null===this._data||void 0===this._data.points||0===this._data.points.length)return;const{mediaSize:i,horizontalPixelRatio:s,verticalPixelRatio:o}=t;if(this.isOutOfScreen(i.width,i.height))return;const a=this._getInternalData(),l=(0,n.ensureNotNull)(this.rotation()),d=(0,r.point)(l.x*s,l.y*o);e.save(),0!==l.angle&&(e.translate(d.x,d.y),e.rotate(l.angle),e.translate(-d.x,-d.y));const h=this._getFontInfo().fontSize;e.textBaseline=a.textBaseLine,e.textAlign=a.textAlign,e.font=this.fontStyle()
;const{scaledLeft:_,scaledRight:g,scaledTop:p,scaledBottom:m}=function(e,t){const{horizontalPixelRatio:i,verticalPixelRatio:r}=t,n=Math.round(e.boxLeft*i),s=Math.round(e.boxTop*r);return{scaledLeft:n,scaledRight:n+Math.round(e.boxWidth*i),scaledTop:s,scaledBottom:s+Math.round(e.boxHeight*r)}}(a,t),f=this._data.borderWidth||Math.max(h/12,1),v=Math.round(f*s),y=v/2;if(this._data.backgroundColor||this._data.borderColor){let t=!1;if(this._data.boxShadow){e.save();const{shadowColor:i,shadowBlur:r,shadowOffsetX:n=0,shadowOffsetY:a=0}=this._data.boxShadow;e.shadowColor=i,e.shadowBlur=r*s,e.shadowOffsetX=n*s,e.shadowOffsetY=a*o,t=!0}if(this._data.backgroundRoundRect){const{borderColor:i,backgroundColor:r,backgroundRoundRect:n}=this._data;r&&((0,c.drawRoundRect)(e,_,p,g-_,m-p,n*s),e.closePath(),e.fillStyle=r,e.fill(),t&&(e.restore(),t=!1)),i&&((0,c.drawRoundRect)(e,_-y,p-y,g-_+v,m-p+v,n*s+v),e.closePath(),e.strokeStyle=i,e.lineWidth=v,e.stroke(),t&&e.restore())}else{const{borderColor:i,backgroundColor:r}=this._data;r&&(e.fillStyle=r,e.fillRect(_,p,g-_,m-p),t&&(e.restore(),t=!1)),i&&(e.strokeStyle=i,e.lineWidth=v,e.beginPath(),e.moveTo(_-y,p-y),e.lineTo(_-y,m+y),e.lineTo(g+y,m+y),e.lineTo(g+y,p-y),e.lineTo(_-y,p-y),e.closePath(),e.stroke(),t&&e.restore())}}this._drawSelectionIfNeeded(e,t),e.fillStyle=this._data.color;const S=(_+Math.round(a.textHorizStart*s))/s,b=.05*h;let w=(p+Math.round((a.textVertStart+b)*o))/o;const C=A(this._data),T=this.getLinesInfo();for(const t of T.lines)(0,u.drawScaled)(e,s,o,(()=>e.fillText(t.text,S,w))),w+=h+C;if(this._data.decorator?.draw(e,t,this._data,a),this._data.outlineBorder){const{outlineBorder:{width:t,color:i}}=this._data,r=Math.round(t*s),n=this._data.borderColor?v:0,o={x:_-n,y:p-n,w:g-_+2*n,h:m-p+2*n},a=new Path2D;a.rect(o.x-r,o.y-r,o.w+2*r,o.h+2*r),a.rect(o.x,o.y,o.w,o.h),e.fillStyle=i,e.fill(a,"evenodd")}e.restore()}getPolygonPoints(){if(null!==this._polygonPoints)return this._polygonPoints;if(null===this._data)return[];const e=this._data.angle||0,{boxLeft:t,boxTop:i,boxWidth:n,boxHeight:s}=this._getBox(),o=this._getRotationPoint();return this._polygonPoints=[b((0,r.point)(t,i),o,e),b((0,r.point)(t+n,i),o,e),b((0,r.point)(t+n,i+s),o,e),b((0,r.point)(t,i+s),o,e)],this._polygonPoints}centerTextRotation(){if(null===this._centerTextRotationPoint&&null!==this._data){const e=this._data.angle??0,t=this._getRotationPoint(),{textLeft:i,textTop:n,textRight:s,textBottom:o}=this._getInternalData(),a=b((0,r.point)((i+s)/2,(n+o)/2),t,e);this._centerTextRotationPoint={x:a.x,y:a.y,angle:e}}return this._centerTextRotationPoint}rotation(){if(null===this._rotationPoint&&null!==this._data){const e=this._data.angle??0,t=this._getRotationPoint();this._rotationPoint={x:t.x,y:t.y,angle:e}}return this._rotationPoint}getLinesInfo(){if(null===this._linesInfo){const e=(0,n.ensureNotNull)(this._data),t=S(e.text,this.fontStyle(),this._textWidthCache,!1,e.wordWrapWidth);let i=t.filter((e=>!e.hidden));if(void 0!==e.maxHeight){const t=function(e){const t=(0,n.ensureDefined)(e.maxHeight),i=I(e),r=A(e)
;return Math.floor((t+r)/(i+r))}(e);i.length>t&&(i=i.slice(0,t))}this._linesInfo={linesMaxWidth:this._getLinesMaxWidth(i),linesIncludingHidden:t,lines:i}}return this._linesInfo}positionToCoordinate(e){const t=(0,n.ensureNotNull)(this._data),i=this._getInternalData(),r=this.getLinesInfo(),{x:s,y:o,lineNumber:a}=(0,d.getSymbolCoordinatesInfo)({symbolPosition:e,textWidth:i.textRight-i.textLeft,textByLines:r.linesIncludingHidden,lineHeight:I(t),font:this.fontStyle(),textAlign:i.textAlign,lineSpacing:this.lineSpacing()});return{x:s+i.textLeft,y:o+i.textTop,lineNumber:a}}_getInternalData(){if(null!==this._internalData)return this._internalData;const e=(0,n.ensureNotNull)(this._data),{boxLeft:t,boxTop:i,boxWidth:r,boxHeight:s,textBoxWidth:l,textBoxHeight:c}=this._getBox(),d=T(e),h=P(e),u=w(e),_=e.decorator?.geometry(e),g=_?.width??0,p=0===e.text.length?0:_?.decoratorAndTextMargin??0,m=_?.ignoreRtl,f=g+p;let v;const y=i+u+I(e)/2;let S;const b=(0,o.isRtl)(),C=b&&!m,A=C?t+r-h-g:t+d;switch((0,n.ensureDefined)(e.horzTextAlign)){case a.HorizontalAlign.Left:S="start",v=A+f,b&&(e.forceTextAlign?S="left":(v=C?A-p:t+r-h,S="right"));break;case a.HorizontalAlign.Center:S="center";const i=r-d-h-f;v=C?A-p-i/2:A+f+i/2;break;case a.HorizontalAlign.Right:S="end",v=C?A-p:t+r-h,b&&e.forceTextAlign&&(S="right")}return this._internalData={boxLeft:t,boxTop:i,boxWidth:r,boxHeight:s,textBoxWidth:l,textBoxHeight:c,textLeft:t+d+(C?0:f),textRight:t+r-h-(C?f:0),textTop:i+u,textBottom:i+s-u,textHorizStart:v-t,textVertStart:y-i,textAlign:S,textBaseLine:"middle",decoratorLeft:A,decoratorWidth:g},this._internalData}_getFontInfo(){if(null===this._fontInfo){const e=(0,n.ensureNotNull)(this._data),t=I(e),i=`${e.bold?"bold ":""}${e.italic?"italic ":""}${t}px ${e.font}`;this._fontInfo={fontStyle:i,fontSize:t}}return this._fontInfo}_drawSelectionIfNeeded(e,t){const i=(0,n.ensureNotNull)(this._data),r=I((0,n.ensureNotNull)(this._data));if(i.selectionHighlight){const n=this.positionToCoordinate(i.selectionHighlight.start),s=this.positionToCoordinate(i.selectionHighlight.end),o=this._getInternalData();(0,d.drawSelection)(e,t,{lines:this.getLinesInfo().linesIncludingHidden,selectionStart:n,selectionEnd:s,left:o.textLeft,right:o.textRight,color:i.selectionHighlight.color,font:this.fontStyle(),lineHeight:r,lineSpacing:this.lineSpacing()})}}_getLinesMaxWidth(e){const t=this.fontStyle();if(null!==this._data&&this._data.wordWrapWidth&&!this._data.forceCalculateMaxLineWidth)return this._data.wordWrapWidth*D(this._data);let i=0;for(const r of e)i=Math.max(i,(0,u.measureText)(r.text,t,this._textWidthCache).width);return i}_getBoxSize(){if(null===this._boxSize){const e=this.getLinesInfo(),t=(0,n.ensureNotNull)(this._data),i=function(e,t){const i=e.decorator?.geometry(e),r=Math.round(t+T(e)+P(e)+(i?.width??0)+(0===e.text.length?0:i?.decoratorAndTextMargin??0));return r%2?r+1:r}(t,e.linesMaxWidth),r=function(e,t){return I(e)*t+A(e)*(t-1)+2*w(e)}(t,e.lines.length);this._boxSize={textBoxWidth:i,textBoxHeight:r,boxWidth:t.boxWidth??i,boxHeight:t.boxHeight??r}}
return this._boxSize}_getBox(){if(this._box)return this._box;const e=(0,n.ensureNotNull)(this._data),[t]=(0,n.ensureDefined)(e.points),{boxWidth:i,boxHeight:r,textBoxWidth:s,textBoxHeight:o}=this._getBoxSize();let{y:l,x:c}=t;switch(e.vertAlign){case a.VerticalAlign.Bottom:l-=r+e.offsetY;break;case a.VerticalAlign.Middle:l-=r/2;break;case a.VerticalAlign.Top:l+=e.offsetY}switch(e.horzAlign){case a.HorizontalAlign.Left:c+=e.offsetX;break;case a.HorizontalAlign.Center:c-=i/2;break;case a.HorizontalAlign.Right:c-=i+e.offsetX}return this._box={boxLeft:c,boxTop:l,boxWidth:i,boxHeight:r,textBoxWidth:s,textBoxHeight:o}}_getRotationPoint(){const{boxLeft:e,boxTop:t,boxWidth:i,boxHeight:s}=this._getBox(),{horzAlign:o,vertAlign:l}=(0,n.ensureNotNull)(this._data);let c,d;switch(o){case a.HorizontalAlign.Center:c=e+i/2;break;case a.HorizontalAlign.Left:c=e;break;case a.HorizontalAlign.Right:c=e+i}switch(l){case a.VerticalAlign.Middle:d=t+s/2;break;case a.VerticalAlign.Top:d=t;break;case a.VerticalAlign.Bottom:d=t+s}return(0,r.point)(c,d)}}},888386:(e,t,i)=>{"use strict";i.d(t,{PinePerm:()=>l});i(779893);var r=i(803912),n=i(779893);const s="user__username";function o(e){const t=new FormData;return t.append("pine_id",e.pine_id),t.append("username_recip",e.username_recip),e.expiration&&t.append("expiration",e.expiration),t}class a extends Error{constructor(e,t,i){super(e),this.title=i,this.code=t}}var l;!function(e){let t;!function(e){e.UserDoesNotHavePermission="user_does_not_have_permission",e.UserIsBanned="user_is_banned",e.Exists="exists"}(t=e.StatusCode||(e.StatusCode={})),e.add=function(e){return window.is_authenticated?(0,r.fetch)("/pine_perm/add/",{body:o(e),credentials:"include",method:"POST"}).then((e=>e.json().then((t=>{const i=t.status;if("exists"===i)throw new a(i,i);if(!e.ok)throw new a(t.detail,t.code,t.title??void 0)})))):Promise.reject()},e.remove=function(e,t){return window.is_authenticated?n.ajax({data:{pine_id:t,username_recip:e},dataType:"json",type:"POST",url:"/pine_perm/remove/"}):n.Deferred().reject()},e.listUsers=function(e){const{pineId:t,next:i,prev:r,username:o,orderBy:a=s,limit:l=10}=e;return!window.is_authenticated||r&&!i?n.Deferred().reject():n.ajax({data:{pine_id:t,username:o},dataType:"json",type:"POST",url:i||r?`${i}`:`/pine_perm/list_users/?limit=${l}&order_by=${a}`})},e.listScripts=function(){return window.is_authenticated?n.ajax({dataType:"json",type:"POST",url:"/pine_perm/list_scripts/"}):n.Deferred().reject()},e.modifyUserExpiration=function(e){return window.is_authenticated?(0,r.fetch)("/pine_perm/modify_user_expiration/",{body:o(e),credentials:"include",method:"POST"}).then((e=>{if(!e.ok)return e.json().then((e=>{throw Error(e.detail)}))})):Promise.reject()},e.numberOfUsersWithAccess=function(e){return window.is_authenticated?(0,r.fetch)(`/pine_perm/list_users/?pine_id=${e}`,{method:"GET"}).then((e=>e.ok?e.json():e.json().then((e=>{throw new a(e.detail)})))):Promise.reject()}}(l||(l={}))},244097:(e,t,i)=>{"use strict";i.d(t,{replayTimingModeProperty:()=>a});var r=i(62802),n=i(781567)
;const s="replay_timing_mode";function o(){return r.getValue(s,"manual")}const a=(0,n.createPrimitiveProperty)(o());r.onSync.subscribe(null,(()=>a.setValue(o()))),a.subscribe(null,(()=>r.setValue(s,a.value())))},147627:(e,t,i)=>{"use strict";i.d(t,{AlertsWidgetDialog:()=>c});var r=i(62802),n=i(820028),s=i(5481),o=i(372923),a=i(185882),l=i(9880);class c{constructor(e){this._isVisible=new n.WatchedValue(!1),this._activeTab=new n.WatchedValue(function(){const e=r.default.getValue("alerts.widget_dialog.active_tab");return!e||"list"!==e&&"log"!==e?"list":e}()),this._willShow=!1,this._dialogImpl=null,this._getChartWidget=e,this._activeTab.subscribe((e=>{r.default.setValue("alerts.widget_dialog.active_tab",e)}))}setTab(e){this._activeTab.setValue(e)}show(){this._willShow||(this._willShow=!0,Promise.all([Promise.all([i.e(27914),i.e(92537),i.e(98185),i.e(18883),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(46195),i.e(63039),i.e(6612),i.e(11069),i.e(50874),i.e(65743),i.e(20563),i.e(87833),i.e(98158),i.e(38752),i.e(71450),i.e(97540),i.e(25563),i.e(3359),i.e(72232),i.e(63585),i.e(30158),i.e(44213),i.e(30683),i.e(95275),i.e(31538),i.e(42387),i.e(10198),i.e(33609),i.e(39173),i.e(21762),i.e(36828),i.e(56750),i.e(32227),i.e(50030),i.e(87473),i.e(89774),i.e(52768),i.e(52868),i.e(65779),i.e(85847),i.e(33466),i.e(16721),i.e(3758),i.e(61491)]).then(i.bind(i,721578)),(0,a.getWidgetAlertsCollection)(),(0,o.getFiresActions)(),(0,s.getAlertsActionCreators)(),(0,s.getFiresActionCreators)(),(0,l.getAlertsFiresFocusHandler)(),Promise.all([i.e(35706),i.e(50030),i.e(89774),i.e(46670)]).then(i.bind(i,982949)),Promise.all([i.e(94251),i.e(55848)]).then(i.bind(i,222765))]).then((([{AlertsWidgetDialogImpl:e},t,i,r,n,s,{getUnreadFiresBuffer:o},{getAlertSession:a}])=>{this._willShow&&(this._dialogImpl=new e({widgetAlertsCollection:t,firesActions:i,alertsActionCreators:r,firesActionCreators:n,alertsFiresFocusHandler:s,unreadFiresBuffer:o(),onClose:()=>this.hide(),activeTab:this._activeTab,getChartWidget:this._getChartWidget,alertSession:a()}),this._isVisible.setValue(!0))})))}hide(){this._dialogImpl&&(this._dialogImpl.destroy(),this._dialogImpl=null),this._willShow=!1,this._isVisible.setValue(!1)}visible(){return this._isVisible}}},185882:(e,t,i)=>{"use strict";i.d(t,{StudyLineTool:()=>s.StudyLineTool,getWidgetAlertsCollection:()=>o});var r=i(481251),n=i(372923),s=i(204294);const o=(0,r.default)((async()=>{const[{getAlertSession:e},{getAlertsTrackers:t},{getAlertsCollection:r},s,{getWatchlistsStates:o},{FacadeWidgetAlertsCollection:a}]=await Promise.all([Promise.all([i.e(94251),i.e(55848)]).then(i.bind(i,222765)),i.e(95063).then(i.bind(i,951304)),Promise.all([i.e(83477),i.e(83455),i.e(50030),i.e(89774),i.e(52768),i.e(98634),i.e(14141)]).then(i.bind(i,252768)),(0,n.getAlertsActions)(),Promise.all([i.e(35706),i.e(50030),i.e(80372)]).then(i.bind(i,809387)),Promise.all([i.e(83477),i.e(35899),i.e(50030),i.e(89774),i.e(52768),i.e(98634),i.e(62462),i.e(35063)]).then(i.bind(i,5542))]),l=await o(),c=e(),d=t();return new a(s,r(),l,c,d)}))},204294:(e,t,i)=>{
"use strict";var r;i.d(t,{StudyLineTool:()=>r}),function(e){e.LineToolAnchoredVWAP="AnchoredVWAP@tv-basicstudies"}(r||(r={}))},433646:(e,t,i)=>{"use strict";i.d(t,{getNumberOrUndefined:()=>n});var r=i(302094);function n(e){if(function(e){if((0,r.hasNumber)(e))return!0;if("string"==typeof e&&e.length&&!isNaN(Number(e)))return!0;return!1}(e))return Number(e)}},302094:(e,t,i)=>{"use strict";function r(e){return"number"==typeof e&&isFinite(e)}i.d(t,{hasNumber:()=>r})},415821:(e,t,i)=>{"use strict";i.d(t,{defaultCompareSymbols:()=>r});const r=[{symbol:"SPX",title:"S&P 500"},{symbol:"NDX",title:"US 100"},{symbol:"DJI",title:"Dow 30"},{symbol:"NI225",title:"Nikkei 225"},{symbol:"DAX",title:"DAX"},{symbol:"UKX",title:"FTSE 100"}]},673149:(e,t,i)=>{"use strict";function r(){return Promise.all([i.e(11638),i.e(32451),i.e(45702)]).then(i.bind(i,872770))}function n(e){r().then((t=>t.showDisconnectedMessage(e)))}function s(e){r().then((t=>t.showCriticalErrorMessage(e)))}i.d(t,{showCriticalErrorMessage:()=>s,showDisconnectedMessage:()=>n})},967542:(e,t,i)=>{"use strict";function r(){return Promise.all([i.e(97552),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(11069),i.e(65743),i.e(67780),i.e(95679),i.e(14391),i.e(76052),i.e(43329),i.e(38452),i.e(27702),i.e(13485),i.e(79317),i.e(69965),i.e(38490),i.e(59546),i.e(3016),i.e(41392),i.e(63585),i.e(67799),i.e(66534),i.e(94036),i.e(71761),i.e(11194),i.e(26070),i.e(10330),i.e(64935),i.e(75316),i.e(29481),i.e(61360),i.e(66193),i.e(15878),i.e(837),i.e(17637),i.e(32227),i.e(25977),i.e(21202),i.e(13905),i.e(31021),i.e(99431),i.e(44863),i.e(21015)]).then(i.bind(i,304274))}function n(){r().then((e=>e.createIdcAgreementDialog().open()))}function s(e){return r().then((t=>t.createIdcAgreementDelayDialog(e)))}function o(){return r().then((e=>e.createIdcDelayAddServiceDialog()))}i.r(t),i.d(t,{createIdcDelayAddServiceDialog:()=>o,createIdcDelayAgreementDialog:()=>s,showIdcAgreementDialog:()=>n})},464463:(e,t,i)=>{"use strict";i.d(t,{showExchangeAgreementDialog:()=>n});var r=i(388130);async function n(e){void 0===e.isExpert&&(e={...e,isExpert:window.user.declared_status===r.UserStatus.Pro});(await Promise.all([i.e(34039),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(18883),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(11069),i.e(65743),i.e(95679),i.e(14391),i.e(76052),i.e(43329),i.e(27702),i.e(13485),i.e(69965),i.e(38490),i.e(59546),i.e(63585),i.e(94036),i.e(26070),i.e(10330),i.e(75316),i.e(29481),i.e(61360),i.e(66193),i.e(15878),i.e(837),i.e(17637),i.e(32227),i.e(21202),i.e(13905),i.e(31021),i.e(99431),i.e(44863),i.e(61932)]).then(i.bind(i,778507))).openExchangeAgreementDialog(e)}},621710:(e,t,i)=>{"use strict";i.d(t,{StudyMarket:()=>n});var r=i(820028);class n{constructor(e,t){this._visibility=new r.WatchedValue(!1),this._dialogPromise=null,this._dialog=null,this._chartWidgetCollection=e,
this._options=t}visible(){return this._visibility.readonly()}show(e,t,i){const r=Array.isArray(e)?e:[],n=Array.isArray(e)?void 0:e;null===this._dialog&&this._requestDialog(r??[],t,i,n),this._dialog?.open(r??[],this._options?.indicatorsPreloader?.getIndicatorPromises(),t,i,n)}hide(){this._dialog?.hide()}getDialog(){return this._dialog}resetAllPages(){this._dialog?.resetAllStudies()}_requestDialog(e,t,r,n){if(null===this._dialogPromise){let s;s=this._options?.onWidget?Promise.all([i.e(6998),i.e(92537),i.e(98185),i.e(98933),i.e(18883),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(50874),i.e(19190),i.e(87833),i.e(38452),i.e(98158),i.e(84587),i.e(66032),i.e(93240),i.e(97540),i.e(25563),i.e(92990),i.e(72232),i.e(82870),i.e(93015),i.e(82332),i.e(46754),i.e(44535),i.e(85014),i.e(37463),i.e(15377),i.e(28260),i.e(28158),i.e(30509),i.e(74671),i.e(58760),i.e(13203),i.e(76148),i.e(57549),i.e(78522),i.e(39732),i.e(32227),i.e(87473),i.e(93239),i.e(35524),i.e(93390),i.e(7351),i.e(73618),i.e(21320),i.e(40309),i.e(88979),i.e(35168),i.e(88914),i.e(7683),i.e(53652),i.e(31707),i.e(6456)]).then(i.bind(i,847156)).then((e=>new e.IndicatorsLibraryContainer(this._chartWidgetCollection,this._options))):Promise.all([i.e(6998),i.e(92537),i.e(98185),i.e(98933),i.e(18883),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(50874),i.e(19190),i.e(87833),i.e(38452),i.e(98158),i.e(84587),i.e(66032),i.e(93240),i.e(97540),i.e(25563),i.e(92990),i.e(72232),i.e(82870),i.e(93015),i.e(82332),i.e(46754),i.e(44535),i.e(85014),i.e(37463),i.e(15377),i.e(28260),i.e(28158),i.e(30509),i.e(74671),i.e(58760),i.e(13203),i.e(76148),i.e(57549),i.e(78522),i.e(39732),i.e(32227),i.e(87473),i.e(93239),i.e(35524),i.e(93390),i.e(7351),i.e(73618),i.e(21320),i.e(40309),i.e(88979),i.e(35168),i.e(88914),i.e(7683),i.e(53652),i.e(31707),i.e(6456)]).then(i.bind(i,407774)).then((e=>new e.IndicatorsContainerMainChart(this._chartWidgetCollection))),this._dialogPromise=s.then((i=>{this._dialog=i,this._dialog.visible().subscribe((e=>{this._visibility.setValue(e)})),this._dialog.open(e,this._options?.indicatorsPreloader?.getIndicatorPromises(),t,r,n)}))}return this._dialogPromise}}},779372:(e,t,i)=>{"use strict";async function r(e={}){Promise.all([i.e(25253),i.e(92537),i.e(98185),i.e(39759),i.e(18883),i.e(52186),i.e(84712),i.e(15371),i.e(32937),i.e(22956),i.e(46195),i.e(11069),i.e(19190),i.e(95679),i.e(87833),i.e(76052),i.e(38452),i.e(27702),i.e(67131),i.e(59546),i.e(82332),i.e(63585),i.e(94036),i.e(26070),i.e(33595),i.e(75316),i.e(7276),i.e(51989),i.e(29481),i.e(66193),i.e(15878),i.e(67761),i.e(40121),i.e(47093),i.e(91253),i.e(32227),i.e(21872),i.e(87288),i.e(31021),i.e(15199)]).then(i.bind(i,185484)).then((({showUpgradeToProDialog:t})=>t(e)))}i.r(t),i.d(t,{showUpgradeToProDialog:()=>r})},240482:(e,t,i)=>{"use strict";i.d(t,{createNewChart:()=>g,openNewChart:()=>_});var r=i(803912),n=i(656130),s=i(552279),o=i(229534),a=i(503595),l=i(314802),c=i(444372);const d=c.t(null,void 0,i(564697)),h=c.t(null,void 0,i(796225)),u=c.t(null,void 0,i(491547))
;async function _(e={}){const{onSameTab:t,...i}=e,r=t?"_self":"_blank";window.is_authenticated?await(0,a.asyncWindowOpen)(p(i),r):window.open((0,n.generateChartUrl)(i),r)}async function g(e={}){return p(e)}async function p(e){let t,i;try{i=await(0,r.fetch)("/charts/",{method:"POST",body:JSON.stringify(e),credentials:"include"});const n=i.headers.get("location");if(i.ok&&n)return(0,l.urlWithMobileAppParams)(n);t=(await i.json()).code}catch{}"count_limit"===t||"login_required"===t?(0,s.reloginOrGoPro)({feature:"savedChartsLimit"}):i||!1!==navigator.onLine?i&&i.status>=500||"feature_disabled"===t?(0,o.showErrorDialog)({content:h}):(0,o.showErrorDialog)({content:d}):(0,o.showErrorDialog)({content:u})}},991016:(e,t,i)=>{"use strict";i.d(t,{publishChart:()=>n,setPublishChartOptions:()=>s});i(779893);let r;function n(e){const t={...e,...r};return new Promise((e=>{window.runOrSignIn((()=>{e(async function(e){return window.saver.publishChart(e)}(t))}),{source:"Publish chart",sourceMeta:"Chart"})}))}function s(e){r=e}},640646:(e,t,i)=>{"use strict";var r,n=i(779893),{clone:s}=i(536794),o=(r={},{suggest:function(e,t){var i=n.ajax({url:t||"/pubscripts-suggest-json/",type:"GET",data:{search:e},dataType:"json"});return i.done((function(e){if(e&&e.results)for(var t=0;t<e.results.length;t++)r[e.results[t].scriptIdPart]||(r[e.results[t].scriptIdPart]=s(e.results[t]))})),i},info:function(e,t=!1){for(var i=n.Deferred(),o=[],a=[],l=0;l<e.length;l++){var c=e[l];r[c]?o.push(s(r[c])):a.length<3e3&&a.push(c)}if(!a.length)return i.resolve(o).promise();var d={scriptIdPart:a.join(","),show_hidden:t};return n.ajax({url:"/pubscripts-get/",type:"POST",data:d,dataType:"json"}).done((function(e){for(var t in e=e||[]){var n=e[t];r[n.scriptIdPart]=s(n),o.push(n)}i.resolve(o)})).fail((function(){i.reject()})),i},invalidateCache:function(e){e.forEach((function(e){delete r[e]}))},cleanCache:function(){r=[]}});e.exports=o},172745:(e,t,i)=>{"use strict";i.d(t,{ChartSaverBase:()=>v});var r=i(650279),n=i(650151),s=i(444372),o=i(585223),a=i(113610),l=i(175203),c=i(707934),d=i(552279),h=i(547465),u=(i(213377),i(507778)),_=i(779893);function g(e,t){e.content=JSON.stringify(t)}const p=new WeakMap;function m(e){let t=p.get(e);if(void 0===t){const i=JSON.parse(e.content);t=void 0!==i.charts?i.charts.map(JSON.stringify):[e.content],p.set(e,t)}return t}const f=new TextEncoder;class v{constructor(e){this._prevChartState=null,this._chartSavedDelegate=new h.Delegate,this._chartAboutToBeSavedDelegate=new h.Delegate,this._chartSizeLimitExceededDelegate=new h.Delegate,this._isSaveInProcess=!1,this._savingToken=null,this._chartWidgetCollection=e,window.initData&&window.initData.content&&(this._prevChartState={content:JSON.stringify(window.initData.content)})}async saveChartLineTools(e,t,i,r){{const n=await(0,a.getChartStorage)();return(s=>n.saveLineToolsAndGroups(s,e,t,i,r))(this.layoutId())}}layoutId(){return this._chartWidgetCollection.metaInfo.uid.value()}saveChartSilently(e,t,r){const o=r||{};_(window).on("beforeunload.savechart",(()=>s.t(null,void 0,i(533416)))),
this._isSaveInProcess=!0,this._chartAboutToBeSavedDelegate.fire(),this._saveChart((e=>{const t=e&&!0,i=this._getChartWidgetCollectionState(!1,void 0,void 0,void 0,t),r=this._getCommonSavingInfo(!1);return g(r,i),o.chartName&&(r.name=o.chartName),r.name&&0!==r.name.length||!o.defaultChartName||(r.name=o.defaultChartName),o.autoSave&&(r.autoSave=!0),r}),((t,i)=>{(0,n.assert)(!this._chartWidgetCollection.readOnly(),"Trying to save layout in read-only mode"),i&&this.layoutId()===t.uid&&this._chartWidgetCollection.metaInfo.name.setValue(i.name??""),this._prevChartState=i,this._chartSavedDelegate.fire(!0),this._isSaveInProcess=!1,e&&e({uid:t.uid,data:i}),this._prevChartState&&delete this._prevChartState.savingToken}),(e=>{this._chartSavedDelegate.fire(!1),this._isSaveInProcess=!1,t&&t(e)}),o),_(window).off("beforeunload.savechart")}saveToJSON(e){const t=e&&!1===e.includeDrawings||void 0,i=this._getCommonSavingInfo(!1);return g(i,this._getChartWidgetCollectionState(!1,!0,t,void 0,t)),i}isSaveInProcess(){return this._isSaveInProcess}_getChartWidgetCollectionState(e,t,i,r,n){let s=!1;return e?s=!0:(t=!0,r=!1),this._chartWidgetCollection.state({withData:!!e,skipLineToolsFromOtherSymbols:!!i,wipeSensitiveData:!!r,skipLineTools:n,skipHiddenSources:s,addOnlyActiveChart:!t})}_getCommonSavingInfo(e){const t=this._chartWidgetCollection,i=this._chartWidgetCollection.chartsSymbols()[t.activeChartWidget.value().id()],r={...(n=i,{...n,legs:JSON.stringify(n.legs??[])})};var n;const s=t.metaInfo,o=s.id.value();return null!==o&&(r.id=o),r.name=s.name.value()||"",r.description=s.description.value()||"",r.is_realtime=r.is_realtime=e?"0":"1",r}async _saveLineToolsToStorage(){{if(!this.layoutId())throw new Error("Cannot save for new layout");const[e,t]=this._chartWidgetCollection.getAll().reduce(((e,t)=>{const i=t.lineToolsSynchronizer();if(i){e[0]||=i.hasUnsavedMigrationsFromChartState();const t=i.flushPendingSavings();t&&e[1].push(t)}return e}),[!1,[]]);return t.length&&await Promise.all(t),t.length>0&&e}}_invalidateAllLineTools(){this._chartWidgetCollection.getAll().forEach((e=>e.lineToolsSynchronizer()?.invalidateAll()))}_saveChartImpl(e,t,i,r,n,s){let o;this._savingToken=String(Math.random()),e.savingToken=this._savingToken,o=s=>{this._savingToken=null;const o=s.result,a=s.response?.status;if("ok:"===o.substring(0,3)){const r=o.substring(3),n=JSON.parse(r);t.uid||t.uid!==this.layoutId()||(t.id=n.id,t.uid=n.uid,this._chartWidgetCollection.metaInfo.id.setValue(t.id),this._chartWidgetCollection.metaInfo.uid.setValue(t.uid)),t.uid===this.layoutId()&&(t.lastModified=n.lastModified,this._chartWidgetCollection.metaInfo.lastModified.setValue(t.lastModified)),i(t,e)}else if("saved_chart_limit_reached"===o||""===o){if(r({status:a,message:""===o?"Unknown error":"Saved chart limit reached"}),n.noDefaultOnFail)return;(0,c.createGoProDialog)({feature:"savedChartsLimit"})}else r({status:a,message:o}),_("#error").html(o);_(window).off("beforeunload.savechart")},e.name?u.backend.saveChart(e.name,e.short_name,e.resolution,e,t).then(o).catch((async e=>{
const t=e instanceof Response?e:void 0,o=e instanceof Error?e:void 0;this._savingToken=null;const a=r.bind(null,{status:t?.status,message:t?.statusText??o?.message??"Unknown error"});if(t&&413===t.status)return this._chartSizeLimitExceededDelegate.fire(),void a();if(t&&403===t.status){try{"login_required"===(await t.json()).code&&(0,d.reloginOrGoPro)({feature:"savedChartsLimit"})}catch(e){}a()}else n.retry?a():(n.retry=!0,this._saveChart(s,i,r,n))})):r({status:-1,message:"Saving chart with empty name is not allowed"})}async _saveChart(e,t,n,s){const a=this._chartWidgetCollection.metaInfo,c={name:a.name.value(),description:a.description.value(),uid:a.uid.value(),id:a.id.value(),lastModified:a.lastModified.value(),username:a.username.value()};let d=s.changes??o.changedAll;let h=!0;if(2&d)try{await this._saveLineToolsToStorage()&&(d|=1)}catch(e){d|=1;const{SavingLineToolsLibraryError:t}=await Promise.resolve().then(i.bind(i,198303));!1||(h=!1)}if(1&d){const i=e(h);if((0,r.default)(this._prevChartState,i)&&null!==c.id)return this._chartSavedDelegate.fire(!0),void t(c,i);(function(e,t){const i=null===e?[]:m(e),r=m(t);let n=0,s=0;for(let e=0;e<r.length;++e){const t=f.encode(r[e]).length;n+=t,r[e]!==i[e]&&(s+=t)}l.telemetry.sendChartReport("save_layout_changed_to_total_bytes_ratio",{value:s/n})})(this._prevChartState,i);const o=(e,i)=>(h||this._chartWidgetCollection.getAll().forEach((e=>e.lineToolsSynchronizer()?.markAsValidatedBecauseOfSavingToContent())),t(e,i));return this._saveChartImpl(i,c,o,n,s,e)}this._chartSavedDelegate.fire(!0),t(c,e(h))}}},312222:(e,t,i)=>{"use strict";var r=i(779893),n=i(111332),s=i(345848).trackEvent,o=i(776734).getTracker,a=i(640646),l=i(251954),c=i(503595).asyncWindowOpen,d=i(240448),h=i(779923).showWarning,u=i(734489).forceTradingObjVisibilityOnScreenshot,_=i(172745).ChartSaverBase;const g=i.i18next(null,void 0,i(249947));function p(e){return e.returnValue=i.i18next(null,void 0,i(976078)),e.returnValue}t.ChartSaver=class extends _{constructor(e){super(e),this._savingToken=null}chartSizeLimitExceeded(){return this._chartSizeLimitExceededDelegate}chartAboutToBeSaved(){return this._chartAboutToBeSavedDelegate}chartSaved(){return this._chartSavedDelegate}publishChart(e){var t=this;return new Promise((function(r){s("GUI","Publish Chart");var n=t,o={accessType:(e=e||{}).isPrivate||TVSettings.getBool("publishchart.private",!1)?0:1,publishSource:e.publishSource,videoFilename:e.videoFilename,videoDuration:e.videoDuration,videoCam:e.videoCam},a={savePrivacySetting:!e.doNotSavePrivacySetting,onWidget:e.onWidget},l=e.onPublishUrl,c=e.onPublishError
;n._ideaPublisher?r(n._ideaPublisher.openPublication(o,a)):Promise.all([Promise.all([i.e(94727),i.e(41392),i.e(66534),i.e(71761),i.e(11194),i.e(64175),i.e(32227),i.e(25977),i.e(33174),i.e(47332),i.e(44125)]).then(i.bind(i,777483)),Promise.all([i.e(94727),i.e(41392),i.e(66534),i.e(71761),i.e(11194),i.e(64175),i.e(32227),i.e(25977),i.e(33174),i.e(47332),i.e(44125)]).then(i.bind(i,792011)),Promise.all([i.e(94727),i.e(41392),i.e(66534),i.e(71761),i.e(11194),i.e(64175),i.e(32227),i.e(25977),i.e(33174),i.e(47332),i.e(44125)]).then(i.bind(i,788293)),Promise.all([i.e(94727),i.e(41392),i.e(66534),i.e(71761),i.e(11194),i.e(64175),i.e(32227),i.e(25977),i.e(33174),i.e(47332),i.e(44125)]).then(i.bind(i,318596))]).then((([{CategoriesProvider:e},{ChartInfoProvider:t},{IdeasProvider:i},{IdeaPublisher:s}])=>{var d=new t({chartWidgetCollection:n._chartWidgetCollection}),h=new i({publish:function(e,t){return new Promise((function(i,r){var s={closeForm:function(){i()},showError:function(e){r(e)},onPublishUrl:l,onPublishError:c};try{n.onPublish(e,Object.assign({},t,s))}catch(e){r(g)}}))}}),u=new e;n._ideaPublisher=new s({chartInfoProvider:d,ideasProvider:h,categoriesProvider:u,onOpenEditor:function(){},onMinimizeEditor:function(){},onCloseEditor:function(){}}),r(n._ideaPublisher.openPublication(o,a))}))}))}publishScript(e,t,i){var r=this;if(e.accessType=TVSettings.getBool("publishscript.private",!1)?0:1,r._scriptPublisher)r._scriptPublisher.openPublication(e,t);else{var n=i.scriptPublisher,s=i.scriptsProvider,o=i.categoriesProvider,l=new(0,i.chartInfoProvider)({chartWidgetCollection:r._chartWidgetCollection}),c=new s({publish:function(e){return new Promise((function(t,i){var n={closeForm:function(){if(e&&e.scriptPublication&&e.scriptPublication.updateScriptIdPart){var i=e.scriptPublication.updateScriptIdPart;a.invalidateCache([i]),window.studyMarket&&window.studyMarket.resetAllPages()}t()},showError:function(e){i(e)},savePrivacySetting:!0};try{r.onPublish(e,n)}catch(e){i(g)}}))}});r._scriptPublisher=new n({scriptsProvider:c,categoriesProvider:new o,chartInfoProvider:l,scriptType:e.scriptType,scriptTitle:e.title,existingLibraryInfo:e.existingLibraryInfo,originalScriptVersion:t.originalScriptVersion,originalScriptId:t.originalScriptVersion}),r._scriptPublisher.openPublication(e,t)}}isScriptNameValid(e){return""!==e.trim()&&e.length<=64}isScriptDescriptionValid(e){return""!==e.trim()&&e.length<=7e4}isScriptDescribersValid(e,t){return this.isScriptNameValid(e)&&this.isScriptDescriptionValid(t)}openInNewTab(e,t,i){e.publishInProgress=!0,i||this.isScriptDescribersValid(t.name,t.description)&&c(new Promise((function(t){e.setPopupUrl=t})))}onPublish(e,t){{var a=this;if(a.publishInProgress)return;var c=t&&t.publishAllLayout,_=a._getCommonSavingInfo(!0),g=!1;e.scriptPublication&&(e.scriptPublication.scriptProtection===d.Access.ACCESS_CLOSED_NEEDS_AUTH&&(g=!0),_.scriptProtection=parseInt(d.Access.MAP_NAME_TO_ID[e.scriptPublication.scriptProtection])),function(e,t){e.content=JSON.stringify(t)}(_,this._getChartWidgetCollectionState(!0,c,!0,g)),
u.setValue(!1),_.image=JSON.stringify(this._chartWidgetCollection.images({onlyActiveChart:!c})),u.setValue(null);const y=r=>{window.removeEventListener("beforeunload",p),a.publishInProgress=!1;var n=r.responseText||"";if("ok:"===n.substring(0,3)){var s=!1;if(t.savePrivacySetting){s=!e.is_public;TVSettings.setValue(e.scriptPublication?"publishscript.private":"publishchart.private",s)}var o=n.substring(3),c=JSON.parse(o);a._chartWidgetCollection.metaInfo.id.value()||a._chartWidgetCollection.metaInfo.id.setValue(c.id),t.closeForm&&t.closeForm(),t.onPublishUrl&&t.onPublishUrl(c.publishUrl,c.uuid),l.emit("onPublishUrl",c.uuid),a._lastPublishUrl=c.publishUrl,a.setPopupUrl&&a.setPopupUrl(`${c.publishUrl}${s||e.scriptPublication?"":"?social_toast=true"}`)}else{(413===r.status||/^[\d\s]*request.+large/i.test(n.trim()))&&(n=i.i18next(null,void 0,i(524074)));var d=n||i.i18next(null,void 0,i(871028));t.showError&&t.showError(d,{html:!0}),t.onPublishError&&t.onPublishError(d),a.setPopupUrl&&a.setPopupUrl(void 0)}};var m=e.scriptPublication,f=!(!m||!m.updateScriptIdPart),v=new Promise((function(e,t){var r;m?(f?(window.addEventListener("beforeunload",p),r=n.publishNext(m.scriptSource,m.updateScriptIdPart,m.originalScriptId,m.originalScriptVersion)):r=n.publishNew(m.scriptSource,m.scriptProtection,m.originalScriptId,m.originalScriptVersion),r.done((function(t){e(t.publishedstudyscript_id)})).fail((function(e){const{errors:r}=e,n=-1!==r.findIndex((e=>e.message.indexOf("already published library")))?i.i18next(null,void 0,i(266914)):i.i18next(null,void 0,i(759638)),s=r.map((e=>e.message)).join(", ");h({title:n,text:s}),t()}))):e()}));f?v.then((function(i){a.openInNewTab(a,e,t.onWidget);var n={publishedstudyscript_id:i,script_terms:e.script_terms,description:e.description,tags:e.tags,preserve_old_chart:e.preserveOldChart};r.ajax({url:"/script-update/",type:"post",dataType:"text",data:r.extend({},_,n),complete:y})}),y):v.then((function(i){a.openInNewTab(a,e,t.onWidget),i&&(e.publishedstudyscript_id=i);for(var n=e.tags.split(","),l=e.scriptPublication?"Script":"Idea",c=0;c<n.length;c++)s(l+" Publication",l+" Tag",n[c]);if(e.scriptPublication){var d=e.scriptPublication.scriptProtection;s("Script Publication","Script Visibility",{open_no_auth:"Open",closed_no_auth:"Protected",closed_needs_auth:"Invite Only"}[d]),o().then((e=>{e&&e.trackPublicationAction({event_name:"publication_happened",action:"posting_script"})}))}else{var h=e.is_education?"Education":"Analysis",u=e.is_public?"Public":"Private";s("Idea Publication","Idea Type",h),s("Idea Publication","Idea Strategy",["Neutral","Long","Short"][e.direction]),s("Idea Publication","Idea Privacy",u),o().then((e=>{e&&e.trackPublicationAction({event_name:"publication_happened",action:"posting_idea"})}))}r.ajax({url:"/publishchart/",type:"post",dataType:"text",data:r.extend({},_,e),complete:y})}),y)}}}},305141:(e,t,i)=>{"use strict";i.d(t,{setNewBlackColor:()=>r});const r=(0,i(125226).isFeatureEnabled)("set_new_black_color")},981191:(e,t,i)=>{"use strict";i.d(t,{
getDayResolutionTimeFrameOptions:()=>h,getFromForDay:()=>l,getFromForMonthsAgo:()=>o,getFromForYearsAgo:()=>a,getMediumTimeFrameOptions:()=>u,getMiniTimeFrameOptions:()=>d,getStartOfTheYear:()=>c});var r=i(708078),n=i(873146);const s=Date.now();function o(e){const t=new Date(s);return t.setMonth(t.getMonth()-e),Math.trunc(t.valueOf()/1e3)}function a(e){const t=new Date(s);return t.setFullYear(t.getFullYear()-e),Math.trunc(t.valueOf()/1e3)}function l(e){const t=new Date(s);return t.setDate(t.getDate()-e),Math.trunc(t.valueOf()/1e3)}function c(){return Math.trunc((0,r.resetToYearStart)(new Date(s)).valueOf()/1e3)}function d(e){const t=(0,n.getTimeFrames)();return[{...t[e?"lastsession":"1d"]},{...t["1m"],targetResolution:"1D",from:o(1)},{...t["3m"],targetResolution:"1D",from:o(3)},{...t["12m"],from:a(1)},{...t["60m"],targetResolution:"1M",from:a(5)},{...t.all}]}function h(e){const t=(0,n.getTimeFrames)();return[{...t[e?"lastsession":"1d"]},{...t["1m"],targetResolution:"1D",from:o(1)},{...t["3m"],targetResolution:"1D",from:o(3)},{...t["6m"],targetResolution:"1D",from:o(6)},{...t.ytd,targetResolution:"1D",from:o(6)},{...t["12m"],from:a(1)}]}function u(e){const t=(0,n.getTimeFrames)(),i=[];return 1!==e&&i.push({...t.lastsession}),0!==e&&i.push({...t["1d"]}),[...i,{...t["1m"],targetResolution:"60",from:o(1)},{...t["3m"],targetResolution:"120",from:o(3)},{...t["12m"],from:a(1)},{...t["60m"],targetResolution:"1W",from:a(5)},{...t.all}]}},873146:(e,t,i)=>{"use strict";i.d(t,{getTimeFrames:()=>s});var r=i(444372),n=i(737986);function s(e){return{"1d":{text:r.t(null,void 0,i(207075)),value:{value:"1D",type:"period-back"},targetResolution:e?.["1D"]??(0,n.stringAsResolution)("1"),description:(0,n.daysStringLiteral)(1)},"5d":{text:r.t(null,void 0,i(558628)),value:{value:"5D",type:"period-back"},targetResolution:e?.["5D"]??(0,n.stringAsResolution)("5"),description:(0,n.daysStringLiteral)(5)},"1w":{text:r.t(null,void 0,i(189696)),value:{value:"7D",type:"period-back"},targetResolution:e?.["5W"]??(0,n.stringAsResolution)("15"),description:(0,n.weeksStringLiteral)(1)},"1m":{text:r.t(null,void 0,i(333493)),value:{value:"1M",type:"period-back"},targetResolution:e?.["1M"]??(0,n.stringAsResolution)("30"),description:(0,n.monthsStringLiteral)(1)},"3m":{text:r.t(null,void 0,i(318717)),value:{value:"3M",type:"period-back"},targetResolution:e?.["3M"]??(0,n.stringAsResolution)("60"),description:(0,n.monthsStringLiteral)(3)},"6m":{text:r.t(null,void 0,i(869411)),value:{value:"6M",type:"period-back"},targetResolution:e?.["6M"]??(0,n.stringAsResolution)("120"),description:(0,n.monthsStringLiteral)(6)},"12m":{text:r.t(null,void 0,i(186322)),value:{value:"12M",type:"period-back"},targetResolution:e?.["12M"]??(0,n.stringAsResolution)("1D"),description:(0,n.yearsStringLiteral)(1)},"24m":{text:r.t(null,void 0,i(745391)),value:{value:"24M",type:"period-back"},targetResolution:e?.["24M"]??(0,n.stringAsResolution)("1W"),description:(0,n.yearsStringLiteral)(2)},"36m":{text:r.t(null,void 0,i(189992)),value:{value:"36M",type:"period-back"},
targetResolution:e?.["36M"]??(0,n.stringAsResolution)("1W"),description:(0,n.yearsStringLiteral)(3)},"60m":{text:r.t(null,void 0,i(772834)),value:{value:"60M",type:"period-back"},targetResolution:e?.["60M"]??(0,n.stringAsResolution)("1W"),description:(0,n.yearsStringLiteral)(5)},"120m":{text:r.t(null,void 0,i(27969)),value:{value:"120M",type:"period-back"},targetResolution:e?.["120M"]??(0,n.stringAsResolution)("1M"),description:(0,n.yearsStringLiteral)(10)},ytd:{text:r.t(null,void 0,i(168881)),value:{value:"YTD",type:"period-back"},targetResolution:e?.YTD??(0,n.stringAsResolution)("1D"),description:r.t(null,void 0,i(251478))},all:{text:r.t(null,void 0,i(580066)),value:{value:"ALL",type:"period-back"},targetResolution:e?.ALL??(0,n.stringAsResolution)("1M")},lastsession:{text:r.t(null,void 0,i(207075)),value:{value:"LASTSESSION",type:"period-back"},targetResolution:e?.LASTSESSION??(0,n.stringAsResolution)("1"),description:(0,n.daysStringLiteral)(1)}}}},737986:(e,t,i)=>{"use strict";i.d(t,{daysStringLiteral:()=>o,hoursStringLiteral:()=>s,minutesStringLiteral:()=>n,monthsStringLiteral:()=>l,stringAsResolution:()=>d,weeksStringLiteral:()=>a,yearsStringLiteral:()=>c});var r=i(444372);const n=e=>r.t(null,{plural:"{str} minutes",count:e,replace:{str:`${e}`}},i(805926)),s=e=>r.t(null,{plural:"{str} hours",count:e,replace:{str:`${e}`}},i(664963)),o=e=>r.t(null,{plural:"{str} days",count:e,replace:{str:`${e}`}},i(862368)),a=e=>r.t(null,{plural:"{str} weeks",count:e,replace:{str:`${e}`}},i(149306)),l=e=>r.t(null,{plural:"{str} months",count:e,replace:{str:`${e}`}},i(520062)),c=e=>r.t(null,{plural:"{str} years",count:e,replace:{str:`${e}`}},i(791549)),d=e=>e},839054:(e,t,i)=>{"use strict";i.d(t,{resolutionsMap:()=>n});var r=i(737986);const n={[(0,r.stringAsResolution)("1")]:{resolution:(0,r.stringAsResolution)("1"),text:(0,r.minutesStringLiteral)(1)},[(0,r.stringAsResolution)("3")]:{resolution:(0,r.stringAsResolution)("3"),text:(0,r.minutesStringLiteral)(3)},[(0,r.stringAsResolution)("5")]:{resolution:(0,r.stringAsResolution)("5"),text:(0,r.minutesStringLiteral)(5)},[(0,r.stringAsResolution)("15")]:{resolution:(0,r.stringAsResolution)("15"),text:(0,r.minutesStringLiteral)(15)},[(0,r.stringAsResolution)("30")]:{resolution:(0,r.stringAsResolution)("30"),text:(0,r.minutesStringLiteral)(30)},[(0,r.stringAsResolution)("45")]:{resolution:(0,r.stringAsResolution)("45"),text:(0,r.minutesStringLiteral)(45)},[(0,r.stringAsResolution)("60")]:{resolution:(0,r.stringAsResolution)("60"),text:(0,r.hoursStringLiteral)(1)},[(0,r.stringAsResolution)("120")]:{resolution:(0,r.stringAsResolution)("120"),text:(0,r.hoursStringLiteral)(2)},[(0,r.stringAsResolution)("180")]:{resolution:(0,r.stringAsResolution)("180"),text:(0,r.hoursStringLiteral)(3)},[(0,r.stringAsResolution)("240")]:{resolution:(0,r.stringAsResolution)("240"),text:(0,r.hoursStringLiteral)(4)},[(0,r.stringAsResolution)("1D")]:{resolution:(0,r.stringAsResolution)("1D"),text:(0,r.daysStringLiteral)(1)},[(0,r.stringAsResolution)("1W")]:{resolution:(0,r.stringAsResolution)("1W"),text:(0,
r.weeksStringLiteral)(1)},[(0,r.stringAsResolution)("1M")]:{resolution:(0,r.stringAsResolution)("1M"),text:(0,r.monthsStringLiteral)(1)},[(0,r.stringAsResolution)("3M")]:{resolution:(0,r.stringAsResolution)("3M"),text:(0,r.monthsStringLiteral)(3)},[(0,r.stringAsResolution)("6M")]:{resolution:(0,r.stringAsResolution)("6M"),text:(0,r.monthsStringLiteral)(6)},[(0,r.stringAsResolution)("12M")]:{resolution:(0,r.stringAsResolution)("12M"),text:(0,r.yearsStringLiteral)(1)}}},950668:(e,t,i)=>{"use strict";i.d(t,{timeFrames:()=>r});const r=(0,i(873146).getTimeFrames)()},508914:(e,t,i)=>{"use strict";i.d(t,{availableTimeFrames:()=>c});var r=i(650151),n=i(950668),s=i(998886),o=i(981191);const a={8:[n.timeFrames.ytd,n.timeFrames["12m"],n.timeFrames["60m"],n.timeFrames.all],3:[n.timeFrames["1d"],n.timeFrames["5d"],n.timeFrames["1m"],n.timeFrames["3m"],n.timeFrames["6m"],n.timeFrames.ytd,n.timeFrames["12m"],n.timeFrames["60m"],n.timeFrames.all]},l=new Map([["1D",(0,o.getFromForDay)(1)],["5D",(0,o.getFromForDay)(5)],["7D",(0,o.getFromForDay)(7)],["1M",(0,o.getFromForMonthsAgo)(1)],["3M",(0,o.getFromForMonthsAgo)(3)],["6M",(0,o.getFromForMonthsAgo)(6)],["12M",(0,o.getFromForYearsAgo)(1)],["24M",(0,o.getFromForYearsAgo)(2)],["36M",(0,o.getFromForYearsAgo)(3)],["60M",(0,o.getFromForYearsAgo)(5)],["YTD",(0,o.getStartOfTheYear)()],["LASTSESSION",(0,o.getFromForDay)(1)],["ALL",-1/0]]);function c(e,t,i=-1/0){let o;null!==e?o=(a[3]||[]).filter((t=>null===(0,s.getResolutionUnsupportedReason)(e,t.targetResolution))):(9===t&&(t=3),6===t&&(t=8),o=a[t]||[]);const c=[];for(let e=0;e<o.length;e++){const t=o[e];if(c.push(t),(0,r.ensureDefined)(l.get(t.value.value))<i)break}return c.length&&"ALL"!==c[c.length-1].value.value&&(c[c.length-1]={...c[c.length-1],text:n.timeFrames.all.text,value:{...c[c.length-1].value,value:n.timeFrames.all.value.value}}),c}},381909:(e,t,i)=>{"use strict";function r(e){return e.charAt(0).toUpperCase()+e.substring(1)}i.d(t,{capitalizeFirstLetter:()=>r})},384898:e=>{"use strict"
;e.exports=JSON.parse('{"ebitda":43000553610,"gross_profit":43000553611,"total_revenue":43000553619,"cost_of_goods":43000553618,"dep_amort_exp_income_s":43000563477,"cost_of_goods_excl_dep_amort":43000563478,"operating_expenses":43000563463,"sell_gen_admin_exp_total":43000553613,"sell_gen_admin_exp_other":43000553614,"research_and_dev":43000553612,"other_oper_expense_total":43000563483,"total_oper_expense":43000553615,"earnings_per_share_diluted":43000553616,"net_income":43000553617,"oper_income":43000563464,"total_non_oper_income":43000563465,"non_oper_interest_exp":43000563466,"interest_expense_on_debt":43000563467,"interest_capitalized":43000563468,"non_oper_income":43000563471,"non_oper_interest_income":43000563473,"pretax_equity_in_earnings":43000563474,"other_income":43000563479,"unusual_expense_inc":43000563476,"pretax_income":43000563462,"equity_in_earnings":43000563487,"income_tax":43000563492,"minority_interest_exp":43000563495,"after_tax_other_income":43000563497,"net_income_bef_disc_oper":43000563500,"discontinued_operations":43000563502,"dilution_adjustment":43000563504,"preferred_dividends":43000563506,"diluted_net_income":43000563516,"earnings_per_share_basic":43000563520,"total_liabilities_shrhldrs_equity":43000553626,"total_debt":43000553622,"total_assets":43000553623,"total_current_assets":43000557441,"cash_n_short_term_invest":43000563702,"cash_n_equivalents":43000563709,"short_term_invest":43000563716,"total_receivables_net":43000563738,"accounts_receivables_net":43000563740,"other_receivables":43000563741,"inventory_work_in_progress":43000563746,"inventory_progress_payments":43000563748,"inventory_finished_goods":43000563749,"inventory_raw_materials":43000563753,"prepaid_expenses":43000563757,"other_current_assets_total":43000563761,"total_non_current_assets":43000557440,"long_term_investments":43000563639,"long_term_note_receivable":43000563641,"investments_in_unconcsolidate":43000563645,"other_investments":43000563649,"ppe_total_net":43000563657,"ppe_total_gross":43000563667,"accum_deprec_total":43000563673,"deferred_tax_assests":43000563683,"intangibles_net":43000563686,"goodwill":43000563688,"other_intangibles_net":43000563689,"long_term_other_assets_total":43000563693,"total_liabilities":43000553624,"total_current_liabilities":43000557437,"short_term_debt":43000563554,"current_port_debt_capital_leases":43000563557,"short_term_debt_excl_current_port":43000563563,"notes_payable_short_term_debt":43000563600,"other_short_term_debt":43000563614,"accounts_payable":43000563619,"income_tax_payable":43000563621,"dividends_payable":43000563624,"accrued_payroll":43000563628,"deferred_income_current":43000563631,"other_current_liabilities":43000563635,"total_non_current_liabilities":43000557436,"long_term_debt":43000553621,"long_term_debt_excl_capital_lease":43000563521,"capital_operating_lease_obligations":43000563522,"capital_lease_obligations":43000563527,"operating_lease_liabilities":43000563532,"provision_f_risks":43000563535,"deferred_tax_liabilities":43000563536,"deferred_income_non_current":43000563540,"other_liabilities_total":43000563545,"total_equity":43000553625,"shrhldrs_equity":43000557442,"common_equity_total":43000563866,"retained_earnings":43000563867,"paid_in_capital":43000563871,"common_stock_par":43000563873,"additional_paid_in_capital":43000563874,"treasury_stock_common":43000563875,"other_common_equity":43000563877,"preferred_stock_carrying_value":43000563879,"minority_interest":43000563884,"free_cash_flow":43000553630,"cash_f_operating_activities":43000553627,"funds_f_operations":43000563886,"net_income_starting_line":43000563888,"cash_flow_deprecation_n_amortization":43000563892,"depreciation_depletion":43000564142,"amortization":43000564143,"cash_flow_deferred_taxes":43000564144,"non_cash_items":43000564146,"total_extra_items":43000564145,"changes_in_working_capital":43000564147,"change_in_accounts_receivable":43000564148,"change_in_taxes_payable":43000564149,"change_in_accounts_payable":43000564150,"change_in_accrued_expenses":43000564151,"change_in_inventories":43000564153,"change_in_other_assets":43000564154,"cash_f_investing_activities":43000553628,"purchase_sale_business":43000564156,"sales_of_business":43000564158,"purchase_of_business":43000564159,"purchase_sale_investments":43000564160,"sales_of_investments":43000564161,"purchase_of_investments":43000564162,"other_investing_cash_flow_items_total":43000564163,"other_investing_cash_flow_sources":43000564164,"other_investing_cash_flow_uses":43000564165,"capital_expenditures":43000564166,"capital_expenditures_fixed_assets":43000564167,"capital_expenditures_other_assets":43000564168,"cash_f_financing_activities":43000553629,"issuance_of_stock_net":43000564169,"sale_of_stock":43000564170,"purchase_of_stock":43000564171,"issuance_of_debt_net":43000564172,"issuance_of_short_term_debt":43000564173,"issuance_of_long_term_debt":43000564175,"supplying_of_long_term_debt":43000564176,"reduction_of_long_term_debt":43000564177,"issuance_of_other_debt":43000564178,"other_financing_cash_flow_items_total":43000564179,"other_financing_cash_flow_sources":43000564181,"other_financing_cash_flow_uses":43000564182,"total_cash_dividends_paid":43000564183,"common_dividends_cash_flow":43000564185,"preferred_dividends_cash_flow":43000564186,"market_cap_basic":43000597015,"number_of_employees":43000597080,"dividends_yield":43000597817,"dividend_payout_ratio":43000597738,"price_earnings":43000597017,"price_sales":43000597019,"price_cash_flow":43000597816,"price_book":43000597016,"enterprise_value":43000597077,"enterprise_value_ebitda":43000597064,"ev_ebit":43000597063,"ev_revenue":43000597065,"price_to_free_cash_flow":43000597814,"price_to_tangible_book":43000597815,"price_earnings_forward":43000597831,"price_sales_forward":43000597832,"return_on_assets":43000597054,"return_on_equity":43000597021,"return_on_invested_capital":43000597056,"gross_margin":43000597811,"operating_margin":43000597076,"ebitda_margin":43000597075,"net_margin":43000597074,"return_on_equity_adjust_to_book":43000597055,"return_on_tang_assets":43000597052,"return_on_tang_equity":43000597053,"free_cash_flow_margin":43000597813,"quick_ratio":43000597050,"current_ratio":43000597051,"invent_turnover":43000597046,"asset_turnover":43000597022,"debt_to_asset":43000597031,"debt_to_equity":43000597078,"long_term_debt_to_assets":43000597048,"debt_to_ebitda":43000597032,"debt_to_revenue":43000597033,"effective_interest_rate_on_debt":43000597034,"equity_to_asset":43000597035,"goodwill_to_asset":43000597036,"interst_cover":43000597037,"invent_to_revenue":43000597047,"share_buyback_ratio":43000597057,"sloan_ratio":43000597058,"earnings_estimate":43000597066,"sales_estimates":43000597067,"revenue_one_year_growth":43000597068,"earnings_per_share_basic_one_year_growth":43000597069,"earnings_per_share_diluted_one_year_growth":43000597071,"accruals_ratio":43000597073,"tangible_common_equity_ratio":43000597079,"revenue_per_employee":43000597081,"net_income_per_employee":43000597082,"graham_numbers":43000597084,"ncavps_ratio":43000597085,"quality_ratio":43000597086,"gross_profit_to_asset":43000597087,"buyback_yield":43000597088,"cash_conversion_cycle":43000597089,"peg_ratio":43000597090,"altman_z_score":43000597092,"piotroski_f_score":43000597734,"sustainable_growth_rate":43000597736,"research_and_develop_to_revenue":43000597739,"earnings_yield":43000597010,"tobin_q_ratio":43000597834,"beneish_m_score":43000597835,"kz_index":43000597844,"fulmer_h_factor":43000597847,"springate_score":43000597848,"zmijewski_score":43000597850,"cash_to_debt":43000597023,"cogs_to_revenue":43000597026,"days_invent":43000597028,"days_pay":43000597029,"day_sales_out":43000597030,"price_free_cash_flow":43000597814,"price_tangible_book":43000597815,"book_value_per_share":43000670330,"book_tangible_per_share":43000597072,"return_on_common_equity":43000656797,"ebit":43000670329,"total_shares_outstanding":43000670331,"float_shares_outstanding":43000670341,"dps_common_stock_prim_issue":43000670334,"basic_shares_outstanding":43000670320,"diluted_shares_outstanding":43000670322,"total_inventory":43000563745,"net_debt":43000665310}')
}}]);