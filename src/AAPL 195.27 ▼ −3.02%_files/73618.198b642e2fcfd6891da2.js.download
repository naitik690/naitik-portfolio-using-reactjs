"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[73618],{850117:(e,t,i)=>{i.d(t,{CircularCacheBuffer:()=>s});var a=i(650151);function n(e){const{prevItem:t,nextItem:i}=e;null!==t&&(t.nextItem=i),null!==i&&(i.prevItem=t)}class s{constructor(e=0,t=1.3){this._cache=new Map,this._lastItem=null,this._firstItem=null,this._size=e,this._sizeLimited=e>0,this._capacityFactor=t}set(e,t){const i={key:e,value:t,prevItem:this._lastItem,nextItem:null};null!==this._lastItem&&(this._lastItem.nextItem=i);const a=this._cache.get(e);return void 0!==a&&(n(a),a===this._firstItem&&(this._firstItem=a.nextItem)),this._cache.set(e,i),this._lastItem=i,null===this._firstItem&&(this._firstItem=i),this._sizeLimited&&this._cache.size>this._size*this._capacityFactor&&this._removeExtraItems(),this}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);if(void 0===t)return t;if(t===this._firstItem&&(this._firstItem=t.nextItem??t),t!==this._lastItem){n(t);const e=(0,a.ensureNotNull)(this._lastItem);e.nextItem=t,t.prevItem=e,t.nextItem=null,this._lastItem=t}return t.value}clear(){this._cache.clear(),this._firstItem=null,this._lastItem=null}delete(e){const t=this._cache.get(e);return void 0!==t&&(n(t),t===this._lastItem&&(this._lastItem=t.prevItem),t===this._firstItem&&(this._firstItem=t.nextItem)),this._cache.delete(e)}*entries(){if(null!==this._firstItem)for(let e=this._firstItem;null!==e;e=e.nextItem)yield[e.key,e.value]}state(){const e=[];for(const[t,i]of this.entries())e.push([t,i]);return e}restoreState(e){for(const t of e)this.set(t[0],t[1])}_removeExtraItems(){const e=this._cache.size-this._size;let t=(0,a.ensureNotNull)(this._firstItem);for(let i=0;i<e;i+=1)this._cache.delete(t.key),t=(0,a.ensureNotNull)(t.nextItem);t.prevItem=null,this._firstItem=t}}},688857:(e,t,i)=>{i.d(t,{addExclusionArea:()=>b,addExclusionAreaByScope:()=>T,calcTextHorizontalShift:()=>x,clearRect:()=>m,createBoundCanvas:()=>_,createDisconnectedCanvas:()=>g,createDisconnectedCanvasByRenderingInfo:()=>v,disableSelection:()=>D,drawScaled:()=>p,drawWithExclusionAreaByScope:()=>P,fillRect:()=>f,getBindingRenderingInfo:()=>h,getContext2D:()=>c,getPrescaledContext2D:()=>d,measureText:()=>S,tryApplySuggestedCanvasBitmapSize:()=>w});var a=i(327714),n=i(650151),s=i(9525),r=i(960433),o=i(969680),l=i(638456);function u(e){return{horizontalPixelRatio:Math.max(1,e.bitmapSize.width/e.canvasElementClientSize.width),verticalPixelRatio:Math.max(1,e.bitmapSize.height/e.canvasElementClientSize.height)}}function h(e){return{...u(e),bitmapSize:e.bitmapSize,mediaSize:e.canvasElementClientSize}}function c(e){const t=(0,n.ensureNotNull)(e.getContext("2d"));return t.setTransform(1,0,0,1,0,0),t}function d(e){const t=(0,n.ensureNotNull)(e.getContext("2d")),i=(0,s.getCanvasDevicePixelRatio)(e);return t.setTransform(i,0,0,i,0,0),t}function f(e,t,i,a,n,s){e.save(),e.fillStyle=s,e.fillRect(t,i,a,n),e.restore()}function m(e,t,i,a,n,s){e.save(),e.globalCompositeOperation="copy",e.fillStyle=s,e.fillRect(t,i,a,n),e.restore()}function p(e,t,i,a){e.save(),
e.scale(t,i),a(),e.restore()}function g(e,t,i){const a=y(e);return void 0===i&&(i=(0,s.getCanvasDevicePixelRatio)(a)),a.width=t.width*i,a.height=t.height*i,a}function v(e,t){const{bitmapSize:i,mediaSize:a}=t,n=y(e);return n.style.width=`${a.width}px`,n.style.height=`${a.height}px`,n.width=i.width,n.height=i.height,n}function y(e){const t=e.createElement("canvas");return D(t),t}function _(e,t){const i=y((0,n.ensureNotNull)(e.ownerDocument));e.appendChild(i);const s=(0,a.bindCanvasElementBitmapSizeTo)(i,{type:"device-pixel-content-box",transform:(e,t)=>0===e.width||0===e.height?e:{width:Math.max(e.width,t.width),height:Math.max(e.height,t.height)}});return s.resizeCanvasElement(t),s}function w(e){const t=e.suggestedBitmapSize;return null!==t&&t.width>0&&t.height>0&&(e.applySuggestedBitmapSize(),!0)}function x(e,t){return"center"===e.textAlign?0:(0,o.isRtl)()?"start"===e.textAlign||"right"===e.textAlign?t:0:"start"===e.textAlign||"left"===e.textAlign?0:t}function D(e){e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.msUserSelect="none",e.style.MozUserSelect="none",e.style.webkitTapHighlightColor="transparent"}function T(e,t){const{context:i,horizontalPixelRatio:a,verticalPixelRatio:n,bitmapSize:s}=e;i.beginPath(),i.rect(0,0,s.width,s.height);for(let e=0;e<t.length;e++){let{x:s,y:r}=t[e];s*=a,r*=n,0!==e?i.lineTo(s,r):i.moveTo(s,r)}i.closePath(),i.clip("evenodd")}function b(e,t,i){T({context:e,...t},i)}function P(e,t,i){e.context.save(),T(e,t),i(),e.context.restore()}let M;function S(e,t,i){return M||function(){const e=document.createElement("canvas");e.width=0,e.height=0,(0,l.isMac)()&&(e.style.display="none",document.body.append(e)),M=(0,n.ensureNotNull)(e.getContext("2d")),M.textBaseline="alphabetic",M.textAlign="center"}(),t&&M.font!==t&&(M.font=t),i?i.getMetrics(M,e):(0,r.getMinTextMetrics)(M.measureText(e))}},9525:(e,t,i)=>{function a(e){return Math.max(1,e.ownerDocument?.defaultView?.devicePixelRatio||1)}i.d(t,{getCanvasDevicePixelRatio:()=>a})},822961:(e,t,i)=>{i.d(t,{lastMouseOrTouchEventInfo:()=>n,setLastMouseOrTouchEventInfo:()=>s});let a=(0,i(638456).supportTouch)()?{isTouch:!0,stylus:!1}:{isTouch:!1};function n(){return a}function s(e){a=e.isTouch?{isTouch:!0,stylus:e.stylus}:{isTouch:!1}}},312692:(e,t,i)=>{i.d(t,{DefaultProperty:()=>q,allowSavingDefaults:()=>A,cleanUpStateKeys:()=>k,createDefaultsState:()=>L,extractAllPropertiesKeys:()=>B,extractState:()=>N,extractThemedColors:()=>F});var a=i(154834),n=i(998034),s=i(936714),r=i(954029),o=i(219780),l=i(111832),u=i(650279),h=i(715943),c=i(182433),d=i(283873),f=i(650151),m=i(724377),p=i(735566);function g(e){return e<0&&(e+=2*Math.PI),e}const v=[127,127,127];function y(e){const t=e[3],i=e.slice(0,3);for(let e=0;e<3;e++)i[e]=Math.round(i[e]*t+v[e]*(1-t));return i}function _(e,t){const i=function(e,t){
const[i,a,n]=e,[s,r,o]=t,l=(Math.sqrt(a**2+n**2)+Math.sqrt(r**2+o**2))/2,u=.5*(1-Math.sqrt(Math.pow(l,7)/(Math.pow(l,7)+6103515625))),h=(1+u)*a,c=(1+u)*r,d=Math.sqrt(h*h+n*n),f=Math.sqrt(c*c+o*o),m=0===n&&0===h?0:g(Math.atan2(n,h)),p=0===o&&0===c?0:g(Math.atan2(o,c)),v=s-i,y=f-d;let _;const w=d*f;0===w?_=0:(_=p-m,_<-Math.PI?_+=2*Math.PI:_>Math.PI&&(_-=2*Math.PI));const x=2*Math.sqrt(w)*Math.sin(_/2),D=(i+s)/2,T=(d+f)/2;let b;const P=m+p;b=d*f==0?P:Math.abs(m-p)<=Math.PI?P/2:P<2*Math.PI?(P+2*Math.PI)/2:(P-2*Math.PI)/2;const M=1-.17*Math.cos(b-Math.PI/6)+.24*Math.cos(2*b)+.32*Math.cos(3*b+Math.PI/30)-.2*Math.cos(4*b-Math.PI/180*63),S=Math.PI/6*Math.exp(-Math.pow((b-Math.PI/180*275)/(Math.PI/180*25),2)),I=2*Math.sqrt(Math.pow(T,7)/(Math.pow(T,7)+6103515625)),R=1+.015*Math.pow(D-50,2)/Math.sqrt(20+Math.pow(D-50,2)),C=1+.045*T,k=1+.015*T*M,L=-Math.sin(2*S)*I;return Math.sqrt(Math.pow(v/(1*R),2)+Math.pow(y/(1*C),2)+Math.pow(x/(1*k),2)+L*(y/(1*C))*(x/(1*k)))}(x(w(y((0,m.parseRgba)(e)))),x(w(y((0,m.parseRgba)(t)))));return i<3}function w(e){const[t,i,a]=e,n=t/255,s=i/255,r=a/255,o=100*(n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92),l=100*(s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92),u=100*(r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92);return[.4124*o+.3576*l+.1805*u,.2126*o+.7152*l+.0722*u,.0193*o+.1192*l+.9505*u]}function x(e){const[t,i,a]=e,n=t/95.047,s=i/100,r=a/108.883,o=n>.008856?Math.pow(n,1/3):7.787*n+16/116,l=s>.008856?Math.pow(s,1/3):7.787*s+16/116;return[116*l-16,500*(o-l),200*(l-(r>.008856?Math.pow(r,1/3):7.787*r+16/116))]}var D=i(61499),T=i(909740),b=i(308721),P=i(547465),M=i(690370),S=i(85858),I=i(905520);const R=(0,p.getLogger)("ThemedDefaults");function C(e){return e.value()===D.StdTheme.Dark?D.StdTheme.Dark:D.StdTheme.Light}function k(e,t,i){for(const a of t)if((0,s.default)(e,a),i){const t=a.split(".");for(t.pop();t.length;){const i=(0,r.default)(e,t);if(!(0,c.default)(i)||0!==Object.keys(i).length)break;(0,s.default)(e,t),t.pop()}}}function L(e,t,i,s){const r=e?S.defaults:S.factoryDefaults,o=t.startsWith("study_")?(0,a.default)(r("study")):{};let l=(0,a.default)(r(t,s));return t.startsWith("study_")&&l.inputs&&delete l.inputs.symbol,"linetoolicon"===t&&e&&(l.icon=(0,S.defaults)(t).icon),"linetooemoji"===t&&e&&(l.emoji=(0,S.defaults)(t).emoji),"linetoolsticker"===t&&e&&(l.sticker=(0,S.defaults)(t).sticker),l=(0,a.default)(l),k(l,i),(0,n.default)(o,l),o}let V=!1;function A(e){V=e}function B(e){const t=Object.keys(e),i=[];return t.forEach((t=>{const a=e[t];if((0,c.default)(a)){B(a).forEach((e=>i.push(`${t}.${e}`)))}else i.push(t)})),i}function K(e,t,i=""){if(1===t.length&&"*"===t[0])return e;const a={};for(const n of t){const s=n.split("."),r=s[0],o=e[r],l=""===i?r:`${i}.${r}`;if(e.hasOwnProperty(r))if(s.length>1){if(!(0,c.default)(o)){R.logError(`path ${l} must be an object, but it is a primitive`);continue}{const e=t.filter((e=>e.startsWith(`${r}.`))).map((e=>e.split(".").slice(1).join(".")));a[r]=K(o,e,l)}}else{if((0,c.default)(o)){R.logError(`path ${l} must be a primitive, but it is an object`);continue}
a[r]=o}}return a}function N(e,t,i){if(!e)return{};let a=e;return t&&(a=K(e,t)),i&&k(a,i,!0),a}function F(e,t){const i=B(e),a=[];for(const n of i){const i=(0,r.default)(e,n),s=(0,r.default)(t,n);(0,f.assert)(void 0!==i,`Light theme value for ${n} is undefined`),(0,f.assert)(void 0!==s,`Dark theme value for ${n} is undefined`),a.push({path:n,colors:[i,s]})}return a}function E(e,t){e.includes(t)||e.push(t)}function O(e,t){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}function z(e,t){const i=(0,l.default)(e,((e,i,a)=>{if(void 0===t[a])return e;if(!(0,u.default)(i,t[a]))if((0,c.default)(i)&&(0,c.default)(t[a])){const n=z(i,t[a]);void 0!==n&&(e[a]=n)}else e[a]=i;return e}),{});return(0,h.default)(i)?void 0:i}function W(e){return e===D.StdTheme.Dark?1:0}function H(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(!(0,d.default)(e)||!(0,d.default)(t))return!1;const i=(0,m.tryParseRgba)(e),a=(0,m.tryParseRgba)(t);return!(!i||!a)&&!!_(e,t)}class q extends I.Property{constructor(e){const{defaultName:t,nonThemedDefaultsKeys:i,themedDefaultsKeys:a,excludedDefaultsKeys:s=[],themedColors:r,replaceThemedColorsOnThemeChange:o=!1,allStateKeys:l,excludedStateKeys:u=[],excludedTemplateKeys:h=[],state:c,useUserPreferences:d=!0,saveNonDefaultUserPreferencesOnly:m=!1,ignoreAllowSavingDefaults:p=!1,alwaysSaveDefaultKeys:g=["version"],saveDefaultsConsumer:v=S.saveDefaults,factoryDefaultsSupplier:y=()=>L(!1,t,[],null),schema:_=(0,M.createPropertySchema)(y()),theme:w=T.watchedTheme.spawnOwnership()}=e;super(void 0,_),this._themedColors=[],this._restoreFactoryDefaultsEvent=new P.Delegate,this._replaceThemedColorsOnThemeChange=!1,this._forbidSavingDefaults=!1,this._defaultName=t,this._useUserPreferences=d,this._saveNonDefaultUserPreferencesOnly=m,this._ignoreAllowSavingDefaults=p,this._saveDefaultsConsumer=v,this._factoryDefaultsSupplier=y,this._allStateKeys=l,this._excludedStateKeys=u,this._nonThemedDefaultsKeys=i,this._themedDefaultsKeys=a,this._allDefaultsKeys=i||a?[...i??[],...a??[]]:void 0,this._excludedDefaultsKeys=s,this._excludedTemplateKeys=h,this._themedColors=r,this._alwaysSaveDefaultKeys=g,(0,f.assert)(void 0===this._allDefaultsKeys||0===this._excludedDefaultsKeys.length,"Defaults keys and excluded defaults keys cannot be used at the same time"),(0,f.assert)(void 0===this._allStateKeys||0===this._excludedStateKeys.length,"State keys and excluded state keys cannot be used at the same time"),this._theme=w;const x=C(this._theme);this.merge((0,n.default)(this._factoryDefaultsForTheme((0,b.isStdThemeName)(x)?x:D.StdTheme.Light),this._userSettings(),N(c,l,u))),r&&o&&this.setThemedColors(r),this._restoreFactoryDefaultsEvent=new P.Delegate}destroy(){this._theme?.release(),this._unsubscribeWatchedTheme?.(),super.destroy()}applyTemplate(e,t){this.mergeAndFire(N((0,n.default)((0,a.default)(t),e),this._allStateKeys,this._excludedTemplateKeys))}preferences(){return N(this.state(this._excludedDefaultsKeys),this._allDefaultsKeys)}template(){return N(this.state(void 0,4),void 0,this._excludedTemplateKeys)}mergePreferences(e){
this.mergeAndFire(N(e,this._allDefaultsKeys,this._excludedDefaultsKeys))}addExcludedKey(e,t){1&t&&E(this._excludedDefaultsKeys,e),2&t&&E(this._excludedStateKeys,e),4&t&&E(this._excludedTemplateKeys,e)}removeExcludedKey(e,t){1&t&&O(this._excludedDefaultsKeys,e),2&t&&O(this._excludedStateKeys,e)}restoreFactoryDefaults(){const e=this.factoryDefaults();k(e,this._excludedDefaultsKeys),this.mergeAndFire(e),this._defaultName.startsWith("study_")&&!this._defaultName.startsWith("study_VbPFixed")||this.saveDefaults(),this._restoreFactoryDefaultsEvent.fire()}onRestoreFactoryDefaults(){return this._restoreFactoryDefaultsEvent}saveDefaults(){if(!this._useUserPreferences||this._forbidSavingDefaults)return;let e;if(this._saveNonDefaultUserPreferencesOnly){const t=this.state(this._excludedDefaultsKeys),i=this.factoryDefaults();if(e=z(N(t,this._nonThemedDefaultsKeys),N(i,this._nonThemedDefaultsKeys,this._excludedDefaultsKeys)),this._alwaysSaveDefaultKeys.length){const i=N(t,this._alwaysSaveDefaultKeys);e=e??{},(0,n.default)(e,i)}const a=this.themeDefaults(C(this._theme)),s=this.themeState(),r=z(s,a);(0,h.default)(r)||(e=e??{},(0,n.default)(e,s))}else e=this.preferences();this._saveDefaultsConsumer(this._defaultName,e)}themeDefaults(e){if(this._themedColors)return function(e,t){const i={};for(const{path:a,colors:n}of e)(0,o.default)(i,a,n[W(t)]);return i}(this._themedColors,e===D.StdTheme.Dark?D.StdTheme.Dark:D.StdTheme.Light);return N(this._factoryDefaultsSupplier(),this._themedDefaultsKeys,this._excludedDefaultsKeys)}factoryDefaults(){return this._factoryDefaultsForTheme(C(this._theme))}themeState(){const e=super.state(this._excludedDefaultsKeys),t=this._themedColors;return N(e,t?t.map((e=>e.path)):this._themedDefaultsKeys)}allThemePropertiesAreDefault(e){(0,f.assert)(!!this._themedColors,"This method should not be called if themed colors are not set");return function(e,t,i=[]){for(const a of i){const i=a.path;if(!H((0,r.default)(e,i),(0,r.default)(t,i)))return!1}return!0}(this.themeState(),this.themeDefaults(e),this._themedColors)}clone(e){return new q(this._options())}setThemedColors(e){if(this._themedColors=e,void 0===this._unsubscribeWatchedTheme){const e=()=>{this._updateThemedColors(!1)};this._theme.subscribe(e),this._unsubscribeWatchedTheme=()=>this._theme.unsubscribe(e)}this._updateThemedColors(!0)}applyDefaultThemedProperties(e){this._themedColors&&this.mergeAndFire(this.themeDefaults(e))}state(e,t){return N(super.state([...this._excludedStateKeys,...e??[]],t),this._allStateKeys)}_updateThemedColors(e){if(!this._themedColors)return;const t=C(this._theme),i=t===D.StdTheme.Light?D.StdTheme.Dark:D.StdTheme.Light;for(const a of this._themedColors){const n=(0,f.ensureDefined)(this.childByPath(a.path)),s=a.colors[W(i)];(""===n.value()||!e&&H(n.value(),s))&&n.setValue(a.colors[W(t)])}}_userSettings(){if(!this._useUserPreferences)return;const e=L(!0,this._defaultName,[],null);if(!e)return;return N((0,M.extractStateWithSchema)(e,this._schema,1),this._allDefaultsKeys,this._excludedDefaultsKeys)}_options(){return{
defaultName:this._defaultName,factoryDefaultsSupplier:this._factoryDefaultsSupplier,state:this.state(),nonThemedDefaultsKeys:this._nonThemedDefaultsKeys,themedDefaultsKeys:this._themedDefaultsKeys,excludedDefaultsKeys:this._excludedDefaultsKeys,themedColors:this._themedColors,replaceThemedColorsOnThemeChange:this._replaceThemedColorsOnThemeChange,allStateKeys:this._allStateKeys,excludedStateKeys:this._excludedDefaultsKeys,excludedTemplateKeys:this._excludedTemplateKeys,useUserPreferences:this._useUserPreferences,saveNonDefaultUserPreferencesOnly:this._saveNonDefaultUserPreferencesOnly,ignoreAllowSavingDefaults:this._ignoreAllowSavingDefaults,saveDefaultsConsumer:this._saveDefaultsConsumer,alwaysSaveDefaultKeys:this._alwaysSaveDefaultKeys,theme:this._theme.spawnOwnership()}}_childChanged(e,t){super._childChanged(e,t),this._propertyAffectsDefaults(t)&&this.saveDefaults()}_fireMergeAndFireChangedProps(e){this._forbidSavingDefaults=!0,super._fireMergeAndFireChangedProps(e),this._forbidSavingDefaults=!1,e.some((e=>this._propertyAffectsDefaults(e.pathToRootProperty())))&&this.saveDefaults()}_factoryDefaultsForTheme(e){return(0,n.default)(this._factoryDefaultsSupplier(),this.themeDefaults(e))}_propertyAffectsDefaults(e){return(this._ignoreAllowSavingDefaults||V)&&!this._defaultName.startsWith("replayStudyStrategy")&&(!this._defaultName.startsWith("study_")||this._defaultName.startsWith("study_VbPFixed"))&&(this._allDefaultsKeys&&this._allDefaultsKeys.includes(e)||!this._allDefaultsKeys&&!this._excludedDefaultsKeys?.includes(e))&&(0,I.isPrimitiveType)(this.childByPath(e)?.value())}}},87913:(e,t,i)=>{i.r(t),i.d(t,{SelectPointMode:()=>a,activePointSelectionMode:()=>Y,alignTo45Degrees:()=>Me,barTimesUnderCursor:()=>Q,beenSetLineToolLastPoint:()=>N,cancelLineTool:()=>ae,cancelledLineTool:()=>K,changeLineStyle:()=>fe,changeLineTool:()=>ue,changedLineStyle:()=>$,changedLineTool:()=>W,continueLineTool:()=>ie,continuedLineTool:()=>B,copiedLineTool:()=>j,copyLineTool:()=>me,createLineTool:()=>te,createdLineTool:()=>A,crosshairLock:()=>b,cursorTool:()=>R,drawOnAllCharts:()=>Se,drawOnAllChartsMode:()=>Ie,emojiTool:()=>S,finishChangingLineTool:()=>he,finishLineTool:()=>de,finishMovingLineTool:()=>oe,finishedChangingLineTool:()=>H,finishedLineTool:()=>U,finishedMovingLineTool:()=>O,hideAllDrawings:()=>De,hideAllIndicators:()=>Te,hideMarksOnBars:()=>Pe,iconTool:()=>M,init:()=>_e,isDirectionalMovementActive:()=>V,isStudyEditingNow:()=>J,isToolCreatingNow:()=>C,isToolEditingNow:()=>k,isToolMovingNow:()=>L,lockDrawings:()=>be,moveLineTool:()=>re,movedLineTool:()=>E,properties:()=>xe,removeLineTool:()=>ce,removedLineTool:()=>q,resetToCursor:()=>v,restoreLineTool:()=>pe,restoreLineToolState:()=>ge,restoredLineTool:()=>G,restoredLineToolState:()=>Z,runOnDrawingStateReady:()=>we,setLineToolLastPoint:()=>ne,startChangingLineTool:()=>le,startMovingLineTool:()=>se,startedChangingLineTool:()=>z,startedMovingLineTool:()=>F,stickerTool:()=>I,tool:()=>P,toolIsCursor:()=>m,toolIsDemonstration:()=>p,toolIsMeasure:()=>g})
;var a,n=i(650151),s=i(781567),r=i(312692),o=i(820028),l=i(751094),u=i(547465),h=i(62802),c=i(251954),d=i(345848);!function(e){e[e.None=0]="None",e[e.Replay=1]="Replay",e[e.Study=2]="Study"}(a||(a={}));const f=new Set(["cursor","arrow","dot","performance","demonstration"]);function m(e){return f.has(e)}function p(e){return"demonstration"===e}function g(e){return"measure"===e}function v(e=!1){if(!e&&y){if(y.childs().stayInDrawingMode.value())return}P.setValue(R.value())}let y=null,_=null,w=null,x=null,D=null,T=null;const b=new l.WatchedObject(null),P=new o.WatchedValue,M=new o.WatchedValue,S=new o.WatchedValue,I=new o.WatchedValue,R=new o.WatchedValue,C=new o.WatchedValue(!1),k=new o.WatchedValue(!1),L=new o.WatchedValue(!1),V=new o.WatchedValue(!1),A=new u.Delegate,B=new u.Delegate,K=new u.Delegate,N=new u.Delegate,F=new u.Delegate,E=new u.Delegate,O=new u.Delegate,z=new u.Delegate,W=new u.Delegate,H=new u.Delegate,q=new u.Delegate,U=new u.Delegate,$=new u.Delegate,j=new u.Delegate,G=new u.Delegate,Z=new u.Delegate,Y=new o.WatchedValue(a.None),J=new o.WatchedValue(!1),Q=new Map;function X(e,t){const i=t||{value:!1};return t=>{i.value||(i.value=!0,e.fire(t),i.value=!1)}}const ee={value:!1},te=X(A,ee),ie=X(B,ee),ae=X(K,ee),ne=X(N,ee),se=X(F),re=X(E),oe=X(O),le=X(z),ue=X(W),he=X(H),ce=X(q),de=X(U),fe=X($,ee),me=X(j,ee),pe=X(G),ge=X(Z);let ve=!1,ye=[];function _e(){if(ve)return;const e=h.getValue("chart.cursorPreference","cursor");P.setValue(m(e)?e:"cursor"),P.subscribe((e=>{m(e)?R.setValue(e):"eraser"===e&&(0,d.trackEvent)("Chart cursors",e)}),{callWithLast:!0}),R.subscribe((e=>{(0,d.trackEvent)("Chart cursors",e),e&&"performance"!==e&&!p(e)&&h.setValue("chart.cursorPreference",e)})),y=new r.DefaultProperty({defaultName:"drawings"}),_=(0,s.createPrimitiveProperty)(!1),w=(0,s.createPrimitiveProperty)(!1),x=(0,s.createPrimitiveProperty)(!1),D=(0,s.createPrimitiveProperty)(!h.getBool("BarsMarksContainer.visibile",!0)),T=(0,s.createPrimitiveProperty)(!1),P.subscribe((e=>{(0,c.emit)("onSelectedLineToolChanged")})),ve=!0,ye.forEach((e=>e())),ye=[]}function we(e){ve?e():ye.push(e)}function xe(){return(0,n.ensureNotNull)(y)}function De(){return(0,n.ensureNotNull)(_)}function Te(){return(0,n.ensureNotNull)(w)}function be(){return(0,n.ensureNotNull)(x)}function Pe(){return(0,n.ensureNotNull)(D)}function Me(){return(0,n.ensureNotNull)(T)}function Se(){return xe().childs().drawOnAllCharts}function Ie(){return xe().childs().drawOnAllChartsMode}},731974:(e,t,i)=>{i.d(t,{AreaName:()=>a,HitTarget:()=>n,HitTestResult:()=>h,hitTestResultDataAreEqual:()=>u,shouldDefaultActionBeExecuted:()=>l,tryCallHandler:()=>o});var a,n,s=i(650279),r=i(650151);function o(e,t,i,a){if(e.isTouch){if(void 0!==a)return a(e,t),!0}else if(void 0!==i)return i(e,t),!0;return!1}function l(e,t,i,a){return void 0!==t.executeDefaultAction&&(e.isTouch?Boolean(t.executeDefaultAction[a]):Boolean(t.executeDefaultAction[i]))}function u(e,t){return e&&t&&e.equals&&t.equals?e.equals(t):(0,s.default)(e,t)}!function(e){e.Style="Style",e.Text="Text",e.Line="Line",
e.Tooltip="Tooltip",e.Button="Button",e.SourceItemMove="SourceItemMove",e.AnchorPoint="AnchorPoint"}(a||(a={})),function(e){e[e.MovePointBackground=1]="MovePointBackground",e[e.Regular=2]="Regular",e[e.MovePoint=3]="MovePoint",e[e.ChangePoint=4]="ChangePoint",e[e.Custom=5]="Custom"}(n||(n={}));class h{constructor(e,t,i){this._target=e,this._data=t||null,this._eraseMarker=i}target(){return this._target}data(){return this._data}mergeData(e){this._data={...(0,r.ensureNotNull)(this._data),...e}}hasPressedMoveHandler(e){return null!==this._data&&function(e,t,i){if(e.isTouch){if(void 0!==i)return!0}else if(void 0!==t)return!0;return!1}(e,this._data.pressedMouseMoveHandler,this._data.touchMoveHandler)}tryCallMouseDownOrTouchStartHandler(e,t){return null!==this._data&&o(e,t,this._data.mouseDownHandler,this._data.touchStartHandler)}tryCallMouseUpOrTouchEndHandler(e,t){return null!==this._data&&o(e,t,this._data.mouseUpHandler,this._data.touchEndHandler)}tryCallMouseEnterHandler(e,t){return null!==this._data&&o(e,t,this._data.mouseEnterHandler)}tryCallMouseLeaveHandler(e,t){return null!==this._data&&o(e,t,this._data.mouseLeaveHandler)}tryCallMouseMoveHandler(e,t){return null!==this._data&&o(e,t,this._data.mouseMoveHandler)}tryCallClickOrTapHandler(e,t){return null!==this._data&&o(e,t,this._data.clickHandler,this._data.tapHandler)}tryCallDblClickOrDblTapHandler(e,t){return null!==this._data&&o(e,t,this._data.doubleClickHandler,this._data.doubleTapHandler)}tryCallContextMenuHandler(e,t){return null!==this._data&&o(e,t,this._data.contextMenuHandler,this._data.touchContextMenuHandler)}eraseMarker(){return this._eraseMarker}}},266954:(e,t,i)=>{i.d(t,{intervalsVisibilitiesDefaults:()=>a});const a={ticks:!0,seconds:!0,secondsFrom:1,secondsTo:59,minutes:!0,minutesFrom:1,minutesTo:59,hours:!0,hoursFrom:1,hoursTo:24,days:!0,daysFrom:1,daysTo:366,weeks:!0,weeksFrom:1,weeksTo:52,months:!0,monthsFrom:1,monthsTo:12,ranges:!0}},816541:(e,t,i)=>{i.d(t,{getIntervalsVisibilitiesForMode:()=>f,isActualInterval:()=>h,makeIntervalsVisibilitiesVisibleAtInterval:()=>l,mergeIntervalVisibilitiesDefaults:()=>d,nonDefaultIntervalsVisibilities:()=>c});var a=i(998034),n=i(154834),s=i(650151),r=i(477786),o=i(266954);function l(e,t){let i=t.multiplier();if(t.isTicks()&&(e.ticks=!0),t.isSeconds()&&(i<60?(e.seconds=!0,e.secondsFrom=Math.min(e.secondsFrom,i),e.secondsTo=Math.max(e.secondsTo,i)):(i=Math.floor(i/60),t=new r.Interval(r.ResolutionKind.Minutes,i))),t.isMinutes())if(i<60)e.minutes=!0,e.minutesFrom=Math.min(e.minutesFrom,i),e.minutesTo=Math.max(e.minutesTo,i);else{const t=Math.floor(i/60);e.hours=!0,e.hoursFrom=Math.min(e.hoursFrom,t),e.hoursTo=Math.max(e.hoursTo,t)}t.isDays()&&(e.days=!0,e.daysFrom=Math.min(e.daysFrom,i),e.daysTo=Math.max(e.daysTo,i)),t.isWeeks()&&(e.weeks=!0,e.weeksFrom=Math.min(e.weeksFrom,i),e.weeksTo=Math.max(e.weeksTo,i)),t.isMonths()&&(e.months=!0,e.monthsFrom=Math.min(e.monthsFrom,i),e.monthsTo=Math.max(e.monthsTo,i)),t.isRange()&&(e.ranges=!0)}function u(e,t,i,a){return e&&a>=t&&a<=i}function h(e,t){const i=t.childs()
;switch(e.kind()){case r.ResolutionKind.Ticks:return i.ticks.value();case r.ResolutionKind.Seconds:if(e.multiplier()<60)return u(i.seconds.value(),i.secondsFrom.value(),i.secondsTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return u(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),t)}case r.ResolutionKind.Minutes:if(e.multiplier()<60)return u(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return u(i.hours.value(),i.hoursFrom.value(),i.hoursTo.value(),t)}case r.ResolutionKind.Days:return u(i.days.value(),i.daysFrom.value(),i.daysTo.value(),e.multiplier());case r.ResolutionKind.Weeks:return u(i.weeks.value(),i.weeksFrom.value(),i.weeksTo.value(),e.multiplier());case r.ResolutionKind.Months:return u(i.months.value(),i.monthsFrom.value(),i.monthsTo.value(),e.multiplier());case r.ResolutionKind.Range:return i.ranges.value()}return(0,s.assert)(!1,`Unsupported resolution: ${e.value()}`),!1}function c(e){const t=Object.keys(e).filter((t=>o.intervalsVisibilitiesDefaults[t]!==e[t]));return 0===t.length?null:t.reduce(((t,i)=>(t[i]=e[i],t)),{})}function d(e){return(0,a.default)((0,n.default)(o.intervalsVisibilitiesDefaults),e??{})}function f(e,t){if(0===t||e.isTicks()&&3===t||e.isRange()&&2===t)return d();let i=!1;const a={ticks:!1,seconds:!1,minutes:!1,hours:!1,days:!1,weeks:!1,months:!1,ranges:!1},n=e=>e.multiplier();return[{checker:e=>e.isTicks(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.ticks=!0}},{checker:e=>e.isSeconds()&&e.multiplier()<60,getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.seconds=!0,a.secondsFrom=e,a.secondsTo=t}},{checker:e=>e.isSeconds()&&e.multiplier()>=60,getIntervalMultiplier:e=>Math.floor(e.multiplier()/60),markIntervalAsVisible:(e,t)=>{a.minutes=!0,a.minutesFrom=e,a.minutesTo=t}},{checker:e=>e.isMinutes()&&e.multiplier()<60,getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.minutes=!0,a.minutesFrom=e,a.minutesTo=t}},{checker:e=>e.isMinutes()&&e.multiplier()>=60,getIntervalMultiplier:e=>Math.floor(e.multiplier()/60),markIntervalAsVisible:(e,t)=>{a.hours=!0,a.hoursFrom=e,a.hoursTo=t}},{checker:e=>e.isDays(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.days=!0,a.daysFrom=e,a.daysTo=t}},{checker:e=>e.isWeeks(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.weeks=!0,a.weeksFrom=e,a.weeksTo=t}},{checker:e=>e.isMonths(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.months=!0,a.monthsFrom=e,a.monthsTo=t}},{checker:e=>e.isRange(),getIntervalMultiplier:n,markIntervalAsVisible:(e,t)=>{a.ranges=!0}}].forEach((a=>{if(a.checker(e)){i=!0;const n=a.getIntervalMultiplier(e);1===t?a.markIntervalAsVisible(n,n):3===t?a.markIntervalAsVisible(n,void 0):a.markIntervalAsVisible(void 0,n)}else(!i&&2===t||i&&3===t)&&a.markIntervalAsVisible(void 0,void 0)})),d(a)}},437642:(e,t,i)=>{i.d(t,{crosshairMoveEvent:()=>m,globalChangeEvent:()=>r,hoverChangeEvent:()=>d,selectionChangeEvent:()=>h,sourceChangeEvent:()=>n,viewportChangeEvent:()=>l});var a=i(283873);function n(e){
return(0,a.default)(e)?{type:"data-source-change",sourceId:e}:{type:"data-source-change",...e}}const s={type:"global-change"};function r(){return s}const o={type:"viewport-change"};function l(e){return e?{type:"viewport-change",pane:e}:o}const u={type:"selection-change"};function h(){return u}const c={type:"hover-change"};function d(){return c}const f={type:"crosshair-move"};function m(){return f}},338242:(e,t,i)=>{i.r(t),i.d(t,{addHorizontalLineToPath:()=>c,addLineToPath:()=>P,addPixelPerfectLineToPath:()=>S,addVerticalLineToPath:()=>f,clearRectWithGradient:()=>u,clipPolygonByEdge:()=>R,computeDashPattern:()=>b,createCircle:()=>x,drawHorizontalLine:()=>d,drawLine:()=>M,drawPixelPerfectLine:()=>I,drawPoly:()=>D,drawRoundRect:()=>v,drawRoundRectWithInnerBorder:()=>y,drawVerticalLine:()=>m,fillRectInnerBorder:()=>h,fillRectWithBorder:()=>w,scaleDrawRoundRectRadii:()=>p,scaledDashPattern:()=>_,setLineStyle:()=>T});var a=i(86441),n=i(5531),s=i(257145),r=i(770885),o=i(688857),l=i(278688);function u(e,t,i,a,n,s,r){e.save(),e.globalCompositeOperation="copy";const o=e.createLinearGradient(0,0,0,n);o.addColorStop(0,s),o.addColorStop(1,r),e.fillStyle=o,e.fillRect(t,i,a,n),e.restore()}function h(e,t,i,a,n,s){e.fillRect(t+s,i,a-2*s,s),e.fillRect(t+s,i+n-s,a-2*s,s),e.fillRect(t,i,s,n),e.fillRect(t+a-s,i,s,n)}function c(e,t,i,a){const n=e.lineWidth%2?.5:0;e.moveTo(i,t+n),e.lineTo(a,t+n)}function d(e,t,i,a){e.beginPath(),c(e,t,i,a),e.stroke()}function f(e,t,i,a){const n=e.lineWidth%2?.5:0;e.moveTo(t+n,i),e.lineTo(t+n,a)}function m(e,t,i,a){e.beginPath(),f(e,t,i,a),e.stroke()}function p(e,t){return Array.isArray(e)?e.map((e=>Math.round(e*t))):Math.round(e*t)}function g(e,t){return Array.isArray(e)?e.map((e=>0===e?e:e+t)):e+t}function v(e,t,i,a,n,s,r){let o,l,u,h;if(Array.isArray(s))if(2===s.length){const e=Math.max(0,s[0]),t=Math.max(0,s[1]);o=e,l=e,u=t,h=t}else{if(4!==s.length)throw new Error("Wrong border radius - it should be like css border radius");o=Math.max(0,s[0]),l=Math.max(0,s[1]),u=Math.max(0,s[2]),h=Math.max(0,s[3])}else{const e=Math.max(0,s);o=e,l=e,u=e,h=e}r||e.beginPath(),e.moveTo(t+o,i),e.lineTo(t+a-l,i),0!==l&&e.arcTo(t+a,i,t+a,i+l,l),e.lineTo(t+a,i+n-u),0!==u&&e.arcTo(t+a,i+n,t+a-u,i+n,u),e.lineTo(t+h,i+n),0!==h&&e.arcTo(t,i+n,t,i+n-h,h),e.lineTo(t,i+o),0!==o&&e.arcTo(t,i,t+o,i,o)}function y(e,t,i,a,n,s,o=0,l=0,u="",h=r.LineStyle.Solid){if(e.save(),!l||!u||u===s)return v(e,t,i,a,n,o),e.fillStyle=s,e.fill(),void e.restore();const c=l/2;if("transparent"!==s){const c="transparent"!==u&&h!==r.LineStyle.Solid;v(e,c?t:t+l,c?i:i+l,c?a:a-2*l,c?n:n-2*l,c?o:g(o,-l)),e.fillStyle=s,e.fill()}if("transparent"!==u){v(e,t+c,i+c,a-l,n-l,g(o,-c)),e.lineWidth=l,e.strokeStyle=u,T(e,h),e.closePath(),e.stroke()}e.restore()}function _(e,t){return t=Math.max(1,t),e.map((e=>e*t))}function w(e,t,i,a,n,l,u,h,c){const{context:f}=e,m=l%2/2,p=t+m,g=a+m;let v,y;if(h){const{borderMode:e,borderWidth:r,color:o,dashPattern:u,lineStyle:c}=h;switch(e){case"outer":{const e=-l/2-r/2,t=-r/2;y={left:p+e,right:g-e,top:i+t,bottom:n-t};break}case"center":{
const e=r%2/2;y={left:t+e,right:a+e,top:i+e,bottom:n+e};break}case"inner":{const e=-l/2+r/2,t=r/2;y={left:p+e,right:g-e,top:i+t,bottom:n-t}}}f.strokeStyle=o,f.lineWidth=r;let d=-1;u?f.setLineDash(_(u,r)):void 0!==c&&(T(f,c),c===s.LINESTYLE_SOLID&&(d=1)),v={left:y.left+d*r/2,top:y.top+d*r/2,right:y.right-d*r/2,bottom:y.bottom-d*r/2}}if(u&&(f.fillStyle=u.color,v||(v={left:p-l/2,right:g+l/2,top:i,bottom:n}),f.fillRect(v.left,v.top,v.right-v.left,v.bottom-v.top)),c){const{lineWidth:s,lineColor:r,lineStyle:l,excludeBoundaries:u}=c;f.save(),f.lineCap="butt",f.lineWidth=s,f.strokeStyle=r,T(f,l);const m=()=>d(f,Math.floor((i+n)/2),h?.rightToLeftStroke?a:t,h?.rightToLeftStroke?t:a);u?(0,o.drawWithExclusionAreaByScope)(e,u,m):m(),f.restore()}if(y){if((h?.lineStyle??r.LineStyle.Solid)===r.LineStyle.Solid)f.strokeRect(y.left,y.top,y.right-y.left,y.bottom-y.top);else{const e=h?.rightToLeftStroke?y.right:y.left,t=h?.rightToLeftStroke?y.left:y.right,i=y.top,a=y.bottom;f.lineCap="butt",[[e,i,t,i],[e,a,t,a],[e,i,e,a],[t,i,t,a]].forEach((([e,t,i,a])=>{f.beginPath(),f.moveTo(e,t),f.lineTo(i,a),f.stroke()}))}}}function x(e,t,i,a){e.beginPath(),e.arc(t,i,a,0,2*Math.PI,!1),e.closePath()}function D(e,t,i){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const i of t)e.lineTo(i.x,i.y);e.closePath(),e.stroke(),i&&e.fill()}function T(e,t){let i=[];t!==s.LINESTYLE_SOLID&&(i=b(e.lineWidth,t)),e.setLineDash(i)}function b(e,t){return[[e,2*e],[5*e,6*e],[6*e,6*e],[e,4*e],[2*e,e]][t-1]}function P(e,t,i,a,n){e.moveTo(t,i),e.lineTo(a,n)}function M(e,t,i,a,n){isFinite(t)&&isFinite(a)&&isFinite(i)&&isFinite(n)&&(e.beginPath(),P(e,t,i,a,n),e.stroke())}function S(e,t,i,a,n,s){const{horizontalPixelRatio:r,verticalPixelRatio:o}=s;let l;return t===a?(l=[Math.round(t*r),i*o,Math.round(t*r),n*o],f(e,l[0],l[1],l[3])):i===n?(l=[t*r,Math.round(i*o),a*r,Math.round(i*o)],c(e,l[1],l[0],l[2])):(l=[t*r,i*o,a*r,n*o],P(e,l[0],l[1],l[2],l[3])),l}function I(e,t,i,a,n,s=l.dpr1PixelRatioInfo){e.beginPath(),S(e,t,i,a,n,s),e.stroke()}function R(e,t,i,s){const r=(0,a.equalPoints)(i,s[0])?(0,a.equalPoints)(i,s[1])?null:s[1]:s[0];return null!==e&&null!==r?(0,n.intersectPolygonAndHalfplane)(e,(0,a.halfplaneThroughPoint)((0,a.lineThroughPoints)(t,i),r)):null}},322604:(e,t,i)=>{i.d(t,{PriceAxisViewRenderer:()=>d,hittestByData:()=>c});var a=i(86441),n=i(934026),s=i(822961),r=i(969680),o=i(688857),l=i(731974),u=i(338242);const h=new Path2D("M4.09.93c.4.16.75.4 1.02.73a5.47 5.47 0 0 0-3.78 3.27A2.5 2.5 0 0 1 3.2.77c.31 0 .61.06.89.16Zm8.24 3.35a2.5 2.5 0 0 0-3.27-3.23c-.38.16-.7.4-.97.7a5.47 5.47 0 0 1 3.56 3.5c.3-.26.53-.6.68-.97Zm-3.15-.84a4.5 4.5 0 1 0-5.5 7.12 4.5 4.5 0 0 0 5.5-7.12ZM6 4h1v4H4V7h2V4Z");function c(e,t){const i=(0,s.lastMouseOrTouchEventInfo)().isTouch?15:0,r=e.hitTestData;if(void 0===r||!e.visible)return null;const{itemBox:o,clickHandler:u,tooltip:h}=r;if(o){const s=(0,a.box)(new a.Point(o.min.x-i,o.min.y-i),new a.Point(o.max.x+i,o.max.y+i));if((0,n.pointInBox)(t,s))return new l.HitTestResult(e.hitTarget??l.HitTarget.Custom,{clickHandler:u?.bind(null,t),
tapHandler:u?.bind(null,t),hoverModelFromAxis:r.hoverModelFromAxis,activeItem:r.activeItem,tooltip:h})}return null}class d{constructor(e,t){this._bodyBox=null,this.setData(e,t)}setData(e,t){this._data=e,this._commonData=t}lastDrawnBodyBox(){return this._bodyBox}draw(e,t,i,n,s){const l=this._data,{mediaSize:h,bitmapSize:c,horizontalPixelRatio:d,verticalPixelRatio:f}=t;if(!l.visible||this._isOutOfScreen(i,h.height))return;const m=this._commonData,p=void 0!==l.labelIcon,g=i.paddingTop+m.additionalPaddingTop,v=i.paddingBottom+m.additionalPaddingBottom,{paddingOuter:y,paddingInner:_,fontSize:w,borderSize:x}=i,D=l.ignoreAdditionalPaddingInner?0:i.additionalPaddingInner;let T=l.text,b=l.textColor||m.textColor,P=l.secondLine||"",M=m.secondLineTextColor||b,S=l.thirdLine||"";const I=m.thirdLineTextColor||b;0===P.length&&(P=S,M=I,S=""),0===T.length&&(T=P,b=M,P=S,M=I,S=""),e.save(),void 0!==m.globalAlpha&&(e.globalAlpha*=m.globalAlpha),e.font=i.font;const R=n.yMidCorrection(e,T)*f,C=w+g+v,k=(l.labelIconMinWidth??0)*d,L=Boolean(P),V=Boolean(S),A=_+y+D,B=[Math.ceil(n.measureText(e,T)),L?Math.ceil(n.measureText(e,P)):0,V?Math.ceil(n.measureText(e,S)):0],K=Math.max(1,Math.floor(f));let N=Math.round(C*f);N%2!=K%2&&(N+=1);const F=Math.round((w+i.lineSpacing)*f),E=Math.round(2*(w+i.lineSpacing)*f),O=Math.max(1,Math.floor(x*d)),z=l.separatorVisible?O:0,W=l.borderVisible?O:0,H=p?Math.max(N,k):Math.round((Math.max(...B)+A)*d),q=Math.round(D*d),U=c.width,$=Math.ceil(_*d),j=Math.round((m.fixedCoordinate??m.coordinate)*f)-Math.floor(.5*f),G=Math.floor(j+K/2-N/2),Z=G+N,Y="right"===s,J=void 0!==l.xCoord?Math.round(l.xCoord*d)+(Y?1:-1)*Math.round(H/2):Y?U-z:z;let Q,X=J;const ee=l.backgroung??m.background;e.fillStyle=ee;const te=2*f;if(e.textAlign=Y?"right":"left",e.textBaseline="middle",Y?(X=J-H,Q=J-q-$+z):(X=J+H,Q=J+q+$-z),this._bodyBox=null,T||p){const i=V?N+E:L?N+F:N,n=m.borderColor??ee,s=void 0!==l.xCoord?te:0;if(((t,n,r)=>{if(Y){(0,u.drawRoundRectWithInnerBorder)(e,X,G,H,i,t,l.overridenRadius?(0,u.scaleDrawRoundRectRadii)(l.overridenRadius,f):[te,s,s,te],W,n,r);const o=(0,a.point)(X/d,G/f),h=o.add((0,a.point)(H/d,i/f));this._bodyBox=(0,a.box)(o,h)}else{(0,u.drawRoundRectWithInnerBorder)(e,J,G,H,i,t,l.overridenRadius?(0,u.scaleDrawRoundRectRadii)(l.overridenRadius,f):[s,te,te,s],W,n,r);const o=(0,a.point)(J/d,G/f),h=o.add((0,a.point)(H/d,i/f));this._bodyBox=(0,a.box)(o,h)}})(ee,n,m.borderStyle),p){switch(l.labelIcon){case 0:this._drawPlusIcon(e,J,X,G,j,Z,K);break;case 1:this._drawClockExistingAlertIcon(e,J,X,t,G,i)}return void e.restore()}e.save(),e.translate(Q,(G+Z)/2+R),(0,o.drawScaled)(e,d,f,(()=>{e.fillStyle=b,e.fillText(T,0,0)})),e.restore()}L&&(e.fillStyle=M,e.save(),e.translate(Q,(G+Z)/2+R+F),(0,o.drawScaled)(e,d,f,(()=>{e.fillText((0,r.startWithLTR)(P),0,0)})),e.restore()),V&&(e.fillStyle=I,e.save(),e.translate(Q,(G+Z)/2+R+E),(0,o.drawScaled)(e,d,f,(()=>{e.fillText((0,r.startWithLTR)(S),0,0)})),e.restore()),e.restore()}topBottomTotalHeight(e){const t=this._lines();if(!this._data.visible||0===t)return{top:0,bottom:0,total:0}
;const i=e.fontSize/2+e.paddingTop+this._commonData.additionalPaddingTop,a=(t-.5)*e.fontSize+(t-1)*e.lineSpacing+e.paddingBottom+this._commonData.additionalPaddingBottom;return{top:i,bottom:a,total:i+a}}hitTest(e){return c(this._data,e)}_drawPlusIcon(e,t,i,a,n,s,r){e.fillStyle=this._commonData.textColor,e.strokeStyle=this._commonData.textColor,e.lineWidth=r;const o=Math.abs(t-i);let l=Math.round(.35*o);l%2!=r%2&&(l+=1);let u=Math.round(.65*o);u%2!=r%2&&(u+=1);const h=Math.floor((o-l)/2),c=Math.min(t,i),d=c+Math.floor(o/2-r/2);e.fillRect(c+h,n,l,r),e.fillRect(d,a+h,r,l),e.beginPath(),e.arc(d+r/2,n+r/2,u/2,0,2*Math.PI,!1),e.stroke()}_drawClockExistingAlertIcon(e,t,i,a,n,s){e.fillStyle=this._commonData.textColor;const r=Math.abs(t-i),o=Math.min(t,i),{horizontalPixelRatio:l,verticalPixelRatio:u}=a,c=r/(23*l),d=r/(23*u),f=12*l*c,m=10.73*u*d,p=Math.floor((r-f)/2),g=Math.floor((s-m)/2)-1;e.save(),e.translate(o+p,n+g),e.scale(l*c,u*d),e.fill(h),e.restore()}_lines(){const e=this._data;return(e.text?1:0)+(e.secondLine?1:0)+(e.thirdLine?1:0)}_isOutOfScreen(e,t){const i=this._commonData,a=i.fixedCoordinate??i.coordinate,{total:n}=this.topBottomTotalHeight(e),s=n/this._lines();return a-s/2-3>t||a+(n-s/2)+3<0}}},597331:(e,t,i)=>{i.d(t,{PriceAxisView:()=>s});var a=i(322604),n=i(534328);class s{constructor(e){this._commonRendererData={coordinate:0,textColor:"#FFF",background:"#000",additionalPaddingBottom:0,additionalPaddingTop:0},this._axisRendererData={text:"",visible:!1,separatorVisible:!0,borderVisible:!1,ignoreAdditionalPaddingInner:!1},this._paneRendererData={text:"",visible:!1,separatorVisible:!1,borderVisible:!1,ignoreAdditionalPaddingInner:!0},this._invalidated=!0,this._active=!1,this._axisRenderer=new(e||a.PriceAxisViewRenderer)(this._axisRendererData,this._commonRendererData),this._paneRenderer=new(e||a.PriceAxisViewRenderer)(this._paneRendererData,this._commonRendererData)}setActive(e){this._active=e}text(){return this._updateRendererDataIfNeeded(),this._axisRendererData.text}secondLineText(){return this._updateRendererDataIfNeeded(),this._axisRendererData.secondLine}thirdLineText(){return this._updateRendererDataIfNeeded(),this._axisRendererData.thirdLine}background(){return this._updateRendererDataIfNeeded(),this._commonRendererData.background}color(){return this._updateRendererDataIfNeeded(),this.generateTextColor(this.background())}generateTextColor(e){return(0,n.colorFromBackground)(e)}coordinate(){return this._updateRendererDataIfNeeded(),this._commonRendererData.coordinate}floatCoordinate(){return this._updateRendererDataIfNeeded(),this._commonRendererData.floatCoordinate??this._commonRendererData.coordinate}update(e){this._invalidated=!0}topBottomTotalHeight(e){this._updateRendererDataIfNeeded();const{top:t,bottom:i,total:a}=this._axisRenderer.topBottomTotalHeight(e),{top:n,bottom:s,total:r}=this._paneRenderer.topBottomTotalHeight(e);return{top:Math.max(t,n),bottom:Math.max(i,s),total:Math.max(a,r)}}getFixedCoordinate(){return this._commonRendererData.fixedCoordinate||0}setFixedCoordinate(e){
this._commonRendererData.fixedCoordinate=e}isVisible(){return this._updateRendererDataIfNeeded(),this._axisRendererData.visible||this._paneRendererData.visible}isAxisLabelVisible(){return this._updateRendererDataIfNeeded(),this._axisRendererData.visible}isPaneLabelVisible(){return this._updateRendererDataIfNeeded(),this._paneRendererData.visible}renderer(){return this._updateRendererDataIfNeeded(),this._axisRenderer}paneRenderer(){return this._updateRendererDataIfNeeded(),this._paneRenderer}setPaneRendererLabelIcon(e){this._paneRendererData.labelIcon=e}setPaneLabelVisible(e){this._paneRendererData.visible=e,this._invalidated=!0}ignoreAlignment(){return!1}_updateRendererDataIfNeeded(){this._invalidated&&(this._commonRendererData.fixedCoordinate=void 0,this._updateRendererData(this._axisRendererData,this._paneRendererData,this._commonRendererData),this._invalidated=!1)}}},881727:(e,t,i)=>{i.d(t,{isRootPath:()=>o,propertyByPath:()=>r,propertyPathForSource:()=>n});var a=i(650151);function n(e,t="properties"){return`charts.${e.model().id()}.sources.${e.id()}.${t}`}function s(e,t){if(t.length<4)throw new Error("Invalid chart path");const i=function(e,t){return(0,a.ensureDefined)(e.getAll().find((e=>e.hasModel()&&e.model().model().id()===t))).model().model()}(e,t[0]),n=t[1];if("sources"===n){return(0,a.ensureNotNull)(i.dataSourceForId(t[2])).propertyByPath(t.slice(3).join("."))}throw new Error(`Invalid chart path, unknown root: ${n}`)}function r(e,t){const i=t.split(".");if(i.length<1)throw new Error("Invalid path");const a=i[0];if("charts"===a)return s(e,i.slice(1));throw new Error(`Invalid path, unknown root: ${a}`)}function o(e){return e.startsWith("charts.")}},278688:(e,t,i)=>{i.d(t,{dpr1PixelRatioInfo:()=>n,equalPixelRatios:()=>r,equalRenderingInfos:()=>s});var a=i(327714);const n={horizontalPixelRatio:1,verticalPixelRatio:1};function s(e,t){return(0,a.equalSizes)(e.mediaSize,t.mediaSize)&&(0,a.equalSizes)(e.bitmapSize,t.bitmapSize)&&r(e,t)}function r(e,t){return e.horizontalPixelRatio===t.horizontalPixelRatio&&e.verticalPixelRatio===t.verticalPixelRatio}},196302:(e,t,i)=>{i.d(t,{LiveStudyGraphics:()=>r.LiveStudyGraphics,createGraphicsPaneViews:()=>f,createGraphicsPriceAxisViews:()=>p,emptyStudyGraphics:()=>s.emptyStudyGraphics,isStudyGraphicsEmpty:()=>n.isStudyGraphicsEmpty,loadStudyGraphics:()=>s.loadStudyGraphics,saveStudyGraphics:()=>s.saveStudyGraphics});var a=i(735566),n=i(311908),s=i(57088),r=i(284881),o=i(597331),l=i(534328);class u extends o.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t}_updateRendererData(e,t,i){e.visible=!1;const a=this._source.priceScale(),n=this._source.properties().childs(),s=n.visible.value();if(!a||a.isEmpty()||!s)return;const r=n.graphics.childs()[this._data.lineType]?.childs()[this._data.styleId]?.childs();if(!(void 0!==r&&r.visible&&r.visible.value()&&r.showPrice&&r.showPrice.value()&&this._isLabelVisibleAccordinglyToProperties()))return;const o=this._source.firstValue();if(null===o)return;const u=this._data.line.level,h=(0,l.resetTransparency)(r.color.value())
;i.background=h,i.textColor=this.generateTextColor(h),i.coordinate=a.priceToCoordinate(u,o),e.text=a.formatPrice(u,o,{signPositive:a.isPercentage()}),e.visible=!0}_isLabelVisibleAccordinglyToProperties(){const e=this._source.model().properties().childs().scalesProperties.childs();return(e.showStudyLastValue.value()||e.showFundamentalLastValue.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()}}const h=(0,a.getLogger)("Chart.StudyGraphics"),c=new Set(["dwgtablecells","tpoBlockSets","tpoLevels","tpoVolumeRows","logs","performance"]);async function d(e,t,a,n){const s=e=>({regularPaneView:new e(t,a,n)}),r=e=>({regularPaneView:new e(t,a,!1,n),forceOverlayPaneView:new e(t,a,!0,n)});switch(e){case"hlines":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,350355))).LevelPaneView);case"lines":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,822305))).LinePaneView);case"shapemarks":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,38533))).ShapeMarkPaneView);case"textmarks":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,461449))).TextMarkPaneView);case"trendchannels":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,667059))).TrendChannelPaneView);case"dwglabels":return r((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,183941))).DwgLabelPaneView);case"dwglines":return r((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,77148))).DwgLinePaneView);case"dwgpolylines":return r((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,380729))).DwgPolylinePaneView);case"dwgboxes":return r((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,973151))).DwgBoxPaneView);case"dwgtables":return r((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,35404))).DwgTablePaneView);case"dwglinefills":return r((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,592739))).DwgLineFillPaneView);case"tpos":return{regularPaneView:new((await Promise.all([i.e(32121),i.e(7815),i.e(37642),i.e(27860),i.e(5713),i.e(18585),i.e(28090),i.e(7232),i.e(769)]).then(i.bind(i,86981))).TpoPaneView)(t,a,n)};case"footprints":return{regularPaneView:new((await Promise.all([i.e(80977),i.e(53464),i.e(9141)]).then(i.bind(i,637645))).VolumeFootprintPaneView)(t,a)}}switch(e){case"hhists":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,910529))).HHistPaneView);case"horizlines":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,614478))).HorizLinePaneView);case"vertlines":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,965690))).VertLinePaneView);case"polygons":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,588892))).PolygonPaneView)
;case"backgrounds":return s((await Promise.all([i.e(63317),i.e(27860),i.e(9517),i.e(20507)]).then(i.bind(i,758989))).BackgroundPaneView)}return null}async function f(e,t,i){const a=[],n=[],s=Object.keys(e.graphicsInfo());s.sort(((e,t)=>m(e)-m(t)));for(const r of s){const s=await d(r,e,t,i);null!==s?(a.push(s.regularPaneView),s.forceOverlayPaneView&&n.push(s.forceOverlayPaneView)):c.has(r)||h.logWarn(`${r} is not supported by this build of graphics subsystem, skipping`)}return{regularPaneViews:a,forceOverlayPaneViews:n}}function m(e){return n.primitivesZOrders.get(e)??0}function p(e){const t=Object.keys(e.graphicsInfo()),i=[];for(const a of t)switch(a){case"hlines":e.graphics().hlines().forEach(((t,n)=>{t.forEach((t=>{void 0!==t.level&&i.push(new u(e,{line:{level:t.level},styleId:n,lineType:a}))}))}));break;case"horizlines":e.graphics().horizlines().forEach(((t,n)=>{t.forEach((t=>{void 0!==t.level&&i.push(new u(e,{line:{level:t.level},styleId:n,lineType:a}))}))}))}return i}},259710:(e,t,i)=>{i.d(t,{makeNextStudyId:()=>r,makeNextSymbolId:()=>n});let a=0;function n(){return a++,"ss_"+a}let s=0;function r(){return s++,"st"+s}},960433:(e,t,i)=>{i.d(t,{TextWidthCache:()=>s,getMinTextMetrics:()=>n});var a=i(850117);function n(e){return{width:e.width,actualBoundingBoxAscent:e.actualBoundingBoxAscent,actualBoundingBoxDescent:e.actualBoundingBoxDescent,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}class s{constructor(e=150){this._fontStyle="",this._cache=new a.CircularCacheBuffer(e,1.5)}reset(){this._cache.clear()}measureText(e,t){return this.getMetrics(e,t).width}yMidCorrection(e,t){const i=this.getMetrics(e,t);return void 0!==i.actualBoundingBoxAscent&&void 0!==i.actualBoundingBoxDescent?(i.actualBoundingBoxAscent-i.actualBoundingBoxDescent)/2:0}getMetrics(e,t){e.font!==this._fontStyle&&(this.reset(),this._fontStyle=e.font);const i=this._cache.get(t);if(void 0!==i)return i;const a=e.textBaseline;e.textBaseline="middle";const s=n(e.measureText(t));return e.textBaseline=a,0===s.width&&t.length||this._cache.set(t,s),s}}},586563:(e,t,i)=>{function a(e){let t;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)t=e;else if(e instanceof Date)t=new Date(e.valueOf());else if(Array.isArray(e)){t=[];let i=0;const n=e.length;for(;i<n;i++)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=a(e[i]))}else{t={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=a(e[i]))}return t}i.d(t,{deepCopy:()=>a})}}]);