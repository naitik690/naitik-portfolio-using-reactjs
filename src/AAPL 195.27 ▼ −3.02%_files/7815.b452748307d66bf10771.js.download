"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[7815],{542301:(t,e,i)=>{i.d(e,{PanePriceAxisView:()=>l});var n=i(960433);class a{constructor(t){this._priceAxisViewRenderer=null,this._rendererOptions=null,this._align="right",this._textWidthCache=t}setParams(t,e,i,n,a){this._priceAxisViewRenderer=t,this._rendererOptions=e,this._align=a}draw(t,e){null!==this._rendererOptions&&null!==this._priceAxisViewRenderer&&this._priceAxisViewRenderer.draw(t,e,this._rendererOptions,this._textWidthCache,this._align)}hitTest(t,e){return void 0===this._priceAxisViewRenderer?.hitTest?null:this._priceAxisViewRenderer?.hitTest(t,e,this._align)}}class l{constructor(t,e,i){this._renderer=null,this._invalidated=!0,this._priceAxisView=t,this._textWidthCache=new n.TextWidthCache(100),this._dataSource=e,this._chartModel=i,this._fontSize=-1,this._panePriceAxisViewRenderer=new a(this._textWidthCache)}update(t){this._invalidated=!0}renderer(t){return this._invalidated&&this._updateImpl(t),this._renderer}_position(){const t=this._chartModel.crosshairSource(),e=this._dataSource===t?t.pane:this._chartModel.paneForSource(this._dataSource);if(null===e)return null;const i=this._priceScale();if(null===i)return null;let n=e.priceScalePosition(i);return"overlay"===n&&(n=e.priceScalePosition(e.defaultPriceScale())),"overlay"===n?null:n}_updateImpl(t){this._renderer=null;const e=this._position();if(null===e)return;const i=this._chartModel.priceAxisRendererOptions();i.fontSize!==this._fontSize&&(this._fontSize=i.fontSize,this._textWidthCache.reset()),this._panePriceAxisViewRenderer.setParams(this._priceAxisView.paneRenderer(),i,t.mediaSize.width,t.mediaSize.height,e),this._renderer=this._panePriceAxisViewRenderer,this._invalidated=!1}_priceScale(){return this._dataSource.priceScale()}}},622393:(t,e,i)=>{i.d(e,{applyColor:()=>r});var n=i(283873),a=i(850117),l=i(660603);const s=new WeakMap;function r(t,e,i=0,r=3){const{context:o,bitmapSize:h,mediaSize:d}=t;let c;if((0,n.default)(e))c=e;else if(e.type===l.ColorType.Solid)c=e.color;else{let t=s.get(o);void 0===t&&(t=new a.CircularCacheBuffer(1e3),s.set(o,t));const n=0===i?d.height:h.height,l=`${e.startColor}_${e.endColor}_${n}`;let r=t.get(l);void 0===r&&(r=o.createLinearGradient(0,0,0,n),r.addColorStop(0,e.startColor),r.addColorStop(1,e.endColor),t.set(l,r)),c=r}1&r&&(o.strokeStyle=c),2&r&&(o.fillStyle=c)}},300562:(t,e,i)=>{i.d(e,{PaneRendererArea:()=>r});var n=i(919383),a=i(65840),l=i(338242),s=i(622393);class r extends n.PaneRendererLine{constructor(t){t.forceLineColor=!1,super(t)}_drawImpl(t){const e=this._data;if(0===e.items.length)return;let i=this._data.visibleItemsRange?.startItemIndex??0,r=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(;i<r&&!(0,a.coordinateIsValid)(e.items[i].y);)i++;for(;r>=0&&!(0,a.coordinateIsValid)(e.items[r].y);)r--;if(i>r)return;const{context:o,horizontalPixelRatio:h,verticalPixelRatio:d}=t;o.save(),o.scale(h,d),o.lineCap="round",(0,s.applyColor)(t,e.lineColor,0,1),o.lineWidth=e.lineWidth,(0,
l.setLineStyle)(o,e.lineStyle),o.lineWidth=1;const c=new Map,u=new n.PaneRendererLineItemsIterator(this._data.items,i,r+1,this._data.skipHoles);for(;u.next();){const t=u.currentValue();let i;i=(0,n.isValidPoint)(t)&&t.style?t.style.color:e.lineColor;const a=u.nextValue();if((0,n.isValidPoint)(a)&&a?.style){const e=a.style.color;if(i!==e){const i=c.get(e)??[];i.push(t),c.set(e,i)}}const l=c.get(i)??[];l.push(t),c.set(i,l)}for(const[i,a]of c){o.beginPath();let l=0;for(let t=0;t<a.length;t++){const s=a[t];(0,n.isValidPoint)(s)&&(s.style&&s.style?.color!==i&&(o.moveTo(Math.round(a[l].center),e.bottom),this._walkLine(o,a.slice(l,t),!0,e.bottom,!0),l=t))}if(o.moveTo(Math.round(a[l].center),e.bottom),this._walkLine(o,a.slice(l,a.length),!0,e.bottom,!0),o.closePath(),e.isSeries){const t=o.createLinearGradient(0,0,0,e.bottom);t.addColorStop(0,e.color1),t.addColorStop(1,e.color2),o.fillStyle=t,e.simpleMode=!0}else(0,s.applyColor)(t,i,0,2);o.fill()}o.lineWidth=e.lineWidth,o.restore(),super._drawImpl(t)}}},919383:(t,e,i)=>{i.d(e,{PaneRendererLine:()=>f,PaneRendererLineItemsIterator:()=>_,isValidPoint:()=>u});var n=i(650151),a=i(86441),l=i(204652),s=i(731974),r=i(65840),o=i(338242),h=i(320994),d=i(622393);const c={y:NaN};function u(t){return null!==t&&!isNaN(t.y)}class _{constructor(t,e,i,a){this._calculatedPrev={index:null,currentBreakProcessed:!1,value:null},this._calculatedCurrent={index:null,currentBreakProcessed:!1,value:null},this._calculatedNext={index:null,currentBreakProcessed:!1,value:null},this._preallocatedVariable={index:null,currentBreakProcessed:!1,value:null},t.length&&((0,n.assert)(e<=i,"First index must be less or equal to last index"),(0,n.assert)(e<t.length,"First index must be less then array length"),(0,n.assert)(i<=t.length,"Last index must be less or equal to array length")),this._items=t,this._firstIndexWithRange=e,this._lastIndexWithRange=i,this._skipHoles=a}next(){if(0===this._items.length)return!1;if(null!==this._calculatedNext.index)return null!==this._calculatedNext.value&&(this._calculatedPrev=this._calculatedCurrent,this._calculatedCurrent=this._calculatedNext,this._calculatedNext={index:null,currentBreakProcessed:!1,value:null},!0);let t;this._preallocatedVariable={...this._calculatedCurrent};do{null===this._preallocatedVariable.index?(this._preallocatedVariable.index=this._firstIndexWithRange,this._preallocatedVariable.currentBreakProcessed=!1,t=this._preallocatedVariable.index<this._lastIndexWithRange):(this._incrementPointer(this._preallocatedVariable),t=this._isValidPointer(this._preallocatedVariable)),t&&this._calcVaue(this._preallocatedVariable)}while(t&&this._skipHoles&&!u(this._preallocatedVariable.value));return t&&(this._calculatedPrev=this._calculatedCurrent,this._calculatedCurrent=this._preallocatedVariable,this._calculatedNext={index:null,currentBreakProcessed:!1,value:null}),t}prevValue(){return this._calculatedPrev.value}currentValue(){return(0,n.ensureNotNull)(this._calculatedCurrent.value)}currentValueIsLast(){return(0,
n.ensureNotNull)(this._calculatedCurrent.index)===this._items.length-1}currentValueIsFirst(){return 0===(0,n.ensureNotNull)(this._calculatedCurrent.index)}nextValue(){if(null!==this._calculatedNext.index)return this._calculatedNext.value;let t;this._calculatedNext={...this._calculatedCurrent,value:null};do{this._incrementPointer(this._calculatedNext),t=this._isValidPointer(this._calculatedNext),t?this._calcVaue(this._calculatedNext):this._calculatedNext.value=null}while(t&&this._skipHoles&&!u(this._calculatedNext.value));return this._calculatedNext.value}atStart(){return this._calculatedCurrent.index===this._firstIndexWithRange&&!this._calculatedCurrent.currentBreakProcessed}atEnd(){const t=(0,n.ensureNotNull)(this._calculatedCurrent.index);return t<this._lastIndexWithRange&&(this._calculatedCurrent.currentBreakProcessed||!this._needBreakBefore(t))}_needBreakBefore(t){return!!this._items[t].breakBefore&&!this._skipHoles}_calcVaue(t){const e=(0,n.ensureNotNull)(t.index);this._needBreakBefore(e)&&!t.currentBreakProcessed?t.value=c:t.value=this._items[e]}_incrementPointer(t){const e=(0,n.ensureNotNull)(t.index);this._needBreakBefore(e)&&!this._calculatedCurrent.currentBreakProcessed?t.currentBreakProcessed=!0:(t.index=e+1,t.currentBreakProcessed=!1)}_isValidPointer(t){const e=(0,n.ensureNotNull)(t.index);return e<this._lastIndexWithRange||e===this._lastIndexWithRange-1&&this._needBreakBefore(e)&&t.currentBreakProcessed}}class f extends h.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t}hitTest(t){const e=(0,r.interactionTolerance)().series+this._data.lineWidth/2;let i=this._data.visibleItemsRange?.startItemIndex??0,n=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(;n-i>2;){const e=Math.round((n+i)/2);this._data.items[e].center<=t.x?i=e:n=e}i=Math.max(1,i-1),n=Math.min(this._data.items.length-1,n+1);for(let r=i;r<=n;++r){const i=this._data.items[r-1],n=this._data.items[r],o=i.center,h=n.center;if((0,l.distanceToSegment)(new a.Point(o,i.y),new a.Point(h,n.y),new a.Point(t.x,t.y)).distance<=e)return this._data.hittest?this._data.hittest:new s.HitTestResult(s.HitTarget.Regular)}return null}_drawImpl(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:n}=t;e.scale(i,n),e.lineCap="round",e.lineJoin="round",(0,d.applyColor)(t,this._data.lineColor,0,3),e.lineWidth=this._data.lineWidth,(0,o.setLineStyle)(e,this._data.lineStyle),(0,r.setValidLineStyle)(e,this._data.lineStyle),this._data.simpleMode?this._drawSimpleMode(t):this._drawLines(e)}_drawSimpleMode(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:n}=t;e.beginPath(),this._walkLine(e,this._data.items,!1,NaN),e.stroke();const a=this._data.lineWidth+2;if(this._data.withMarkers&&2*a<this._data.barSpacing){e.scale(1/i,1/n),(0,d.applyColor)(t,this._data.lineColor,1,2);const l=Math.max(1,Math.floor(i))%2/2,s=a*n+l,r=2*Math.PI;e.beginPath();const o=this._data.visibleItemsRange?.startItemIndex??0;for(let t=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1+1;t-- >=o;){const a=this._data.items[t]
;if(a){const t=Math.round(a.center*i)+l,o=a.y*n;e.moveTo(t,o),e.arc(t,o,s,0,r)}}e.fill()}}_walkLine(t,e,i,n,a){if(!e)return;const l=.25*this._data.barSpacing;let s,r,o=null;const h=a?0:this._data.visibleItemsRange?.startItemIndex??0,d=a?e.length:Math.min(this._data.visibleItemsRange?.endItemIndex??e.length,e.length);if(h>d||h>=e.length)return;const c=new _(e,h,d,this._data.skipHoles);for(;c.next();){if(s=c.currentValue(),r=c.nextValue(),u(s)){const e=Math.round(s.center);o&&u(o)?(t.lineTo(e,s.y),i&&!u(r)&&t.lineTo(e,n)):r&&u(r)?i?(c.atStart()||t.lineTo(e,n),t.lineTo(e,s.y)):t.moveTo(e,s.y):i?(c.atStart()||t.lineTo(e-l,n),t.lineTo(e-l,s.y),t.lineTo(e+l,s.y),t.lineTo(e+l,n)):(t.moveTo(e-l,s.y),t.lineTo(e+l,s.y))}o=s}}_drawLines(t){if(!this._data.items.length)return;let e,i,n=null;const a=.25*this._data.barSpacing;t.beginPath();const l=this._data.visibleItemsRange?.startItemIndex??0,s=this._data.visibleItemsRange?.endItemIndex??this._data.items.length;if(l>s||l>=this._data.items.length)return;const o=this._data.items[l];o&&t.moveTo(o.center,o.y);let h,d=t.strokeStyle,c=t.lineWidth;const f=new _(this._data.items,l,s,this._data.skipHoles);for(;f.next();){let l,s,o;n=f.prevValue(),e=f.currentValue(),i=f.nextValue();let _=!1;if(u(e)&&(e.style&&!this._data.forceLineColor?(l=e.style.color,s=e.style.width,o=e.style.style):(l=this._data.lineColor,s=this._data.lineWidth,o=this._data.lineStyle),this._data.ignorePaletteLineWidth&&(s=this._data.lineWidth),_=l!==d||s!==c||o!==h),_)if(d=l,c=s,h=o,t.stroke(),t.beginPath(),t.strokeStyle=l,t.lineWidth=s,(0,r.setValidLineStyle)(t,o),u(n))t.moveTo(n.center,n.y);else{const i=e;t.moveTo(i.center,i.y)}m=n,x=i,u(p=e)&&(u(m)?t.lineTo(p.center,p.y):x&&u(x)?t.moveTo(p.center,p.y):(t.moveTo(p.center-a,p.y),t.lineTo(p.center+a,p.y)))}var m,p,x;t.stroke()}}},255143:(t,e,i)=>{i.d(e,{PaneRendererStepLine:()=>p,StepLineDecoration:()=>n});var n,a=i(204652),l=i(86441),s=i(731974),r=i(65840),o=i(338242),h=i(320994),d=i(919383),c=i(622393);!function(t){t[t.None=0]="None",t[t.Diamonds=1]="Diamonds"}(n||(n={}));class u{constructor(t){this._forceExtendFirstBar=!!t}initialize(t,e,i){const{context:n,horizontalPixelRatio:a,verticalPixelRatio:l}=e,s=t.lineStyle;n.lineCap="butt",n.lineJoin="round";const r=Math.max(Math.floor(i.style?.width??t.lineWidth*a));void 0!==s&&(0,o.setLineStyle)(n,s);const h=r%2?.5:0;n.moveTo(Math.round(i.center*a)+h,Math.round(i.y*l)+h),(0,c.applyColor)(e,i.style?.color??t.lineColor,1,1),n.lineWidth=r}startFragment(t,e,i,n){t.beginPath();const a=i.firstItem&&i.extendToBarsEndings?e.center:e.left;t.moveTo(isNaN(a)?-50:a,e.y)}finishFragment(t,e,i){e&&i&&t.lineTo(e.left,i.y),t.stroke()}hitTest(t,e,i,n){if(!(0,d.isValidPoint)(e))return!1;const s=e.style?.width??t.lineWidth,o=(0,r.interactionTolerance)().series+s/2,{left:h,y:c}=e,u=isNaN(h)?-50:h;let _,f;return i&&(0,d.isValidPoint)(i)?(_=i.left,f=i.y):(_=e.right,f=e.y),!(u<n.x-o&&_<n.x-o||u>n.x+o&&_>n.x+o)&&((0,a.distanceToSegment)((0,l.point)(u,c),(0,l.point)(_,c),n).distance<o||c!==f&&(0,a.distanceToSegment)((0,l.point)(_,c),(0,
l.point)(_,f),n).distance<o)}applyColor(t,e){(0,c.applyColor)(t,e,1,1)}applyLineWidth(t,e){t.lineWidth=e}drawItem(t,e,i,n){const a=t.context;void 0!==n&&a.lineTo(e.left,n.y),a.lineTo(!i.firstItem||i.extendToBarsEndings||this._forceExtendFirstBar?e.left:e.center,e.y),a.lineTo(i.lastItem&&!i.extendToBarsEndings?e.center:e.right,e.y)}}class _{constructor(){this._lineWidth=1,this._initialAlpha=1}initialize(t,e,i){this._initialAlpha=e.context.globalAlpha,this.applyColor(e,i.style?.color??t.lineColor),this._lineWidth=Math.max(Math.floor(i.style?.width??t.lineWidth*e.horizontalPixelRatio))}startFragment(t,e,i,n){t.beginPath()}finishFragment(t){t.fill()}drawItem(t,e,i,n){if(i.valIsNotSameAsPrev&&!isNaN(e.left)){const i=t.context;i.save(),i.translate(e.left,e.y),i.rotate(Math.PI/4);const n=this._scaleByLineWidth(this._lineWidth);i.scale(n,n),this._drawItemRotatedAndTranslated(t),i.restore()}}applyLineWidth(t,e){this._lineWidth=e}hitTest(t,e,i,n){if(!e.valIsNotSameAsPrev)return!1;const a=n.subtract((0,l.point)(e.left,e.y));return this._hitTestTranslated(a,e.style?.width??t.lineWidth)}_scaleByLineWidth(t){return Math.sqrt(t)}}class f extends _{applyColor(t,e){(0,c.applyColor)(t,e,1,2)}_hitTestTranslated(t,e){return Math.abs(t.x)+Math.abs(t.y)<8*this._scaleByLineWidth(e)/2}_drawItemRotatedAndTranslated(t){(0,o.drawRoundRect)(t.context,-4,-4,8,8,2,!0)}}class m extends _{applyColor(t,e){t.context.globalAlpha=.15*this._initialAlpha,(0,c.applyColor)(t,e,1,2)}_hitTestTranslated(t,e){return Math.abs(t.x)+Math.abs(t.y)<21*this._scaleByLineWidth(e)/2}_drawItemRotatedAndTranslated(t){(0,o.drawRoundRect)(t.context,-10.5,-10.5,21,21,5,!0)}}class p extends h.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._data=t??null}setData(t){this._data=t}hitTest(t){const e=this._data;if(null===e||0===e.items.length)return null;const{items:i,visibleItemsRange:a,skipHoles:l}=e,r=a?.startItemIndex??0,o=a?.endItemIndex??i.length;if(o<=r)return null;const h=e.decoration===n.Diamonds?[new u,new m]:[new u];const c=new d.PaneRendererLineItemsIterator(i,r,o,l);for(;c.next();){const i=c.currentValue(),n=c.nextValue();for(const a of h)if((0,d.isValidPoint)(i)&&a.hitTest(e,i,(0,d.isValidPoint)(n)?n:null,t))return new s.HitTestResult(s.HitTarget.Regular)}return null}_drawImpl(t){if(null===this._data||0===this._data.items.length)return;(this._data.decoration===n.Diamonds?[new u(!0),new f,new m]:[new u]).forEach((e=>this._drawDecorationItem(t,e)))}_drawDecorationItem(t,e){if(null===this._data||0===this._data.items.length)return;const{lineWidth:i,lineColor:n,items:a,visibleItemsRange:l,skipHoles:s,extendToBarsEndings:r}=this._data,{context:o,horizontalPixelRatio:h,verticalPixelRatio:c}=t;let u=Math.max(Math.floor((a[0].style?.width??i)*h)),_=u%2?.5:0;e.initialize(this._data,t,a[0]);const f=l?.startItemIndex??0,m=l?.endItemIndex??a.length;if(m<=f)return;let p,x,g;o.beginPath(),e.applyColor(t,a[f].style?.color??n),e.applyLineWidth(o,u);let y=!1;const I=new d.PaneRendererLineItemsIterator(a,f,m,s);for(;I.next();){const a=I.currentValue();if(!(0,
d.isValidPoint)(a)){p=void 0,y=!0;continue}const l=a.style?.color??n,s=a.style?.width??i,f=l!==x,m=s!==g,v={firstItem:I.currentValueIsFirst(),lastItem:I.currentValueIsLast(),extendToBarsEndings:r,valIsNotSameAsPrev:a.valIsNotSameAsPrev},P={y:Math.round(a.y*c)+_,left:Math.round(a.left*h)+_,center:Math.round(a.center*h)+_,right:Math.round(a.right*h)+_};(f||m||y)&&(x&&g&&e.finishFragment(o,P,p),f&&e.applyColor(t,l),m&&(u=Math.max(1,Math.floor(s*h)),_=u%2?.5:0,e.applyLineWidth(o,u)),e.startFragment(o,P,v,p),y=!1,x=l,g=s),e.drawItem(t,P,v,p),p=P}e.finishFragment(o)}}},975022:(t,e,i)=>{i.d(e,{SelectionIndexes:()=>a});var n=i(650151);class a{constructor(t){this._baseIndex=null,this._offsetInBar=null,this._offsetInTime=null,this._barsBetweenPoints=null,this._timescale=t}indexes(){const t=this._timescale.visibleBarsStrictRange();if(null===t)return[];const e=t.firstBar(),i=t.lastBar();if(null===this._offsetInTime||null===this._barsBetweenPoints){const t=this._timescale.barSpacing();this._barsBetweenPoints=Math.floor(120/t),this._offsetInBar=i%this._barsBetweenPoints,this._offsetInTime=this._timescale.indexToTimePoint(this._offsetInBar),this._baseIndex=this._timescale.baseIndex()}const a=this._timescale.baseIndex();this._baseIndex!==a&&(this._baseIndex=a,this._offsetInBar=(0,n.ensureNotNull)(this._timescale.timePointToIndex(this._offsetInTime)));const l=(0,n.ensureNotNull)(this._offsetInBar),s=[];let r=Math.floor((e-l)/this._barsBetweenPoints);const o=Math.floor((i-l)/this._barsBetweenPoints);for(;r<=o;r++)s.push(l+r*this._barsBetweenPoints);return s}clear(){this._offsetInBar=null,this._offsetInTime=null,this._baseIndex=null,this._barsBetweenPoints=null}}},123003:(t,e,i)=>{function n(t){t.lineWidth=void 0,t.lineStyle=void 0;for(let e=0;e<t.colors.length;e++)t.colors[e]=void 0;return t}function a(){return{colors:[void 0,void 0,void 0,void 0,void 0,void 0,void 0],lineWidth:void 0,lineStyle:void 0}}i.d(e,{clearStyle:()=>n,createEmptyStyle:()=>a})},564079:(t,e,i)=>{i.d(e,{PaneRendererColumns:()=>l});var n=i(320994),a=i(731974);class l extends n.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._precalculatedCache=[],this.setData(t)}setData(t){this._data=t,this._precalculatedCache=[]}hitTest(t){if(null===this._data)return null;const e=this._data.visibleItemsRange?.startItemIndex??0,i=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let n=e;n<=i;n++){const e=this._data.items[n];if(t.x>=e.left&&t.x<=e.right){const i=e.y;if(t.y>=Math.min(i,this._data.histogramBase)&&t.y<=Math.max(i,this._data.histogramBase))return new a.HitTestResult(a.HitTarget.Regular)}}return null}_drawImpl(t){if(null===this._data||0===this._data.items.length)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:n}=t;this._precalculatedCache.length||this._fillPrecalculatedCache(i)
;const a=Math.max(1,Math.floor(i)),l=Math.max(1,Math.floor(n)),s=Math.round(this._data.histogramBase*n)-Math.floor(a/2),r=s+a,o=this._data.lineColor,h=this._data.visibleItemsRange?.startItemIndex??0,d=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let t=h;t<=d;t++){const i=this._data.items[t],a=this._precalculatedCache[t-h],d=Math.round(i.y*n);let c,u;e.fillStyle=i.style?i.style.color:o,d<=s?(c=d,u=r):(c=s,u=d-Math.floor(l/2)+l),e.fillRect(a.left,c,a.right-a.left+1,u-c)}}_fillPrecalculatedCache(t){if(null===this._data||0===this._data.items.length)return void(this._precalculatedCache=[]);const{barSpacing:e,visibleItemsRange:i,items:n}=this._data,a=Math.ceil(e*t)<=1?0:Math.max(1,Math.floor(t)),l=i?.startItemIndex??0,s=(i?.endItemIndex??n.length)-1,r=s-l+1;if(r<=0)return void(this._precalculatedCache=[]);this._precalculatedCache=new Array(r);for(let e=l;e<=s;e++){const i=n[e],s=Math.round(i.center*t);let r,o;const h=Math.round((i.right-i.left)*t)-a;if(h%2){const t=(h-1)/2;r=s-t,o=s+t}else{const t=h/2;r=s-t,o=s+t-1}this._precalculatedCache[e-l]={left:r,right:o,roundedCenter:s,center:i.center*t,time:i.timePointIndex}}for(let t=l+1;t<=s;t++){const e=this._precalculatedCache[t-l],i=this._precalculatedCache[t-l-1];e.time===i.time+1&&(e.left-i.right!==a+1&&(i.roundedCenter>i.center?i.right=e.left-a-1:e.left=i.right+a+1))}let o=Math.ceil(e*t);for(let t=l+1;t<=s;t++){const e=this._precalculatedCache[t-l];e.right<e.left&&(e.right=e.left);const i=e.right-e.left+1;o=Math.min(i,o)}if(a>0&&o<4)for(let t=l+1;t<=s;t++){const e=this._precalculatedCache[t-l];e.right-e.left+1>o&&(e.roundedCenter>e.center?e.right-=1:e.left+=1)}}}},723655:(t,e,i)=>{i.d(e,{createStudyPlotColorProvider:()=>_});var n=i(974145),a=i(650151),l=i(123003);const s=new Map([[0,"color"],[2,"textColor"],[3,"borderColor"],[4,"wickColor"],[5,"colorup"],[6,"colordown"]]);class r{constructor(t){this._plotStyle=t}getPlotPointStyle(t,e){const i=e?(0,l.clearStyle)(e):(0,l.createEmptyStyle)();return s.forEach(((t,e)=>{this._plotStyle[t]&&(i.colors[e]=this._plotStyle[t].value())})),i.lineWidth=this._plotStyle.linewidth?this._plotStyle.linewidth.value():void 0,i.lineStyle=this._plotStyle.linestyle?this._plotStyle.linestyle.value():void 0,i}isColorDefined(){return!0}singleColor(){return!0}getDefaultPlotPointStyle(){return null}}const o=[0,1,2,3,4,5,6];class h{constructor(t,e,i,n){this._palettesColors=new Map,this._defaultPlotColors=new Map,this._indexes=n;const l=e.styles[i];if(l)for(const[t,e]of s)this._defaultPlotColors.set(t,l[e]);const r=(0,a.ensureDefined)(t.palettes),o=t.plots;n.forEach(((t,i)=>{const n=o[t];if(n&&"palette"in n){const t=r[n.palette],a=e.palettes[n.palette];if(t&&a){const{valToIndex:e}=t,{colors:n}=a,l={...n};e&&Object.keys(e).forEach((t=>{const i=e[t];void 0!==i&&(l[t]=n[i])})),this._palettesColors.set(i,l)}}}))}getPlotPointStyle(t,e){const i=e?(0,l.clearStyle)(e):(0,l.createEmptyStyle)();return o.forEach((e=>{if(this._palettesColors.has(e)){const n=t[(0,a.ensureDefined)(this._indexes.get(e))+1];if("number"==typeof n){
const t=this._palettesColors.get(e)?.[n];0===e&&t&&(i.lineWidth=t.width.value(),i.lineStyle=t.style.value()),i.colors[e]=t?.color.value()}else i.colors[e]="transparent"}else i.colors[e]=this._defaultPlotColors.get(e)?.value()})),i}getDefaultPlotPointStyle(){const t=this._palettesColors.get(0)?.[0];if(void 0!==t){return{colors:[t.color.value(),void 0,void 0,void 0,void 0,void 0,void 0],lineStyle:void 0,lineWidth:t.width.value()}}return null}isColorDefined(){return!!this._palettesColors.size}singleColor(){return!1}}var d=i(762003);class c{constructor(t){this._rgbaFromInteger=(0,d.rgbaFromIntegerCached)(),this._indexes=t}getPlotPointStyle(t,e){const i=e?(0,l.clearStyle)(e):(0,l.createEmptyStyle)();return this._indexes.forEach(((e,n)=>{const a=t[e+1];if(null!=a){const t=this._rgbaFromInteger(a);i.colors[n]=t}else i.colors[n]="transparent"})),i}isColorDefined(){return!0}singleColor(){return!1}getDefaultPlotPointStyle(){return null}}const u=new Map([[0,function(t,e){const i=(0,n.isColorerPlot)(e)||(0,n.isOhlcColorerPlot)(e);return"target"in e&&e.target===t&&i}],[2,function(t,e){const i=(0,n.isTextColorerPlot)(e);return"target"in e&&e.target===t&&i}],[1,function(t,e){return(0,n.isBgColorerPlot)(e)&&e.id===t}],[3,function(t,e){const i=(0,n.isCandleBorderColorerPlot)(e);return"target"in e&&e.target===t&&i}],[4,function(t,e){const i=(0,n.isCandleWickColorerPlot)(e);return"target"in e&&e.target===t&&i}],[5,function(t,e){const i=(0,n.isUpColorerPlot)(e);return"target"in e&&e.target===t&&i}],[6,function(t,e){const i=(0,n.isDownColorerPlot)(e);return"target"in e&&e.target===t&&i}]]);function _(t,e,i){const{colorers:n}=function(t,e){const i=t.plots,n=i.findIndex((t=>t.id===e)),a=new Map;return i.forEach(((t,i)=>{u.forEach(((n,l)=>{n(e,t)&&a.set(l,i)}))})),{plotIndex:-1===n?null:n,colorers:a}}(t,i);if(n.size)return t.isRGB?new c(n):new h(t,e,i,n);{const t=e.ohlcPlots;if(t&&t[i])return new r(t[i]);const n=e.styles[i];return new r(n)}}},762003:(t,e,i)=>{i.d(e,{rgbaFromIntegerCached:()=>s});var n=i(259332),a=i(534328),l=i(850117);function s(t=1e3){const e=n.default.Cache;n.default.Cache=l.CircularCacheBuffer.bind(l.CircularCacheBuffer,t);const i=(0,n.default)(a.rgbaFromInteger);return n.default.Cache=e,i}}}]);