(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[88102],{507458:(e,t,i)=>{"use strict";function s(){return navigator.androidClipboard??navigator.clipboard}function n(e){return r(e,null)}function r(e,t){const i=e.files&&e.files.length>0;if(!i&&t&&t.eventPhase>0)return o(t,e),Promise.resolve();if(!i){let t=!1;const i=i=>{i.stopImmediatePropagation(),o(i,e),t=!0};try{document.addEventListener("copy",i,!0),document.execCommand("copy")}finally{document.removeEventListener("copy",i,!0)}if(t)return Promise.resolve()}return async function(e){const t=s();if(!t||!t.write||!window.ClipboardItem)throw new DOMException("ClipboardApi is not supported","NotSupportedError");const i={};for(const t of e.files||[])i[t.type]=t;e.text&&(i["text/plain"]=e.text);e.html&&(i["text/html"]=e.html);return t.write([new window.ClipboardItem(i)])}(e)}function o(e,t){e.preventDefault();const i=e.clipboardData;t.text&&i.setData("text/plain",t.text),t.html&&i.setData("text/html",t.html)}async function a(e,t){const i=s();if("text/plain"===t&&!i.write){const t=await e;return i.writeText(await t.text())}if(!i||!i.write||!window.ClipboardItem)throw new DOMException("ClipboardApi is not supported","NotSupportedError");let n=null;try{n=new window.ClipboardItem({[t]:e})}catch(i){n=new window.ClipboardItem({[t]:await e})}if(n)return i.write([n]);throw new Error("ClipboardApi is not supported")}i.r(t),i.d(t,{copyToClipboard:()=>n,getClipboard:()=>s,writeImpl:()=>r,writePromiseUsingApi:()=>a})},351440:(e,t,i)=>{"use strict";async function s(){return Promise.all([i.e(33334),i.e(98185),i.e(18883),i.e(15371),i.e(32937),i.e(46195),i.e(87833),i.e(38452),i.e(56963),i.e(32227),i.e(62526),i.e(97486)]).then(i.bind(i,826618))}i.d(t,{importPopupRender:()=>s})},613122:(e,t,i)=>{"use strict";i.r(t),i.d(t,{closeCurrentPublicationViewPopup:()=>u,getPublicationType:()=>o,importEntryComponent:()=>a,openPublicationViewPopup:()=>d,preloadPublicationViewPopup:()=>h});var s=i(783359),n=i(351440);const r=new Set([s.ScriptType.Indicator,s.ScriptType.Library,s.ScriptType.Strategy,"indicator","library","strategy"]);function o({isVideo:e,isScript:t,scriptType:i}){switch(!0){case e:return"video";case t:case r.has(i||""):return"script";default:return"idea"}}async function a(e){switch(e){case"video":
return Promise.all([i.e(35527),i.e(92537),i.e(39759),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(22956),i.e(63039),i.e(90579),i.e(6612),i.e(11069),i.e(61171),i.e(19190),i.e(67780),i.e(20563),i.e(95679),i.e(65161),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(43329),i.e(38452),i.e(38752),i.e(40887),i.e(93240),i.e(98681),i.e(19715),i.e(9123),i.e(71803),i.e(15708),i.e(49760),i.e(54320),i.e(82279),i.e(27702),i.e(14100),i.e(38490),i.e(87265),i.e(59546),i.e(55033),i.e(82332),i.e(78836),i.e(78257),i.e(38110),i.e(6061),i.e(18639),i.e(92874),i.e(84777),i.e(14405),i.e(16990),i.e(42893),i.e(33289),i.e(85014),i.e(98559),i.e(92400),i.e(42486),i.e(59878),i.e(76615),i.e(48598),i.e(1508),i.e(32299),i.e(96908),i.e(52165),i.e(80226),i.e(91961),i.e(95542),i.e(53387),i.e(4198),i.e(95330),i.e(98392),i.e(97281),i.e(67272),i.e(59620),i.e(20446),i.e(72066),i.e(66625),i.e(32227),i.e(47793),i.e(24951),i.e(82043),i.e(73248),i.e(82687),i.e(37009),i.e(12205),i.e(62316),i.e(19556),i.e(70901),i.e(23479),i.e(4358),i.e(83263),i.e(57382),i.e(97071)]).then(i.bind(i,49869)).then((e=>e.PublicationViewVideo));case"script":return Promise.all([i.e(49563),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(22956),i.e(61681),i.e(63039),i.e(90579),i.e(6612),i.e(11069),i.e(50874),i.e(65743),i.e(61171),i.e(19190),i.e(67780),i.e(20563),i.e(95679),i.e(65161),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(43329),i.e(38452),i.e(98158),i.e(38752),i.e(40887),i.e(84587),i.e(93240),i.e(98681),i.e(34002),i.e(92990),i.e(19715),i.e(9123),i.e(71803),i.e(82870),i.e(15708),i.e(49760),i.e(54320),i.e(82279),i.e(27702),i.e(14100),i.e(38490),i.e(87265),i.e(59546),i.e(55033),i.e(82332),i.e(78836),i.e(78257),i.e(38110),i.e(6061),i.e(18639),i.e(92874),i.e(84777),i.e(14405),i.e(16990),i.e(42893),i.e(33289),i.e(85014),i.e(98559),i.e(92400),i.e(42486),i.e(59878),i.e(76615),i.e(48598),i.e(1508),i.e(32299),i.e(96908),i.e(52165),i.e(80226),i.e(91961),i.e(95542),i.e(53387),i.e(4198),i.e(95330),i.e(98392),i.e(97281),i.e(67272),i.e(59620),i.e(20446),i.e(38369),i.e(44962),i.e(32227),i.e(47793),i.e(24951),i.e(82043),i.e(73248),i.e(82687),i.e(37009),i.e(12205),i.e(62316),i.e(99189),i.e(19556),i.e(70901),i.e(23479),i.e(4358),i.e(83263),i.e(32849),i.e(14675)]).then(i.bind(i,349414)).then((e=>e.PublicationViewScript));case"idea":
return Promise.all([i.e(49563),i.e(92537),i.e(98185),i.e(98933),i.e(39759),i.e(52186),i.e(84712),i.e(85902),i.e(7291),i.e(22956),i.e(61681),i.e(63039),i.e(90579),i.e(6612),i.e(11069),i.e(50874),i.e(65743),i.e(61171),i.e(19190),i.e(67780),i.e(20563),i.e(95679),i.e(65161),i.e(87833),i.e(67691),i.e(14391),i.e(76052),i.e(43329),i.e(38452),i.e(98158),i.e(38752),i.e(40887),i.e(84587),i.e(93240),i.e(98681),i.e(34002),i.e(92990),i.e(19715),i.e(9123),i.e(71803),i.e(82870),i.e(15708),i.e(49760),i.e(54320),i.e(82279),i.e(27702),i.e(14100),i.e(38490),i.e(87265),i.e(59546),i.e(55033),i.e(82332),i.e(78836),i.e(78257),i.e(38110),i.e(6061),i.e(18639),i.e(92874),i.e(84777),i.e(14405),i.e(16990),i.e(42893),i.e(33289),i.e(85014),i.e(98559),i.e(92400),i.e(42486),i.e(59878),i.e(76615),i.e(48598),i.e(1508),i.e(32299),i.e(96908),i.e(52165),i.e(80226),i.e(91961),i.e(95542),i.e(53387),i.e(4198),i.e(95330),i.e(98392),i.e(97281),i.e(67272),i.e(59620),i.e(20446),i.e(38369),i.e(44962),i.e(32227),i.e(47793),i.e(24951),i.e(82043),i.e(73248),i.e(82687),i.e(37009),i.e(12205),i.e(62316),i.e(99189),i.e(19556),i.e(70901),i.e(23479),i.e(4358),i.e(83263),i.e(32849),i.e(84822)]).then(i.bind(i,111802)).then((e=>e.PublicationViewIdea))}}let l=!1;async function c(){return l=!0,i.e(58214).then(i.bind(i,661254))}async function u(){if(!l)return;const e=await c();await e.closeCurrentPublicationViewPopup()}async function h(e){c(),(0,n.importPopupRender)(),a(e)}async function d(e){return(await c()).openPublicationViewPopup(e)}},783359:(e,t,i)=>{"use strict";var s,n,r;i.d(t,{CONTAINS_IO_SCRIPT_TAG:()=>o,PublicationMethod:()=>n,ScriptAccessType:()=>s,ScriptType:()=>r}),function(e){e[e.Public=1]="Public",e[e.Protected=2]="Protected",e[e.InviteOnly=3]="InviteOnly"}(s||(s={})),function(e){e[e.New=0]="New",e[e.Edit=1]="Edit",e[e.Update=2]="Update"}(n||(n={})),function(e){e[e.Indicator=1]="Indicator",e[e.Strategy=2]="Strategy",e[e.Library=3]="Library"}(r||(r={}));const o="containsioscript"},196726:(e,t,i)=>{"use strict";function s(e){e.cancelable&&e.preventDefault()}function n(e){return t=>{s(t),e(t)}}i.d(t,{preventDefault:()=>s,wrapHandlerWithPreventEvent:()=>n})},542682:(e,t,i)=>{"use strict";i.d(t,{isTouchEvent:()=>n});var s=i(778785);function n(e){const t=e.sourceCapabilities;let i=t&&t.firesTouchEvents;return void 0===i&&(i=s.touch),i}},104436:(e,t,i)=>{"use strict";var s;i.d(t,{ToolboxType:()=>s}),function(e){e[e.Delete=0]="Delete"}(s||(s={}))},255681:(e,t,i)=>{"use strict";function s(e){return"economic"===e}i.d(t,{isNonTradableSymbolType:()=>s})},454623:(e,t,i)=>{"use strict";i.d(t,{defaultChartWidgetActionsOptions:()=>s});const s={general:!0,mainSeries:!0,mainSeriesTrade:!1,esdStudies:!0,studies:!0,fundamentals:!0,lineTools:!0,publishedCharts:!0,ordersAndPositions:!0,alerts:!0,chartEvents:!0,objectTree:!0,gotoLineTool:!1}},322652:(e,t,i)=>{"use strict";i.d(t,{clipboardDataForSources:()=>l,isLineToolClipboardData:()=>a});var s=i(650151),n=i(816433),r=i(128090),o=i(607683);function a(e){return"drawing"===e.type}function l(e,t){if(1===t.length&&(0,r.isStudy)(t[0])){
const e=t[0];return{title:e.title(n.TitleDisplayTarget.StatusLine),sources:[{source:(0,s.ensureNotNull)(e.state()),type:"study"}]}}const i={sources:[],title:""};return i.sources=t.filter((e=>e.copiable()&&(0,o.isLineTool)(e))).map((t=>{const i={type:"drawing",geometry:t.geometry(),source:{...t.state(!1),points:t.normalizedPoints()},modelId:e};return delete i.source.alertId,i})),i.sources.length>0?(1===i.sources.length?i.title=t[0].title(n.TitleDisplayTarget.StatusLine):i.title="Drawings",i):null}},395081:(e,t,i)=>{"use strict";var s;i.d(t,{TabNames:()=>s}),function(e){e.background="Background",e.coordinates="Coordinates",e.drawings="Drawings",e.events="Events",e.alerts="Alerts",e.inputs="Inputs",e.properties="Properties",e.scales="Scales",e.legend="Legend",e.sourceCode="Source Code",e.style="Style",e.symbol="Symbol",e.timezoneSessions="Timezone/Sessions",e.trading="Trading",e.visibility="Visibility",e.text="Text"}(s||(s={}))},148828:(e,t,i)=>{"use strict";i.d(t,{getPriceAxisNameInfo:()=>o});const s=["Z","Y","X","W","V","U","T","S"],n=["A","B","C","D","E","F","G","H"];class r{constructor(e){this.label=e}equals(e){return null!==e&&this.label===e.label}}function o(e,t){const i="left"===e?s:n,o=t<i.length?i[t]:"";return new r(o)}},312520:(e,t,i)=>{"use strict";i.d(t,{MouseEventHandler:()=>v,defaultPreventedHandler:()=>p,getClickPosition:()=>d,isTouchMouseEvent:()=>_});var s=i(481251),n=i(650151),r=i(536794),o=i(638456),a=i(196726),l=i(822961);let c=2;const u=o.isSafari?"click":"auxclick",h={treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!1,ignoreClickAndTapOnDblClickOrDblTap:!1};function d(e){if(_(e))return{x:e.clientX,y:e.clientY};if("touches"in(t=e)&&void 0!==t.touches){if(1===e.touches.length){const t=(0,n.ensureNotNull)(e.target).getBoundingClientRect(),i=e.touches[0];return{x:i.clientX-t.left,y:i.clientY-t.top}}return null}var t;return{x:e.offsetX,y:e.offsetY}}function _(e){return"isTouch"in e&&"stylus"in e}function p(e){return t=>{t.preventDefault(),e(t)}}function m(e,t){let i=!1;return{clickOrTap:(...s)=>{t?.()?e.clickOrTap(...s):(i=!1,setTimeout((()=>!i&&e.clickOrTap(...s)),501))},doubleClickOrDoubleTap:(...t)=>{i=!0,e.doubleClickOrDoubleTap?.(...t)}}}class v{constructor(e,t,i){if(this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._touchMoveStartPosition=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._unsubscribePinchEvents=null,this._unsubscribeTargetElementEvents=null,this._pinchInfo=null,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,
this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!o.CheckMobile.iOS(),this._onFirefoxOutsideMouseUp=e=>{this._mouseUpHandler(e)},this._onMobileSafariDoubleClick=e=>{if(this._firesTouchEvents(e)){const t=this._makeCompatEvent(e);if(++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:i}=this._touchMouseMoveWithDownInfo(g(e),this._tapPosition);i<30&&!this._cancelTap&&this._processTouchEvent(t,this._handlers.doubleTapEvent),this._resetTapTimeout()}}else{const t=this._makeCompatEvent(e);if(++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:i}=this._touchMouseMoveWithDownInfo(g(e),this._clickPosition);i<5&&!this._cancelClick&&this._processMouseEvent(t,this._handlers.mouseDoubleClickEvent),this._resetClickTimeout()}}},this._target=e,this._options=(0,r.merge)((0,r.clone)(h),i||{}),this._options.ignoreClickAndTapOnDblClickOrDblTap){if(t.mouseClickEvent&&t.mouseDoubleClickEvent){const e=m({clickOrTap:t.mouseClickEvent.bind(t),doubleClickOrDoubleTap:t.mouseDoubleClickEvent.bind(t)});t.mouseClickEvent=e.clickOrTap,t.mouseDoubleClickEvent=e.doubleClickOrDoubleTap}if(t.tapEvent&&t.doubleTapEvent){const e=m({clickOrTap:t.tapEvent.bind(t),doubleClickOrDoubleTap:t.doubleTapEvent.bind(t)});t.tapEvent=e.clickOrTap,t.doubleTapEvent=e.doubleClickOrDoubleTap}}this._handlers=t,this._init()}destroy(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),null!==this._unsubscribePinchEvents&&(this._unsubscribePinchEvents(),this._unsubscribePinchEvents=null),null!==this._unsubscribeTargetElementEvents&&(this._unsubscribeTargetElementEvents(),this._unsubscribeTargetElementEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()}_mouseEnterHandler(e){this._unsubscribeMousemove&&this._unsubscribeMousemove();const t=this._mouseMoveHandler.bind(this);if(this._unsubscribeMousemove=()=>{this._target.removeEventListener("mousemove",t)},this._target.addEventListener("mousemove",t),this._firesTouchEvents(e))return;const i=this._makeCompatEvent(e);this._processMouseEvent(i,this._handlers.mouseEnterEvent),this._acceptMouseLeave=!0}_resetClickTimeout(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_resetTapTimeout(){
null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_mouseMoveHandler(e){if(this._mousePressed||null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.mouseMoveEvent),this._acceptMouseLeave=!0}_touchMoveHandler(e){const t=x(e.changedTouches,(0,n.ensureNotNull)(this._activeTouchId));if(null===t)return;if(this._lastTouchEventTimeStamp=T(e),null!==this._pinchInfo)return;if(this._preventTouchDragProcess)return;this._pinchPrevented=!0;const i=this._touchMouseMoveWithDownInfo(g(t),(0,n.ensureNotNull)(this._touchMoveStartPosition)),{xOffset:s,yOffset:r,manhattanDistance:o}=i;if(this._touchMoveExceededManhattanDistance||!(o<5)){if(!this._touchMoveExceededManhattanDistance){const e=.5*s,t=r>=e&&!this._options.treatVertTouchDragAsPageScroll,i=e>r&&!this._options.treatHorzTouchDragAsPageScroll;t||i||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}if(!this._preventTouchDragProcess){const i=this._makeCompatEvent(e,t);this._processTouchEvent(i,this._handlers.touchMoveEvent),(0,a.preventDefault)(e)}}}_mouseMoveWithDownHandler(e){if(0!==e.button)return;if(this._options.isMouseMoveHandlingEnabled&&!this._options.isMouseMoveHandlingEnabled?.())return;const t=this._touchMouseMoveWithDownInfo(g(e),(0,n.ensureNotNull)(this._mouseMoveStartPosition)),{manhattanDistance:i}=t;if(i>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick){const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.pressedMouseMoveEvent)}}_touchMouseMoveWithDownInfo(e,t){const i=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);return{xOffset:i,yOffset:s,manhattanDistance:i+s}}_touchEndHandler(e){let t=x(e.changedTouches,(0,n.ensureNotNull)(this._activeTouchId));if(null===t&&0===e.touches.length&&(t=e.changedTouches[0]),null===t)return;this._activeTouchId=null,this._lastTouchEventTimeStamp=T(e),this._clearLongTapTimeout(),this._touchMoveStartPosition=null,this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);const i=this._makeCompatEvent(e,t);if(this._processTouchEvent(i,this._handlers.touchEndEvent),++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:e}=this._touchMouseMoveWithDownInfo(g(t),this._tapPosition);e<30&&!this._cancelTap&&this._processTouchEvent(i,this._handlers.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processTouchEvent(i,this._handlers.tapEvent),this._handlers.tapEvent&&(0,a.preventDefault)(e));0===this._tapCount&&(0,a.preventDefault)(e),0===e.touches.length&&this._longTapActive&&(this._longTapActive=!1,(0,a.preventDefault)(e))}_touchCancelHandler(e){this._touchEndHandler(e)}_mouseUpHandler(e){if(0!==e.button)return;const t=this._makeCompatEvent(e);if(this._mouseMoveStartPosition=null,this._mousePressed=!1,
this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),o.isFF){this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(e))if(this._processMouseEvent(t,this._handlers.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:i}=this._touchMouseMoveWithDownInfo(g(e),this._clickPosition);i<5&&!this._cancelClick&&this._processMouseEvent(t,this._handlers.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processMouseEvent(t,this._handlers.mouseClickEvent)}_clearLongTapTimeout(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}_touchStartHandler(e){if(null!==this._activeTouchId)return this._clearLongTapTimeout(),void this._resetTapTimeout();const t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=T(e);const i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartPosition=g(t),this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{const t=this._touchMoveHandler.bind(this),s=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=()=>{i.removeEventListener("touchmove",t),i.removeEventListener("touchend",s)},i.addEventListener("touchmove",t,{passive:!1}),i.addEventListener("touchend",s,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),240)}const s=this._makeCompatEvent(e,t);this._processTouchEvent(s,this._handlers.touchStartEvent),this._tapTimeoutId||(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapPosition=g(t))}_wheelClickHandler(e){if(1!==e.button)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.wheelClickEvent)}_mouseDownHandler(e){if(0!==e.button)return;if(this._options.isMouseMoveHandlingEnabled&&!this._options.isMouseMoveHandlingEnabled?.())return;const t=this._target.ownerDocument.documentElement;o.isFF&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartPosition=g(e),this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{const e=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=()=>{t.removeEventListener("mousemove",e),t.removeEventListener("mouseup",i)},t.addEventListener("mousemove",e),t.addEventListener("mouseup",i)}if(this._mousePressed=!0,this._firesTouchEvents(e))return;const i=this._makeCompatEvent(e);this._processMouseEvent(i,this._handlers.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickPosition=g(e))}_init(){
const e=this._mouseEnterHandler.bind(this);this._target.addEventListener("mouseenter",e);const t=this._touchCancelHandler.bind(this);this._target.addEventListener("touchcancel",t);{const e=this._target.ownerDocument,t=e=>!e.target||!this._target.contains(e.target),i=e=>{if(!t(e))return;const i=e.changedTouches[0];this._lastTouchEventTimeStamp=T(e),this._processTouchEvent(this._makeCompatEvent(e,i),this._handlers.touchStartOutsideEvent)},s=e=>{t(e)&&!this._firesTouchEvents(e)&&this._processMouseEvent(this._makeCompatEvent(e),this._handlers.mouseDownOutsideEvent)};this._unsubscribeOutsideTouchEvents=()=>{e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=()=>{e.removeEventListener("mousedown",s)},e.addEventListener("mousedown",s),e.addEventListener("touchstart",i,{passive:!0})}o.CheckMobile.iOS()&&(this._unsubscribeMobileSafariEvents=()=>{this._target.removeEventListener("dblclick",this._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick));const i=this._mouseLeaveHandler.bind(this);this._target.addEventListener("mouseleave",i);const s=this._contextMenuHandler.bind(this);this._target.addEventListener("contextmenu",s);const n=this._touchStartHandler.bind(this);let r;this._target.addEventListener("touchstart",n,{passive:!0}),o.isChrome&&(r=e=>{if(1===e.button)return e.preventDefault(),!1},this._target.addEventListener("mousedown",r));const a=this._mouseDownHandler.bind(this);this._target.addEventListener("mousedown",a);const l=this._wheelClickHandler.bind(this);this._target.addEventListener(u,l);const c=()=>{};this._target.addEventListener("touchmove",c,{passive:!1}),this._unsubscribeTargetElementEvents=()=>{this._target.removeEventListener("mouseleave",i),this._target.removeEventListener("contextmenu",s),this._target.removeEventListener("touchstart",n),r&&this._target.removeEventListener("mousedown",r),this._target.removeEventListener("mousedown",a),this._target.removeEventListener(u,l),this._target.removeEventListener("touchmove",c)},this._initPinch()}_initPinch(){if(void 0===this._handlers.pinchStartEvent&&void 0===this._handlers.pinchEvent&&void 0===this._handlers.pinchEndEvent)return;const e=e=>this._checkPinchState(e.touches);this._target.addEventListener("touchstart",e,{passive:!0});const t=e=>{if(null===this._pinchInfo)return;const t=x(e.touches,(0,n.ensureNotNull)(this._activeTouchId)),i=x(e.touches,this._pinchInfo.secondTouchId);if(t&&i&&void 0!==this._handlers.pinchEvent){const{startPinchDistance:s,startPinchMiddlePoint:n}=this._pinchInfo,r=f(t,i)/s,o=b(this._target);this._handlers.pinchEvent(n,{x:t.clientX-o.left,y:t.clientY-o.top},{x:i.clientX-o.left,y:i.clientY-o.top},r),(0,a.preventDefault)(e)}};this._target.addEventListener("touchmove",t,{passive:!1});const i=e=>this._checkPinchState(e.touches);this._target.addEventListener("touchend",i),this._unsubscribePinchEvents=()=>{this._target.removeEventListener("touchstart",e),this._target.removeEventListener("touchmove",t),this._target.addEventListener("touchend",i)}}_checkPinchState(e){
1===e.length&&(this._pinchPrevented=!1),2!==e.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)}_startPinch(e){if(void 0!==this._handlers.pinchStartEvent&&null===this._pinchInfo){const t=b(this._target);let i,s;e[0].identifier===this._activeTouchId?(i=e[0],s=e[1]):(i=e[1],s=e[0]);const n={x:i.clientX-t.left,y:i.clientY-t.top},r={x:s.clientX-t.left,y:s.clientY-t.top},o={x:(n.x+r.x)/2,y:(n.y+r.y)/2};this._handlers.pinchStartEvent(o,n,r,{bothPointsOnTargetElement:this._target.contains(s.target)})&&(this._pinchInfo={startPinchDistance:f(i,s),startPinchMiddlePoint:o,secondTouchId:s.identifier})}this._clearLongTapTimeout()}_stopPinch(){null!==this._pinchInfo&&(this._pinchInfo=null,this._handlers.pinchEndEvent?.())}_mouseLeaveHandler(e){if(this._unsubscribeMousemove&&this._unsubscribeMousemove(),this._firesTouchEvents(e))return;if(!this._acceptMouseLeave)return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.mouseLeaveEvent),this._acceptMouseLeave=!o.CheckMobile.iOS()}_longTapHandler(e){const t=x(e.touches,(0,n.ensureNotNull)(this._activeTouchId));if(null===t)return;const i=this._makeCompatEvent(e,t);this._processTouchEvent(i,this._handlers.longTapEvent),this._processTouchEvent(i,this._handlers.touchContextMenuEvent),this._cancelTap=!0,this._longTapActive=!0}_contextMenuHandler(e){if((0,a.preventDefault)(e),null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.contextMenuEvent),this._cancelClick=!0}_firesTouchEvents(e){return e.sourceCapabilities&&void 0!==e.sourceCapabilities.firesTouchEvents?e.sourceCapabilities.firesTouchEvents:T(e)<this._lastTouchEventTimeStamp+500}_processTouchEvent(e,t){(0,l.setLastMouseOrTouchEventInfo)(e),t&&t.call(this._handlers,e)}_processMouseEvent(e,t){window.TVD&&("mouseenter"===e.srcType||"mousemove"===e.srcType)&&c>0?c--:("mouseleave"!==e.srcType&&(0,l.setLastMouseOrTouchEventInfo)(e),t&&t.call(this._handlers,e))}_makeCompatEvent(e,t){const i=t||e,n=(0,s.default)((()=>this._target.getBoundingClientRect()||{left:0,top:0}));return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,get localX(){return i.clientX-n().left},get localY(){return i.clientY-n().top},ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,isTouch:!e.type.startsWith("mouse")&&"contextmenu"!==e.type&&"click"!==e.type,stylus:"stylus"===t?.touchType,srcType:e.type,target:i.target,view:e.view,preventDefault:()=>{"touchstart"!==e.type&&(0,a.preventDefault)(e)}}}}function b(e){return e.getBoundingClientRect()||{left:0,top:0}}function g(e){return{x:e.pageX,y:e.pageY}}function f(e,t){const i=e.clientX-t.clientX,s=e.clientY-t.clientY;return Math.sqrt(i*i+s*s)}function T(e){return e.timeStamp||performance.now()}function x(e,t){for(let i=0;i<e.length;++i)if(e[i].identifier===t)return e[i];return null}},723809:(e,t,i)=>{"use strict";i.d(t,{showScriptInfoErrorNoticeDialog:()=>r});var s=i(444372),n=i(228931)
;function r(){(0,n.showNoticeDialog)({type:"modal",title:s.t(null,void 0,i(782374)),content:s.t(null,void 0,i(444028))})}},184481:(e,t,i)=>{"use strict";i.d(t,{createTradeContext:()=>n});var s=i(650151);async function n({series:e,isMainChart:t,y:i}){let n=NaN,r=NaN,o="";const a=e.proSymbol(),l=(e.symbolInfo()||{name:null}).name||a,c=e.priceScale();if(i){const t=e.firstValue();n=null!==t?c.coordinateToPrice(i,t):null,o=null!==n?e.formatter().format(n):""}const u=e.bars().last();null!==u&&(r=(0,s.ensure)(u.value[4]));return{symbol:a,displaySymbol:l,value:n,formattedValue:o,last:r,symbolInfoTradable:!!(e.symbolInfo()||{is_tradable:!1}).is_tradable,isMainChart:t}}},699576:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TRADING_SERVICE:()=>n,tradingService:()=>r,waitTradingService:()=>o});var s=i(564894);const n={id:"TradingService"};function r(){return(0,s.hasService)(n)?(0,s.service)(n):null}function o(){return(0,s.waitServiceRegistered)(n)}},747324:(e,t,i)=>{"use strict";i.d(t,{ALERT_LABEL_WIDTH:()=>ve,AlertLabel:()=>Te,isAlertLabel:()=>be});var s=i(650151),n=i(790188),r=i(327052),o=i(239949),a=i(644036),l=i(839800),c=i(905520),u=i(542301),h=i(477786),d=i(388741),_=i(437642),p=i(820028),m=i(347505),v=i(345848),b=i(998193),g=i(86441),f=i(444372),T=i(708162),x=i(731974),w=i(23076),y=i(765935),C=i(5481),P=i(689443),E=i(130595);const S=e=>{if(1!==e.length)return{title:f.t(null,void 0,i(423481)),text:f.t(null,void 0,i(955138)),mainButtonText:f.t(null,void 0,i(14180)),isDangerAction:!0};const t=e[0],s=(0,P.getAlertDescription)(t);return{title:f.t(null,void 0,i(2376)),text:f.t(null,void 0,i(332063)).format({alert:(0,E.cutString)(s,100)}),mainButtonText:f.t(null,void 0,i(14180)),isDangerAction:!0}};var M,I=i(257145),A=i(338242),k=i(320994),D=i(65840);!function(e){e[e.ConnectorOffsetFromPriceScale=37]="ConnectorOffsetFromPriceScale",e[e.ConnectorCircleRadius=4]="ConnectorCircleRadius"}(M||(M={}));class R extends k.BitmapCoordinatesPaneRenderer{constructor(e){super(),this._data=e}hitTest(e,t){const i=(0,D.interactionTolerance)().line;for(let s=0;s<this._data.levels.length;s++){const n=this._data.levels[s],[r,o]=this._calculateLeftRight(this._data,n,t.mediaSize.width,1),a=Math.min(r,o),l=Math.max(r,o);if(Math.abs(n.y-e.y)<=i&&e.x>=a&&e.x<=l)return new x.HitTestResult(x.HitTarget.MovePoint,{activeItem:s,hideCrosshairLinesOnHover:!0,areaName:x.AreaName.Line,cursorType:y.PaneCursorType.VerticalResize})}const s=this._data.levels.map((e=>e.y)),n=Math.min(...s),r=Math.max(...s),o=Math.round(this._data.isLeft?M.ConnectorOffsetFromPriceScale:t.mediaSize.width-M.ConnectorOffsetFromPriceScale);if(Math.abs(o-e.x)<i&&e.y>=n&&e.y<=r){const t=s.reduce(((t,i,s)=>{const n=Math.abs(t.level-e.y);return Math.abs(i-e.y)<n?{index:s,level:i}:t}),{index:0,level:s[0]});return new x.HitTestResult(x.HitTarget.MovePoint,{activeItem:t.index,hideCrosshairLinesOnHover:!0,areaName:x.AreaName.Line,cursorType:y.PaneCursorType.VerticalResize})}return null}_drawImpl(e){const t=e.context;if(t.lineWidth=Math.max(1,Math.floor(e.verticalPixelRatio)),
t.strokeStyle=this._data.color,(0,A.setLineStyle)(t,I.LINESTYLE_DASHED),this._data.levels.forEach((i=>{const s=Math.round(i.y*e.verticalPixelRatio),[n,r]=this._calculateLeftRight(this._data,i,e.bitmapSize.width,e.horizontalPixelRatio);(0,A.drawHorizontalLine)(t,s,n,r)})),this._data.withConnector&&this._data.levels.length>1){const i=Math.round(this._data.isLeft?M.ConnectorOffsetFromPriceScale*e.horizontalPixelRatio:e.bitmapSize.width-M.ConnectorOffsetFromPriceScale*e.horizontalPixelRatio)+.5,s=this._data.levels.map((e=>e.y)),n=Math.min(...s),r=Math.max(...s);t.beginPath(),t.moveTo(i,n*e.verticalPixelRatio),t.lineTo(i,r*e.verticalPixelRatio),t.stroke()}}_calculateLeftRight(e,t,i,s){const n=1===e.levels.length?0:Math.floor(M.ConnectorCircleRadius*s);let r,o;return this._data.isLeft?(o=0,r="full"===t.mode?i:Math.round("toConnector"===t.mode?(M.ConnectorOffsetFromPriceScale-n)*s:this._data.distanceToTooltip*s)):(r="full"===t.mode?0:Math.round("toConnector"===t.mode?i-(M.ConnectorOffsetFromPriceScale-n)*s:i-this._data.distanceToTooltip*s),o=i),[r,o]}}var L=i(934026),N=i(688857),B=i(964401),O=i(910282),V=i(837462),H=i(960433),F=i(660439),W=i(16241);var z=i(30556),U=i(674488);const Y=(0,V.makeFont)(12,O.CHART_FONT_FAMILY),X=" • ",G=(0,B.svgRenderer)(z),q=(0,B.svgRenderer)(U);class Z extends k.BitmapCoordinatesPaneRenderer{constructor(){super(),this._data=null,this._lastPaintTextWidth=null,this._lastPaintPaneWidth=null,this._widthCache=new H.TextWidthCache}setData(e){this._data=e}hitTest(e){const t=this._data;if(null===this._lastPaintTextWidth||!t||null===this._lastPaintPaneWidth)return null;const i=this._lastPaintTextWidth+16+26,s=this._calculatePoint(t,i,this._lastPaintPaneWidth);{const n=new g.Point(s.x-26+i,s.y-9.5),r=n.add(new g.Point(26,19));if((0,L.pointInBox)(e,(0,g.box)(n,r)))return new x.HitTestResult(x.HitTarget.Custom,{activeItem:t.lineIndex,hideCrosshairLinesOnHover:!0,areaName:x.AreaName.Button,cursorType:y.PaneCursorType.Default,clickHandler:t.buttonAction,tapHandler:t.buttonAction})}{const n=new g.Point(s.x,s.y-9.5),r=n.add(new g.Point(i,19));if((0,L.pointInBox)(e,(0,g.box)(n,r)))return new x.HitTestResult(x.HitTarget.MovePoint,{activeItem:t.lineIndex,hideCrosshairLinesOnHover:!0,areaName:x.AreaName.Tooltip,cursorType:y.PaneCursorType.VerticalResize})}return null}_drawImpl(e){const t=this._data;if(!t)return;const i=e.context;this._lastPaintPaneWidth=e.mediaSize.width,i.font=Y;const n=t.text,r=t.additionalText;let o=!1,a=null;r&&(this._lastPaintTextWidth=this._widthCache.measureText(i,n+X+r),a=this._tooltipSizes(e),o=a.contentWidth<=a.maxWidth);let l=n;if(!o&&(this._lastPaintTextWidth=this._widthCache.measureText(i,l),a=this._tooltipSizes(e),a.contentWidth>a.maxWidth)){l=function(e,t,i){const s=(0,F.lowerboundExt)((t=>e.substring(0,t)),t,((t,s)=>i(t===e?e:(0,W.appendEllipsis)(t))<s),0,e.length);return s===e.length?e:(0,W.appendEllipsis)(e.substring(0,s))}(l,a.maxWidth-16-26,(e=>this._widthCache.measureText(i,e)))}const c=(0,
s.ensureNotNull)(a).maxWidth,u=Math.round(c*e.horizontalPixelRatio),h=Math.round(19*e.verticalPixelRatio),d=this._calculatePoint(t,c,this._lastPaintPaneWidth);this._drawBorderAround(t,e,d,u,h,(e=>e.fill())),this._drawButton(t,e,d,u,h),this._drawText(t,e,d,l),o&&this._drawAdditionalText(t,e,d),this._drawBorderAround(t,e,d,u,h,(e=>e.stroke()))}_drawButton(e,t,i,s,n){const r=t.context;i=i.add(new g.Point(s/t.horizontalPixelRatio,0));{const s=Math.round((i.x-26)*t.horizontalPixelRatio)+.5,o=Math.round(i.y*t.verticalPixelRatio-.5*n)+.5;r.fillStyle=e.buttonBackColor,r.fillRect(s,o,26*t.horizontalPixelRatio,n),r.strokeStyle=e.buttonBorderColor,r.lineWidth=Math.max(1,Math.floor(t.verticalPixelRatio)),r.beginPath(),r.moveTo(s,o),r.lineTo(s,o+n),r.stroke()}0===e.buttonType?this._drawIcon(t,i,G,e.lineColor):1===e.buttonType&&this._drawIcon(t,i,q,e.restartIconColor)}_drawIcon(e,t,i,n){const r=e.context,{width:o,height:a}=i.viewBox();r.fillStyle=(0,s.ensureDefined)(n),i.render(r,{targetViewBox:{x:Math.round((t.x-4-o)*e.horizontalPixelRatio),y:Math.round((t.y-a/2)*e.verticalPixelRatio),width:Math.round(o*e.horizontalPixelRatio),height:Math.round(a*e.verticalPixelRatio)},doNotApplyColors:!0})}_tooltipSizes(e){const t=(0,s.ensureNotNull)(this._lastPaintTextWidth)+16+26,i=Math.max(20,.9*(e.mediaSize.width-80));return{contentWidth:t,maxWidth:Math.min(t,i)}}_drawText(e,t,i,s){const n=t.context,r=Math.round((i.x+8)*t.horizontalPixelRatio),o=Math.round((i.y+5)*t.verticalPixelRatio);n.save(),n.translate(r,o),(0,N.drawScaled)(n,t.horizontalPixelRatio,t.verticalPixelRatio,(()=>{n.fillStyle=e.textColor,n.fillText(s,0,0)})),n.restore()}_drawAdditionalText(e,t,i){const n=t.context,r=Math.round(this._widthCache.measureText(n,e.text)*t.horizontalPixelRatio),o=Math.round(this._widthCache.measureText(n,X)*t.horizontalPixelRatio),a=Math.round((i.x+8)*t.horizontalPixelRatio)+r,l=Math.round((i.y+5)*t.verticalPixelRatio);n.save(),n.fillStyle=(0,s.ensureDefined)(e.additionalTextColor),n.translate(a,l),(0,N.drawScaled)(n,t.horizontalPixelRatio,t.verticalPixelRatio,(()=>{n.fillStyle=(0,s.ensureDefined)(e.textColor),n.fillText(X,0,0)})),n.translate(o,0),(0,N.drawScaled)(n,t.horizontalPixelRatio,t.verticalPixelRatio,(()=>{n.fillStyle=(0,s.ensureDefined)(e.additionalTextColor),n.fillText((0,s.ensureDefined)(e.additionalText),0,0)})),n.restore()}_drawBorderAround(e,t,i,s,n,r){const o=t.context,a=Math.round(i.x*t.horizontalPixelRatio)+.5,l=Math.round(i.y*t.verticalPixelRatio-n/2)+.5;o.strokeStyle=e.lineColor,o.lineWidth=Math.max(1,Math.floor(t.verticalPixelRatio));const c=Math.round(4*t.horizontalPixelRatio);o.fillStyle=e.backColor,o.beginPath(),(0,A.drawRoundRect)(o,a,l,s,n,c),r(o)}_calculatePoint(e,t,i){const s=e.point;if(e.center){const n=Math.max(0,.5*(i-t));return e.isLeft?n<s.x?s:new g.Point(n,s.y):n+t<s.x?new g.Point(n,s.y):new g.Point(s.x-t,s.y)}return e.isLeft?s:s.subtract(new g.Point(t,0))}}var j;!function(e){e[e.SelectionPointOffset=37]="SelectionPointOffset",e[e.NoLineModeOffsetSingleLine=47]="NoLineModeOffsetSingleLine",
e[e.NoLineModeOffsetMultipleLines=62]="NoLineModeOffsetMultipleLines"}(j||(j={}));const K=" — ",$=f.t(null,{context:"alert_status"},i(730829)),J=$+K+f.t(null,{context:"alert_status"},i(261129)),Q=$+K+f.t(null,{context:"alert_status"},i(401732)),ee=$+K+f.t(null,{context:"alert_status"},i(660963)),te=new Map([[r.AlertStopReason.Auto,Q],[r.AlertStopReason.Manual,J],[r.AlertStopReason.Expired,ee]]);function ie(e){return void 0!==e?te.get(e):void 0}function se(e,t){switch(e){case r.AlertStopReason.Auto:return t.inActiveTextTriggeredColor;case r.AlertStopReason.Manual:return t.inActiveTextManualColor;case r.AlertStopReason.Expired:return t.inActiveTextExpiredColor;default:return}}class ne{constructor(e,t){this._invalidated=!0,this._compositeRenderer=new T.CompositeRenderer,this._tooltipRenderer=new Z,this._alertLabel=e,this._model=t}update(){this._invalidated=!0}invalidate(){this._model.lightUpdate()}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._compositeRenderer}_updateImpl(){this._compositeRenderer.clear();const e=this._alertLabel,t=e.alert(),i=t.condition();if(null===i)return;const n=(0,s.ensureNotNull)(this._model.paneForSource(e)),r=(0,s.ensureNotNull)(n.mainDataSource()).firstValue();if(null===r||!e.canDrawLabelForAlert())return;const o=(0,s.ensureNotNull)(e.priceScale()),a=e=>o.priceToCoordinate(e,r),l=[];if("channel"===i.type){const e=a(i.upper),t=a(i.lower);l.push(e),l.push(t)}else l.push(a(i.price));const c=e.isSelected(),u=e.isHovered(),h=this._model.lastHittestData(),d=this._model.lastSelectedHittestData();let _=0;u&&(_=h?.activeItem??0),c&&(_=d?.activeItem??0);const p=this._alertLabel.colors(),m=e.labelLineColor(),v=n.leftPriceScales().includes(o),b=1===l.length?j.NoLineModeOffsetSingleLine:j.NoLineModeOffsetMultipleLines;if(e.drawHorzLine()||c||u){const t=l.map(((t,i)=>({y:t,mode:e.drawHorzLine()?"full":i===_&&1===l.length?"toTooltip":"toConnector"})));this._compositeRenderer.append(new R({distanceToTooltip:b,levels:t,color:m,isLeft:v,withConnector:c||u}))}if(c||u){const e=n.height(),t=l.map((t=>this._model.backgroundColorAtYPercentFromTop(t/e))),i=v?j.SelectionPointOffset:n.width()-j.SelectionPointOffset;this._compositeRenderer.append(new w.SelectionRenderer({points:l.map(((e,t)=>({point:new g.Point(i,e),lineWidth:c&&_===t?1.5:void 0,hitTestResult:new x.HitTestResult(x.HitTarget.MovePoint,{activeItem:t,hideCrosshairLinesOnHover:!0,areaName:x.AreaName.Line,cursorType:y.PaneCursorType.VerticalResize})}))),hittestResult:x.HitTarget.MovePoint,bgColors:t,visible:!0,barSpacing:this._model.timeScale().barSpacing()}))}if((c||u)&&!this._alertLabel.isMoving()){const i=u&&h?.areaName===x.AreaName.Button,s=v?b:n.width()-b,r=t.name()||(e.isMoving()?t.defaultDescription():t.description()),o=this._alertLabel.isInactive()?p.inActiveTextBaseColor:m,a=async()=>{const e=this._alertLabel.alert().id().value(),i=this._alertLabel.alert().isNew();e&&!i&&(await(0,C.getAlertsActionCreators)()).deleteAlert(e,{confirmation:S([t]),analytics:{actionLabel:"Alert label source",actionSource:"Chart",
event:"restart"}}).execute()},c=async()=>{const e=this._alertLabel.alert().id().value(),t=this._alertLabel.alert().isNew();e&&!t&&(await(0,C.getAlertsActionCreators)()).restartAlert(e,{analytics:{actionLabel:"Alert label source",actionSource:"Chart",event:"restart"}}).execute()},d=e.stopReason(),f=void 0!==d,T={isLeft:v,point:new g.Point(s,l[_]),lineIndex:_,center:e.drawHorzLine(),text:r,textColor:o,additionalText:ie(d),additionalTextColor:se(d,p),lineColor:m,backColor:p.connectorBackColor,buttonType:f?1:0,buttonBorderColor:p.tooltipButtonBorderColor,buttonBackColor:i?p.tooltipButtonBorderColorHovered:p.connectorBackColor,buttonAction:f?c:a,restartIconColor:f?p.restartIconColor:void 0,themeName:this._model.dark().value()?"dark":"light"};this._tooltipRenderer.setData(T),this._compositeRenderer.append(this._tooltipRenderer)}}}var re=i(534328),oe=i(597331);class ae{constructor(e){this._renderers=e??[]}clear(){this._renderers=[]}add(e){this._renderers.push(e)}draw(e,t,i,s,n){for(const r of this._renderers)r.draw(e,t,i,s,n)}lastDrawnBodyBox(){let e=null;for(const t of this._renderers)if(t.lastDrawnBodyBox){const i=t.lastDrawnBodyBox();if(null!==i){if(null===e){e=i;continue}e=(0,g.box)((0,g.point)(Math.min(e.min.x,i.min.x),Math.min(e.min.y,i.min.y)),(0,g.point)(Math.max(e.max.x,i.max.x),Math.max(e.max.y,i.max.y)))}}return e}hitTest(e,t,i){let s=null;for(let n=this._renderers.length-1;n>=0;n-=1){const r=this._renderers[n].hitTest?.(e,t,i);null!=r&&(null===s||r.target()>s.target())&&(s=r)}return s}topBottomTotalHeight(e){const t={top:0,bottom:0,total:0};for(const i of this._renderers){const s=i.topBottomTotalHeight(e);t.top=Math.max(t.top,s.top),t.bottom=Math.max(t.bottom,s.bottom),t.top=t.top+t.bottom}return t}setData(e,t){for(const i of this._renderers)i.setData(e,t)}}var le=i(322604);const ce=new Path2D("M6.21 5.27 1.68 1.06A1 1 0 0 0 0 1.79v8.42a1 1 0 0 0 1.68.73l4.53-4.2a1 1 0 0 0 0-1.47Z");class ue{constructor(){this._data=null,this._commonData=null,this._bodyBox=null}setData(e,t){this._data=e,this._commonData=t}lastDrawnBodyBox(){return this._bodyBox}draw(e,t,i,s,n){const r=this._data,o=this._commonData;if(!r||!o)return;const a="right"===n,{horizontalPixelRatio:l,verticalPixelRatio:c,bitmapSize:u,mediaSize:h}=t,{borderSize:d}=i,_=a?u.width:Math.max(1,Math.floor(d*l));e.save(),e.fillStyle=r.backgroung??o.background,e.translate(_,Math.round((o.coordinate-6.5+1)*c)),(0,N.drawScaled)(e,a?-l:l,c,(()=>{e.fill(ce)})),e.restore();{const e=a?h.width-7:0;this._bodyBox=(0,g.box)((0,g.point)(e,o.coordinate-6.5),(0,g.point)(e+7,o.coordinate+6.5))}}topBottomTotalHeight(e){return{top:0,bottom:0,total:0}}hitTest(e,t,i){return this._data?(0,le.hittestByData)(this._data,e):null}}var he;!function(e){e[e.IconMinWidth=23]="IconMinWidth"}(he||(he={}));class de extends oe.PriceAxisView{constructor(e,t){super(),this._collapsedAxisRenderer=new ue,this._lastDrawnAxisBox=null,this._lastDrawnPaneBox=null,this._alertLabel=e,this._levelIndex=t,this._collapsedAxisRenderer.setData(this._axisRendererData,this._commonRendererData)}renderer(){
return this._updateRendererDataIfNeeded(),this._rendererImpl()}ignoreAlignment(){return!0}isOutsideOfVisiblePriceRange(){return this._alertLabel.isOutsideOfVisiblePriceRange()}_updateRendererData(e,t,i){if(e.visible=!1,t.visible=!1,!this._alertLabel.labelVisible())return;const s=this._alertLabel.priceScale();if(!s)return;const n=s.mainSource(),r=null!==n?n.firstValue():null;if(s.isEmpty()||null===r)return;const o=this._alertLabel.priceOfLevel(this._levelIndex);if(null===o)return;const a=this._alertLabel.colors(),l=this._alertLabel.labelLineColor();i.background=(0,re.resetTransparency)(l),i.textColor=a.iconColor,i.coordinate=s.priceToCoordinate(o,r);const c=this._alertLabel.animation();if(null!==c){const e=c.data(performance.now());i.globalAlpha=e.alpha}else i.globalAlpha=void 0;e.text=s.formatPrice(o,r);const u=this._rendererImpl().lastDrawnBodyBox?.()??this._lastDrawnAxisBox;this._lastDrawnAxisBox=u??this._lastDrawnAxisBox,this._lastDrawnAxisBox&&(e.hitTestData={hoverModelFromAxis:!0,itemBox:this._lastDrawnAxisBox,activeItem:this._levelIndex});const h=this._paneRenderer.lastDrawnBodyBox?.()??this._lastDrawnPaneBox;this._lastDrawnPaneBox=h??this._lastDrawnPaneBox,this._lastDrawnPaneBox&&(t.hitTestData={hoverModelFromAxis:!0,itemBox:this._lastDrawnPaneBox,activeItem:this._levelIndex}),t.hitTarget=x.HitTarget.MovePoint,e.hitTarget=x.HitTarget.Regular,t.labelIcon=1,t.labelIconMinWidth=he.IconMinWidth,t.visible=!0,e.visible=!0}_rendererImpl(){return null===this._alertLabel.animation()?this._alertLabel.isHovered()||this._alertLabel.isSelected()?this._axisRenderer:this._collapsedAxisRenderer:new ae([this._collapsedAxisRenderer,this._axisRenderer])}}var _e=i(335048);const pe=l.sortSourcesPreOrdered.AlertLabel,me=l.sortSourcesPreOrdered.AlertLabelInactive,ve=5;function be(e){return e instanceof Te}const ge={newAlertColor:(0,n.getHexColorByName)("color-cold-gray-450"),inActiveAlertColor:(0,n.getHexColorByName)("color-cold-gray-600"),inActiveTextBaseColor:(0,n.getHexColorByName)("color-cold-gray-450"),inActiveTextManualColor:(0,n.getHexColorByName)("color-cold-gray-450"),inActiveTextTriggeredColor:(0,n.getHexColorByName)("color-tan-orange-500"),inActiveTextExpiredColor:(0,n.getHexColorByName)("color-ripe-red-500"),connectorBackColor:(0,n.getHexColorByName)("color-cold-gray-900"),iconColor:(0,n.getHexColorByName)("color-cold-gray-900"),restartIconColor:(0,n.getHexColorByName)("color-cold-gray-200"),tooltipButtonBorderColor:(0,n.getHexColorByName)("color-cold-gray-800"),tooltipButtonBorderColorHovered:(0,n.getHexColorByName)("color-cold-gray-800")},fe={newAlertColor:(0,n.getHexColorByName)("color-cold-gray-450"),inActiveAlertColor:(0,n.getHexColorByName)("color-cold-gray-300"),inActiveTextBaseColor:(0,n.getHexColorByName)("color-cold-gray-550"),inActiveTextManualColor:(0,n.getHexColorByName)("color-cold-gray-550"),inActiveTextTriggeredColor:(0,n.getHexColorByName)("color-tan-orange-500"),inActiveTextExpiredColor:(0,n.getHexColorByName)("color-ripe-red-500"),connectorBackColor:(0,n.getHexColorByName)("color-white"),iconColor:(0,
n.getHexColorByName)("color-white"),restartIconColor:(0,n.getHexColorByName)("color-cold-gray-900"),tooltipButtonBorderColor:(0,n.getHexColorByName)("color-cold-gray-100"),tooltipButtonBorderColorHovered:(0,n.getHexColorByName)("color-cold-gray-100")};class Te extends a.DataSource{constructor(e,t,i,n){super(),this._priceAxisViews=[],this._paneLabelsPaneViews=[],this._propertyMock=new c.Property,this._startMovingPoint=null,this._currentMovingPoint=null,this._animation=null,this._isOutsideOfVisiblePriceRange=new p.WatchedValue(!0),this._onConditionChanged=()=>{const e=this.alert().condition(),t=e?"channel"===e.type?2:1:0;if(this._priceAxisViews.length!==t){for(let e=this._priceAxisViews.length;e<t;e++){const t=new de(this,e);this._priceAxisViews.push(t),this._paneLabelsPaneViews.push(new u.PanePriceAxisView(t,this,this._model))}this._priceAxisViews=this._priceAxisViews.slice(0,t),this._paneLabelsPaneViews=this._paneLabelsPaneViews.slice(0,t)}this._priceScale&&this._updatePriceLabelInVisibleRange(this._priceScale.priceRangeInPrice()),this._model.lightUpdate()},this._propertyMock.addProperty("visible",!0),this._model=e,this._alert=t,this._alertOwnerSource=i,this._paneView=new ne(this,e),this._invokeAlertEditor=n,this._resetUserEditEnabled(),this._hasAlert.setValue(!0),this._alertSeriesId=(0,s.ensureNotNull)(t.seriesId()),this._alertId=t.id().spawn(),this._alertId.subscribe(this._resetUserEditEnabled.bind(this)),t.onConditionChanged().subscribe(this,this._onConditionChanged),this._onConditionChanged(),this._isBeingEdited=t.isBeingEdited().spawn(),this._isBeingEdited.subscribe(this._resetUserEditEnabled.bind(this)),this._selected=t.selected().spawn(),this._selected.subscribe(this._onAlertSelectedChanged.bind(this)),this._selected.value()&&this.canDrawLabelForAlert()&&this._selectAlertLabel(),this._localFireTime=t.localFireTime().spawn(),this._localFireTime.subscribe(this._onAlertFireTimeChanged.bind(this),{callWithLast:!0}),(0,b.getLabelsSettingsProperty)().subscribe(this,(()=>e.updateSource(this))),this._active=t.active().spawn(),this._active.subscribe((()=>e.updateSource(this))),this._isOutsideOfVisiblePriceRange.subscribe((()=>e.updateSource(this)))}destroy(){this._alertId.destroy(),this._isBeingEdited.destroy(),this._localFireTime.destroy(),this._active.destroy(),this._selected.destroy(),(0,b.getLabelsSettingsProperty)().unsubscribeAll(this),this._alert.onConditionChanged().unsubscribeAll(this),this._priceScale?.priceRangeChanged().unsubscribeAll(this),super.destroy()}model(){return this._model}zorder(){return this.isInactive()?me:pe}colors(){return{...this._themedColors(),lineColor:this.labelLineColor()}}alertOwnerSource(){return this._alertOwnerSource}alertSeriesId(){return this._alertSeriesId}alignCrossHairToMovePoint(){return!0}name(){return"AlertLabel"}isSpeciallyZOrderedSource(){return!0}stop(){this._alert.id().unsubscribe(this._resetUserEditEnabled),this._alert.isBeingEdited().unsubscribe(this._resetUserEditEnabled),this._alert.selected().unsubscribe(this._onAlertSelectedChanged)}alert(){return this._alert}
isMoving(){return null!==this._startMovingPoint}isHovered(){return this===this._model.hoveredSource()}isSelected(){return this._model.selection().isSelected(this)}alertId(){return this.alert().id().value()}getAlert(){return Promise.resolve(this._alert)}getAlertSync(){return this._alert}priceOfLevel(e){const t=this.alert().condition();return t?"channel"===t.type?[t.upper,t.lower][e]:t.price:null}convertYCoordinateToPriceForMoving(e,t){const i=this.priceScale();if(!t||!i||i.isEmpty())return null;const s=t.firstValue();return null===s?null:i.coordinateToPrice(e,s)}isSynchronizable(){return!1}state(){const e=this.alert().condition(),t=[];return null!==e&&("channel"===e.type?(t.push({price:e.upper}),t.push({price:e.lower})):t.push({price:e.price})),{id:this._id.value(),type:"AlertLabel",zorder:this.zorder(),points:t}}restorePoints(e){}createServerPoints(){}properties(){return this._propertyMock}paneViews(){return window.TradingView.printing||!this.labelVisible()?null:[this._paneView]}topPaneViews(){const e=performance.now();return null!==this._animation&&this._continueOrFinishAnimation(e),!window.TradingView.printing&&this.labelVisible()&&this._animationActive(e)?(this.updateAllViews((0,_.sourceChangeEvent)(this.id())),this._paneLabelsPaneViews):null}dataWindowView(){return null}priceAxisViews(e,t){return!window.TradingView.printing&&this.labelVisible()&&this.priceScale()===t&&!this._animationActive()&&this.canDrawLabelForAlert()?this._priceAxisViews:null}topPriceAxisViews(e,t){const i=performance.now();return null!==this._animation&&this._continueOrFinishAnimation(i),this.priceScale()===t&&this._animationActive(i)&&this.canDrawLabelForAlert()?(this.updateAllViews((0,_.sourceChangeEvent)(this.id())),this._priceAxisViews):[]}updateAllViews(e){this._paneView.update(),this._priceAxisViews.forEach((t=>t.update(e))),this._paneLabelsPaneViews.forEach((t=>t.update(e)))}pointsCount(){return 0}title(){return this.alert().title()}movable(){return!this._alert.isBeingEdited().value()&&!this._alert.isNew()}startMoving(e,t,i,s){this._userEditEnabled=!1,this._startMovingPoint=e,this.alert().startEditing()}move(e,t,i,n){if(!e.logical||null===t)return;const r=e.logical.price,o=this.alert(),a=(0,s.ensureNotNull)(o.condition());if(this._currentMovingPoint={...e},"channel"===a.type){let{upper:e,lower:i}=a;const n=this._alertOwnerSource.base()||100;0===t?(0,s.ensureDefined)(this._currentMovingPoint.logical).price=e=Math.max(r,i+1/n):1===t&&((0,s.ensureDefined)(this._currentMovingPoint.logical).price=i=Math.min(r,e-1/n)),o.setCondition({...a,lower:(0,m.roundAlertValueUsingPrecision)(this._alertOwnerSource,i),upper:(0,m.roundAlertValueUsingPrecision)(this._alertOwnerSource,e)})}else o.setCondition({type:"price",price:(0,m.roundAlertValueUsingPrecision)(this._alertOwnerSource,r)});this.updateAllViews((0,_.sourceChangeEvent)(this.id()))}endMoving(){const e=this._startMovingPoint,t=this._currentMovingPoint;if(this._userEditEnabled=!0,this._startMovingPoint=null,this._currentMovingPoint=null,!e||!t||e===t)return;(0,
v.trackEvent)("chart_alert","edit","move"),this._invokeAlertEditor({dataSourceHub:this._model,alert:this.alert(),type:"edit_alert",onEditCancel:()=>{setTimeout((async()=>{if(this.isInactive()){const e=this.alert().id().value();void 0!==e&&(await(0,C.getAlertsActionCreators)()).restartAlert(e,{analytics:{actionLabel:"Alert label source",actionSource:"Chart",event:"restart"}}).execute()}else this.alert().abortEditing();this._model.lightUpdate()}),0)},silent:!0,actionSource:"alert_label_move",onAborted:()=>this.alert().abortEditing()})}currentMovingPoint(){return this._currentMovingPoint}showInObjectTree(){return!1}isRemovedByStudyTemplates(){return!1}isUserDeletable(){return!1}doesMovingAffectsUndo(){return!1}drawHorzLine(){return this.labelLineVisible()}canDrawLabelForAlert(){const e=this.alert(),t=this._model.mainSeries(),i=t&&t.properties().childs(),s=i&&i.style&&i.style.value(),n=(0,d.isRangeBasedStyle)(s)?s:null,r=e.crossInterval()||h.Interval.isEqual(e.resolution(),t.interval()),o=e.rangeBasedStyle()===n;return e.isPrice()&&r&&o}labelVisible(){const e=this._alertOwnerSource.symbolSource();if(e&&(e.isConvertedToOtherCurrency()||e.isConvertedToOtherUnit()))return!1;if(this._model.isInReplay().value())return!1;if(!this.isInactive())return(0,b.getLabelsSettingsProperty)().childs().visible.value();const t=this.stopReason();return void 0!==t&&(t===r.AlertStopReason.Created||this._animationActive()||!this.showOnlyActive())}labelLineColor(){const e=(0,b.getLabelsSettingsProperty)().childs().line.childs().color.value(),t=e||(0,b.getAlertColorLineByTheme)(this.model());if(null!==this._animation)return(0,s.ensureDefined)(t);const i=this._themedColors();return this._alert.isNew()?(0,s.ensureDefined)(i.newAlertColor):this._alert.active().value()||this._alert.stopReason()===r.AlertStopReason.Created?t:(0,s.ensureDefined)(i.inActiveAlertColor)}labelLineVisible(){return(0,b.getLabelsSettingsProperty)().childs().line.childs().visible.value()}showOnlyActive(){return(0,b.getLabelsSettingsProperty)().childs().showOnlyActive.value()}stopReason(){return this.isInactive()?this._alert.stopReason():void 0}animation(){return this._animation}isInactive(){return!this._alert.active().value()&&!this._alert.isNew()}setPriceScale(e){this._priceScale?.priceRangeChanged().unsubscribeAll(this),e&&(e.priceRangeChanged().subscribe(this,(()=>this._updatePriceLabelInVisibleRange(e.priceRangeInPrice()))),this._updatePriceLabelInVisibleRange(e.priceRangeInPrice())),super.setPriceScale(e)}isOutsideOfVisiblePriceRange(){return this._isOutsideOfVisiblePriceRange.value()}contextMenuStatName(){return"AlertLabelContextMenu"}_updatePriceLabelInVisibleRange(e){this._isOutsideOfVisiblePriceRange.setValue(!!(()=>{if(null===e)return;const t=this.alert().condition();if(!t)return;const{from:i,to:s}=e;return"channel"===t.type?t.upper<i||t.lower>s:t.price<i||t.price>s})())}_themedColors(){return this._model.dark().value()?ge:fe}_resetUserEditEnabled(){const e=this._alert;this._userEditEnabled=!(e.isBeingEdited().value()||e.isNew()||!e.isPrice()||null===e.condition()),
(0,v.trackEvent)("chart_alert","edit",`change_user_edit_enabled to ${this._userEditEnabled} for alert ${e.id().value()}`)}_onAlertSelectedChanged(e){this.canDrawLabelForAlert()&&(e?this._selectAlertLabel():this._unselectAlertLabel())}_selectAlertLabel(){this._model.selectionMacro((e=>{e.selection().isSelected(this)||(e.clearSelection(),e.addSourceToSelection(this))}))}_unselectAlertLabel(){this._model.selectionMacro((e=>{e.selection().isSelected(this)&&e.removeSourceFromSelection(this)}))}_onAlertFireTimeChanged(e){var t,i;null!==e&&(this._animation=(t=e,i=this.isHovered()||this.isSelected()?1:0,{finished:e=>e-t>=2400,data:e=>{const s=Math.min(e-t,2400)%1200,n=s%600,r=Math.round(s/1200),o=(0,_e.easingFunc.linear)(n/600);return{alpha:0===r==(0===i)?o:1-o}}}),this._model.updateSource(this))}_continueOrFinishAnimation(e){(0,s.ensureNotNull)(this._animation).finished(e)?(this._animation=null,this._model.updateSource(this)):this._model.invalidate(o.InvalidationMask.cursor())}_animationActive(e=performance.now()){return null!==this._animation&&!this._animation.finished(e)}}},998193:(e,t,i)=>{"use strict";i.d(t,{getAlertColorLineByTheme:()=>I,getAlertSoundsVolume:()=>M,getLabelsSettingsProperty:()=>C,getNotificationsSettingsProperty:()=>E,restoreSettingsProperty:()=>S});var s=i(23482),n=i(650151),r=i(154834),o=i(650279),a=i(998034),l=i(790188),c=i(62802),u=i(61499),h=i(820028),d=i(905520),_=i(185419),p=i(312692);const m="alertLabels",v="alertNotification";let b,g;const f={visible:!0,showOnlyActive:!0,line:{color:"",visible:!0}},T={hideToasts:!0,sound:{volume:.5,isEnabled:!0}},x=new Map([[u.StdTheme.Light,{line:{color:(0,l.getHexColorByName)("color-cold-gray-900")}}],[u.StdTheme.Dark,{line:{color:(0,l.getHexColorByName)("color-cold-gray-200")}}]]);function w(e,t){let i=(0,c.getJSON)(e,null);null===i&&(i=(0,r.default)(t));const s=(0,p.extractAllPropertiesKeys)(t),n=(0,p.extractAllPropertiesKeys)(i);if(!(0,o.default)(s,n)){const e=(0,p.extractState)(i,s);i=(0,a.default)((0,r.default)(t),e)}return i}function y(){b&&(0,c.setJSON)(m,b.state())}function C(){return b||(b=new d.Property(w(m,f)),b.subscribe(null,y),c.onSync.subscribe(null,(()=>{b.mergeAndFire(w(m,f))})),b)}function P(){g&&(0,c.setJSON)(v,g.state())}function E(){return g||(g=new d.Property(w(v,T)),g.subscribe(null,P),c.onSync.subscribe(null,(()=>{g.mergeAndFire(w(v,T))})),g)}function S(){b&&b.mergeAndFire(f),g&&g.mergeAndFire(T)}function M(){if(s.isIOS)return new h.WatchedValue(1).spawn();const e=E().childs().sound.childs(),t=(0,_.combineProperty)(((e,t)=>e?t:0),e.isEnabled.weakReference(),e.volume.weakReference());return(0,_.createWVFromProperty)(t)}function I(e){const t=e.dark().value()?u.StdTheme.Dark:u.StdTheme.Light;return(0,n.ensureDefined)(x.get(t)).line.color}},738834:(e,t,i)=>{"use strict";i.d(t,{BarsMarksContainer:()=>p});var s=i(650151),n=i(735566),r=i(62802),o=i(213377),a=i(477786),l=i(536794),c=i(388741),u=i(644036),h=i(437642);const d=(0,n.getLogger)("Chart.BarsMarksContainer"),_=Math.round(new Date(2037,0,1).getTime()/1e3);class p extends u.DataSource{
constructor(e,t,i){const n=e.onWidget();let a;a=n?!e.hideIdeas():!!o.enabled("bars_marks")&&r.default.getBool("BarsMarksContainer.visibile",!1),t.merge({visible:a}),t.childs().visible.subscribe(null,(t=>{n||e.isSnapshot()||!o.enabled("bars_marks")||r.default.setValue("BarsMarksContainer.visibile",!!t.value())})),super(i),this._paneViews=[],this._model=e,this._properties=t,this._requests=[],this._marks={},this._loadedRange=null,this._getDataTimeout=null,this._collectedRange=null,this._lastRange=null;const l=this._model.mainSeries();l.onSymbolIntervalChanged().subscribe(this,this.clearMarks),l.dataEvents().symbolResolved().subscribe(this,this.clearMarks),l.dataEvents().completed().subscribe(this,(()=>{const e=l.data();if(0===e.size())return;const t=(0,s.ensureNotNull)(e.first()).index,i=(0,s.ensureNotNull)(e.last()).index,n=this.timeScale();this.getData({start:n.indexToTimePoint(t)??1/0,end:n.indexToTimePoint(i)??-1/0})})),this._initialize(),this._pinnedTooltips={}}destroy(){const e=this._model.mainSeries();e.onSymbolIntervalChanged().unsubscribeAll(this),e.dataEvents().symbolResolved().unsubscribeAll(this),e.dataEvents().completed().unsubscribeAll(this),super.destroy()}model(){return this._model}properties(){return this._properties}marks(){return this._marks}pinTooltip(e,t){this._pinnedTooltips[e]=t}timeScale(){return this._model.timeScale()}getIntervalInTicks(){const e=this._model.mainSeries().properties().childs().interval.value(),t=a.Interval.parse(e);if(!t.isValid())throw new TypeError("Unexpected interval");return t.isRange()?60:t.inMilliseconds()/1e3}getVisibleTickMarksRange(){if(this.timeScale().isEmpty())return{start:0,end:0};const e=(0,s.ensureNotNull)(this.timeScale().visibleBarsStrictRange()),{firstIndex:t,lastIndex:i}=(0,s.ensureNotNull)(this.timeScale().points().range().value());if(!(e.lastBar()>t&&e.firstBar()<i))return{start:0,end:0};let n;n=e.lastBar()<i?this.timeScale().indexToTimePoint(e.lastBar()):_;const r={start:this.timeScale().indexToTimePoint(Math.max(e.firstBar(),t)),end:n};return{start:r.start??1/0,end:r.end??-1/0}}getVisibleRangePlates(){const e=[],t=this.getVisibleTickMarksRange(),i=this.getIntervalInTicks();return Object.keys(this._marks).forEach((s=>{const n=this._marks[s],r=n.tickmark;r>=(t.start??1/0)&&r<=(t.end??-1/0)+i&&e.push(n)})),e}getPublishedPlates(){const e={};return window.is_authenticated?(this.getVisibleRangePlates().forEach((t=>{t.is_public&&(this._pinnedTooltips[t.id]||t.user__id===window.user.id)&&(e[t.id]=t)})),e):e}filterDisplayedPlates(e){const t=e.reduce(((e,t)=>{const i=this._getIndex(t.tickmark);return null!==i&&(e[i]=e[i]||[],e[i].push(t)),e}),{});return Object.keys(t).reduce(((e,i)=>{let s=t[i];return s=s.sort(((e,t)=>t.views_count-e.views_count)),s=s.slice(0,10),e.concat(s)}),[])}getPlatesViewData(){const e=this._model.mainSeries();if(e.data().isEmpty())return[];const t=(0,c.isPriceSourceStyle)(e.style())?e.barFunction():null,i=this.filterDisplayedPlates(this.getVisibleRangePlates()),n={},r=this._model.lastHittestData()??this._model.lastSelectedHittestData()
;let o=null;null!==r&&this._model.hoveredSource()===this&&(o=r.activeItem??null);const a=[];for(const e of i){const i=(0,s.ensureNotNull)(this._getIndex(e.tickmark)),r=this._getBar(i);if(null===r)continue;const l=this._layout(e.direction),c=this._theme(e.direction),u=o===e.id,h=this.timeScale().indexToCoordinate(i),d=this._offset(l,r,t),_=(0,s.ensureNotNull)(this.priceScale()).isInverted();let p=0;i in n||(n[i]={up:0,down:0}),p=n[i][l]++,a.push({id:e.id,x:h,y:d,yInverted:_,order:p,direction:l,theme:c,hovered:u,pinned:!0===this._pinnedTooltips[e.id],user__id:e.user__id,label:e.label,labelFontColor:e.labelFontColor||"#444",minSize:e.minSize||5,...this._plateViewData(e)})}const l=a.filter((e=>!0===e.hovered));for(let e=0;e<i.length;e++)i[e].user__id===l[0]?.user__id&&(i[e].highlightByAuthor=!0);return a.sort(((e,t)=>e.hovered&&!t.hovered?1:0)),a}priceAxisViews(){return null}updateAllViews(e){for(const t of this._paneViews)t.update(e)}updateAllViewsAndRepaint(){this.updateAllViews((0,h.sourceChangeEvent)(this.id())),this._model.updateSource(this)}roundRange(e){return{start:Math.round(e.start),end:Math.round(e.end)}}refreshData(){null!==this._lastRange&&this.getData(this._lastRange)}getData(e){(0,l.isNumber)(e.start)&&(0,l.isNumber)(e.end)?(this._lastRange=e,e.end=_,this._pushGetDataStack(Object.assign({},e))):d.logError("Wrong range")}clearMarks(){this._abortAllRequests(),this._marks={},this._loadedRange=null}isUserDeletable(){return!1}isSavedInChart(e){return!1}isSpeciallyZOrderedSource(){return!0}showInObjectTree(){return!1}_plateViewData(e){return{}}_layout(e){switch(e){default:case 0:case 2:case 3:case 4:case 5:case 6:return"up";case 1:return"down"}}_theme(e){switch(e){default:case 0:return"neutral";case 1:case 5:return"green";case 2:case 6:return"red";case 3:return"yellow";case 4:return"blue"}}_offset(e,t,i){let n;switch(e){default:case"up":n=null===i?t[2]:i(t);break;case"down":n=null===i?t[3]:i(t)}return(0,s.ensureNotNull)(this.priceScale()).priceToCoordinate(n,(0,s.ensureNotNull)((0,s.ensureNotNull)(this.ownerSource()).firstValue()))}_getIndex(e){return this.timeScale().timePointToIndex(e)}_getBar(e){return this._model.mainSeries().data().valueAt(e)}_rangeDifference(e){return e=Object.assign({start:1/0,end:-1/0},e),this._loadedRange&&(e.start<this._loadedRange.start?e.end=this._loadedRange.start:e.end>this._loadedRange.end&&(e.start=this._loadedRange.end)),e}_rangeUnion(e,t){return e=Object.assign({start:1/0,end:-1/0},e),t&&(e.start=Math.min(t.start,e.start),e.end=Math.max(t.end,e.end)),e}_pushGetDataStack(e){(0,l.isNumber)(e.start)&&(0,l.isNumber)(e.end)?(this._getDataTimeout&&clearTimeout(this._getDataTimeout),this._collectedRange=this._rangeUnion(e,this._collectedRange),this._getDataTimeout=setTimeout((()=>{this._getData(this._collectedRange),this._getDataTimeout=this._collectedRange=null}),300)):d.logError("Wrong tickmark range")}_abortAllRequests(){this._requests.forEach((e=>{e.cancel()})),this._requests=[],this._getDataTimeout&&clearTimeout(this._getDataTimeout),this._getDataTimeout=this._collectedRange=null
}}},326301:(e,t,i)=>{"use strict";i.d(t,{getDataVendorString:()=>n});var s=i(213377);function n(e){return null==e||s.enabled("bovespa_widget")?null:"QUANDL"===e.exchange?"Quandl.com":["BMFBOVESPA","BME","NAG","TSE","TFX","NZX","BCBA","TWSE","TASE","EURONEXT","TOCOM","BMV","SIX","SGX","GPW","SWB","BCS","WB","SZSE","BELEX","BAHRAIN","EGX","TADAWUL","BVL","LUXSE","DFM","BVC","NSENG","IDX","HSI","QSE","OSE"].includes(e.exchange)?"ICE Data Services":null}},570244:(e,t,i)=>{"use strict";var s;i.d(t,{ChartEventsSourceId:()=>s}),function(e){e.Value="ChartEventsSource"}(s||(s={}))},316250:(e,t,i)=>{"use strict";i.d(t,{fromIndexedTo100:()=>u,fromLog:()=>p,fromPercent:()=>a,getCurrentModePriceText:()=>b,getOppositeModePriceText:()=>g,logFormulaForBase:()=>m,logFormulasAreSame:()=>v,toIndexedTo100:()=>h,toIndexedTo100Range:()=>d,toLog:()=>_,toPercent:()=>l,toPercentRange:()=>c});var s=i(397535),n=i(982367);const r={logicalOffset:4,coordOffset:1e-4},o=305;function a(e,t){return t<0&&(e=-e),e/100*t+t}function l(e,t){const i=100*(e-t)/(t||1);return t<0?-i:i}function c(e,t){const i=l(e.minValue(),t),n=l(e.maxValue(),t);return new s.PriceRange(i,n)}function u(e,t){return t<0&&(e=-e),(e-=100)/100*t+t}function h(e,t){const i=100*(e-t)/t+100;return t<0?-i:i}function d(e,t){const i=h(e.minValue(),t),n=h(e.maxValue(),t);return new s.PriceRange(i,n)}function _(e,t){const i=Math.min(10**o-t.coordOffset,Math.abs(e));if(i<1e-25)return 0;const s=(0,n.log10)(i+t.coordOffset)+t.logicalOffset;return e<0?-s:s}function p(e,t){const i=Math.abs(e);if(i<1e-15)return 0;const s=Math.pow(10,Math.min(i-t.logicalOffset,o))-t.coordOffset;return e<0?-s:s}function m(e){if(null===e)return r;const t=1/e;if(t>=r.coordOffset||t<1e-15)return r;const i=Math.abs(Math.log10(e));return{logicalOffset:i,coordOffset:1/Math.pow(10,i)}}function v(e,t){return e.logicalOffset===t.logicalOffset&&e.coordOffset===t.coordOffset}function b(e,t){return e.isPercentage()?t.formattedPricePercentage:e.isIndexedTo100()?t.formattedPriceIndexedTo100:t.formattedPriceAbsolute}function g(e,t){return e.isPercentage()||e.isIndexedTo100()?t.formattedPriceAbsolute:t.formattedPricePercentage}},54365:(e,t,i)=>{"use strict";var s;i.d(t,{PublishedChartsFilter:()=>s}),function(e){e.None="all",e.Following="following",e.Private="private"}(s||(s={}))},207153:(e,t,i)=>{"use strict";i.d(t,{PublishedChartsTimeline:()=>O});var s=i(444372),n=i(62802),r=i(738834),o=i(262078),a=i(54365),l=i(735566),c=i(345848),u=i(638456),h=i(999102),d=i(803912),_=i(223124),p=i(312692),m=i(650151),v=i(790188),b=i(542682),g=i(934026),f=i(86441),T=i(731974),x=i(688857),w=i(765935);function y(e,t){const{horizontalPixelRatio:i,verticalPixelRatio:s}=t,n=Math.max(1,Math.floor(i)),r=Math.round(e.x*i)+n%2/2;let o=Math.round(e.size*i);(r+o/2)%1!=0&&(o+=1);const a=Math.min(Math.max(1,Math.round(i*e.borderWidth)),o/2);let l;const c=("up"===e.direction?-1:1)*(e.yInverted?-1:1),u=c*(Math.round(e.size*s/2)+n%2);if(void 0!==e.fixedSpaceYPosition){
const t=Math.round(e.fixedSpaceYPosition.itemSpacing*s),i=e.fixedSpaceYPosition.order,n=c*(o*i+t*(i+1));l=Math.round(e.fixedSpaceYPosition.basePosition*s)+n+u}else l=Math.round(e.y*s)+u;return{x:r,y:l,size:o,borderWidth:a,tickSize:n}}function C(e,t,i,s){if(e.save(),i&&!s.highlightByAuthor&&(e.globalAlpha=.4),s.mine)!function(e,t,i){const{borderColor:s,backgroundColor:n,doNotFill:r,direction:o,yInverted:a}=i,{x:l,y:c,borderWidth:u,size:h,tickSize:d}=y(i,t);e.strokeStyle=s,e.fillStyle=n,e.lineWidth=u;const _="up"===o!==a?-1:1;let p=Math.round(h/2/Math.tan(Math.PI/6))+d%2/2;(l+p/2)%1!=0&&(p-=1);e.translate(l,c+p/2*_),e.beginPath();const m=u/2;e.moveTo(0,-_*(p-m)),e.lineTo(h/2-m,u/2),e.lineTo(-h/2+m,u/2),e.lineTo(0,-_*(p-u/2)),e.closePath(),r||e.fill();e.stroke()}(e,t,s);else{0,function(e,t,i,s){const{borderColor:n,backgroundColor:r,label:o}=i,{x:a,y:l,borderWidth:c,size:u}=y(i,t);e.strokeStyle=n,e.fillStyle=r,e.lineWidth=c,e.beginPath();const h=u/2-c/2;e.arc(a,l,h,0,2*Math.PI,!0),e.closePath(),e.fill(),!1;e.stroke(),!s&&o&&u/2>=7&&(e.textAlign="center",e.textBaseline="middle",e.font=o.font,e.fillStyle=o.fontColor,(0,x.drawScaled)(e,t.horizontalPixelRatio,t.verticalPixelRatio,(()=>{e.fillText(o.text,a/t.horizontalPixelRatio,l/t.verticalPixelRatio)})))}(e,t,s,!1,s.image)}e.restore()}class P{constructor(e,t,i,s){this._canvas=null,this._clickHandler=e,this._enterHandler=t,this._leaveHandler=i,this._data=s??null}setData(e){this._data=e}hitTest(e,t){if(null===this._data)return null;for(let i=this._data.items.length-1;i>=0;--i){const s=this._hitTestDot(this._data.items[i],e,t);if(s)return s}return null}draw(e,t){this._canvas=e.canvas,null!==this._data&&this._data.items.forEach(C.bind(null,e,t,this._data.highlightByAuthor))}_hitTestDot(e,t,i){const s=new f.Point(e.x,y(e,i).y/i.verticalPixelRatio);if((0,g.pointInCircle)(t,s,Math.max(e.size/2,8))){const t=this._canvas,i=null===t?void 0:{mouseEnterHandler:()=>this._enterHandler(e,s.y,t),mouseLeaveHandler:()=>this._leaveHandler(),clickHandler:i=>this._clickHandler(e,s.y,t,i),tapHandler:i=>this._clickHandler(e,s.y,t,i)};return new T.HitTestResult(T.HitTarget.Regular,{activeItem:e.originalItem.id,cursorType:w.PaneCursorType.Default,...i})}return null}}var E=i(837462),S=i(910282),M=i(312520);const I={green:{border:(0,v.getHexColorByName)("color-minty-green-700"),background:(0,v.getHexColorByName)("color-minty-green-a600")},red:{border:(0,v.getHexColorByName)("color-ripe-red-700"),background:(0,v.getHexColorByName)("color-ripe-red-500")},neutral:{border:(0,v.getHexColorByName)("color-tan-orange-700"),background:(0,v.getHexColorByName)("color-tan-orange-500")},yellow:{border:"#EAC300",background:"#FFD400"},blue:{border:"#047ACE",background:"#0496FF"}};class A{constructor(e,t){this._tooltip=null,this._hoveredBarsMarkData=null,this._destroyed=!1,this._invalidated=!0,this._originalData=[],this._source=e,this._model=t,this._renderer=new P(this._onItemClicked.bind(this),this._showItem.bind(this),this._hideItem.bind(this)),this._createTooltipRenderer().then((e=>{
this._destroyed?e?.destroy():this._tooltip=e})),e.properties().childs().visible.subscribe(null,(()=>{this._tooltip?.hide(!0)}))}destroy(){this._destroyed=!0,this._tooltip?.destroy()}source(){return this._source}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}onClickOutside(e,t){t&&((0,M.isTouchMouseEvent)(t)?t.isTouch:(0,b.isTouchEvent)(t))&&null!==this._tooltip&&!this._tooltip.contains(t.target)&&this._tooltip.hide(!0)}_extractBarMarksRendererItemData(e,t){const i=t.overridedTheme??I[t.theme],s=this._calculateSize(e,t),n=this._calculateY(e,s,t);return null===this._hoveredBarsMarkData||this._hoveredBarsMarkData.id!==t.id||this._hoveredBarsMarkData.x===t.x&&this._hoveredBarsMarkData.y===Math.round(n)||(this._tooltip?.hide(!0),this._hoveredBarsMarkData=null),{x:t.x,y:this._calculateY(e,s,t),direction:t.direction,borderColor:i.border,borderWidth:k(t),backgroundColor:i.background,size:s,doNotFill:!t.public,yInverted:t.yInverted,label:void 0===t.label?void 0:{text:t.label,fontColor:t.labelFontColor,font:(0,E.makeFont)(Math.ceil(Math.max(10,Math.min(s/2,20))),S.CHART_FONT_FAMILY,"bold")},originalItem:t}}_onItemClicked(e,t,i,s){s.isTouch&&this._showItem(e,t,i)}async _showItem(e,t,i){const s=await this._tooltipProps(e);if(null===s)return;const n=this._model.timeScale().barSpacing(),r=this._calculateSize(n,e.originalItem);this._hoveredBarsMarkData={x:e.x,y:Math.round(this._calculateY(n,r,e.originalItem)),id:e.originalItem.id},this._tooltip?.show({itemSize:r,container:(0,m.ensureNotNull)(i.parentElement),x:e.x,y:t,factoryProps:s,onClickOutside:()=>this._tooltip?.hide(!0)})}_hideItem(){this._tooltip?.hide()}_calculateSize(e,t){return Math.min(553,Math.max(7,t.minSize,.8*e))}_updateImpl(){this._originalData=this._source.getPlatesViewData();const e=this._model.timeScale().barSpacing(),t=this._originalData.map(this._extractBarMarksRendererItemData.bind(this,e));this._renderer.setData({items:t,barSpacing:e,highlightByAuthor:!1})}}function k(e){return e.hovered||e.highlightByAuthor?e.overrideBorderWidth?.hoveredWidth??4:e.overrideBorderWidth?.width??2}const D=(0,l.getLogger)("Chart.PublishedChartsTimeline");class R extends A{constructor(){super(...arguments),this._profileDataCache=new Map}_extractBarMarksRendererItemData(e,t){const i=super._extractBarMarksRendererItemData(e,t);return{...i,fixedSpaceYPosition:{basePosition:t.y,order:t.order,itemSpacing:.2857142857142857*e},mine:t.mine,borderWidth:t.hovered?i.borderWidth:t.public?1:2,doNotFill:!t.public,direction:t.direction}}async _createTooltipRenderer(){const[{TooltipRenderer:e},{PublishedChartsTimelineTooltip:t}]=await Promise.all([Promise.all([i.e(19190),i.e(93240),i.e(82332),i.e(85014),i.e(81936),i.e(32227),i.e(70354)]).then(i.bind(i,467489)),Promise.all([i.e(19190),i.e(93240),i.e(82332),i.e(85014),i.e(81936),i.e(32227),i.e(70354)]).then(i.bind(i,211138))]);return new e(t)}_calculateY(e,t,i){const s=("up"===i.direction?-1:1)*(i.yInverted?-1:1),n=s*(t*i.order+.2857142857142857*t*(i.order+1))
;return i.y+t/2*s+n}_onItemClicked(e,t,i,s){super._onItemClicked(e,t,i,s),s.isTouch||this.source().showIdea(e.originalItem.id,!1)}async _tooltipProps(e){const t=(0,m.ensureDefined)(e.originalItem.username);let i=this._profileDataCache.get(t);if(void 0===i){try{i=await function(e){return fetch(`/api/v1/user/profile/${e}/?avatars_fallback=true&by=username`).then((e=>e.json()))}(t)}catch(e){return D.logWarn(`An error ocurred while loading profile data: ${e}`),null}this._profileDataCache.set(t,i)}return Promise.resolve({avatarUrl:i.avatars?.mid,badges:i.badges,title:(0,m.ensureDefined)(e.originalItem.title),username:t,onTitleClicked:()=>this.source().showIdea(e.originalItem.id,!1)})}}var L=i(839800),N=i(314802);const B=(0,l.getLogger)("Chart.PublishedChartsTimeLine");class O extends r.BarsMarksContainer{constructor(e,t){let i=n.default.getValue("PublishedChartsTimeline.filter",a.PublishedChartsFilter.None);window.is_authenticated||(i=a.PublishedChartsFilter.None);const s=new p.DefaultProperty({defaultName:"publishedchartstimeline",state:{filter:i}});super(e,s),this.setId("PublishedChartsTimeline"),this._paneView=new R(this,e),this._paneViews=[this._paneView],this._currentRange=null,this._properties.childs().visible.subscribe(this,(()=>{this._getData(this._currentRange)})),s.childs().filter.subscribe(this,(e=>{n.default.setValue("PublishedChartsTimeline.filter",e.value()),this.clearMarks(),this._getData(this._currentRange)})),this._containsData=e.isSnapshot(),this._containsData&&this._properties.childs().visible.setValue(!0),this.setUserEditEnabled(!1),this._onIdeaClickedHandler=t}destroy(){this._onIdeaClickedHandler=null,this._boundOnMessage&&(o.pushStreamMultiplexer.off("ideas",this._boundOnMessage),o.pushStreamMultiplexer.off("ideas.post",this._boundOnMessage),this._boundOnMessage=null),this._paneView.destroy(),super.destroy()}name(){return"Ideas on chart"}title(){return s.t(null,void 0,i(958757))}zorder(){return L.sortSourcesPreOrdered.BarMarks}paneViews(){return this._model.isInReplay().value()||!this._properties.childs().visible.value()?[]:this._paneViews}showIdea(e,t){const i=this._marks[e];i?((0,c.trackEvent)("GUI","View published idea"),t&&(0,c.trackEvent)("GUI","Ideas navigation arrow"),(0,u.onWidget)()||this._containsData||(0,N.isOnMobileAppPage)("any")?window.open(`${this._getBaseUrl()}${i.published_chart_url||"/v/"+i.image_url+"/"}`):i.image_url&&this._onIdeaClickedHandler?.({uid:i.image_url,url:i.published_chart_url})):B.logDebug("PublishedChartsTimeline.showIdea: unexpected published chart id")}state(e){const t={type:"BarsMarksContainer",id:this.id(),zorder:this.zorder(),pinnedTooltips:this._pinnedTooltips};return e&&this._properties.childs().visible.value()&&(t.marks=this.getPublishedPlates()),t}restoreData(e,t){null!=e.pinnedTooltips&&(this._pinnedTooltips=e.pinnedTooltips),t&&void 0!==e.marks&&(this._marks=e.marks)}onClickOutside(e,t){this._paneView.onClickOutside(e,t)}contextMenuStatName(){return"PublishedChartsTimelineContextMenu"}_getIndex(e){return this.timeScale().timePointToIndex(e,1)}
_initialize(){o.pushStreamMultiplexer&&(this._boundOnMessage=this._onMessage.bind(this),o.pushStreamMultiplexer.on("ideas",this._boundOnMessage),o.pushStreamMultiplexer.on("ideas.post",this._boundOnMessage))}_plateViewData(e){return{title:e.title,user_id:e.user__id,username:e.username,suggested:e.is_hot,mine:e.user__id===window.user.id,public:e.is_public}}_getData(e,t){const i=this._model.mainSeries().properties().childs(),s=this._model.mainSeries().symbolInfo();if(this._currentRange=e,!s||!this._properties.childs().visible.value()&&!t)return Promise.resolve([]);let n=s.base_name.length>1?s.base_name:[s.pro_name];const r=this.roundRange(this._rangeDifference(e));n=(0,h.uniq)(n),n=n.sort();const o=new FormData;o.append("interval",i.interval.value()),o.append("legs",JSON.stringify(n)),o.append("startTickmark",r.start.toString()),o.append("endTickmark",r.end.toString()),o.append("filter",this.properties().childs().filter.value());const a=(0,_.makeCancelable)(new Promise(((e,t)=>{(0,d.fetch)("/charttimeline/",{method:"POST",body:o,headers:new Headers({acccept:"application/json","X-Requested-With":"XMLHttpRequest"})}).then((i=>{i.ok?i.json().then(e):t()})).catch(t)})));return a.promise.then((t=>{t.forEach((e=>{this._marks[e.id]=e})),this._loadedRange=this._rangeUnion(e,this._loadedRange);const i=this._requests.indexOf(a);~i&&this._requests.splice(i,1),this.updateAllViewsAndRepaint()})),this._requests.push(a),a.promise}_onMessage(e,t,i,s){if(this._containsData)return;const n=this._model.mainSeries(),r=n.symbolInfo(),o=r&&r.base_name;if(!o)return;const a=n.properties().childs();e.interval===a.interval.value()&&~o.indexOf(e.pro_symbol)&&(this._marks[e.id]=e,this.updateAllViewsAndRepaint())}_getBaseUrl(){if((0,u.onWidget)()&&window.locale_domains){const e=window.locale||"en",t=window.locale_domains[e]?window.locale_domains[e]:window.locale_domains.en;return t?document.location.protocol+"//"+t:""}return""}}},538235:(e,t,i)=>{"use strict";i.d(t,{sourcesAffectState:()=>r});var s=i(63358),n=i(472354);function r(e){return!n.lineToolsDoNotAffectChartInvalidation||e.some((e=>!(0,s.isLineTool)(e)))}},5481:(e,t,i)=>{"use strict";i.d(t,{getAlertsActionCreators:()=>n,getFiresActionCreators:()=>r});var s=i(481251);const n=(0,s.default)((async()=>new((await Promise.all([i.e(83477),i.e(28750),i.e(50030),i.e(89774),i.e(52768),i.e(98634),i.e(62462),i.e(98218),i.e(49502)]).then(i.bind(i,604209))).AlertsActionCreators))),r=(0,s.default)((async()=>new((await Promise.all([i.e(50795),i.e(98634),i.e(62462),i.e(98218),i.e(68074)]).then(i.bind(i,816094))).FiresActionCreators)))},689443:(e,t,i)=>{"use strict";i.d(t,{getAlertDescription:()=>a});var s=i(955722),n=i(650151),r=i(589534),o=i(939037);function a(e){return function(e){return"function"==typeof e.name?e.name():e.name}(e)||function(e){return"description"in e?e.description():e.message}(e)||function(e){const t=function(e){return"dataSource"in e?"symbol"===e.dataSource.type?e.dataSource.symbol:null:"function"==typeof e.symbol?(0,s.decodeExtendedSymbol)(e.symbol()):e.symbol}(e),i=function(e){
if("dataSource"in e&&"watchlist"===e.dataSource.type)return e.dataSource.watchlistName;return null}(e),a="function"==typeof e.resolution?e.resolution():e.resolution,l="function"==typeof e.crossInterval?e.crossInterval():e.crossInterval;i&&(0,r.formatWatchlistTitle)({watchlistName:i,resolution:a,crossInterval:l});return(0,o.formatSymbolAndResolution)({symbol:(0,n.ensureNotNull)(t),resolution:a,crossInterval:l})}(e)}},565203:(e,t,i)=>{"use strict";i.d(t,{getAlertsChartActionCreators:()=>s});const s=(0,i(481251).default)((async()=>{const{getCreateAlertAction:e}=await Promise.all([i.e(16085),i.e(43853)]).then(i.bind(i,859740)),{getEditAlertOnLineDataSourceAction:t}=await Promise.all([i.e(16085),i.e(43853)]).then(i.bind(i,167222));return{createAlert:e,editAlertOnLineDataSource:t}}))},347505:(e,t,i)=>{"use strict";function s(e,t){const i=e.formatter();if(i.parse){const e=i.parse(i.format(t));if(e.res)return e.value}return t}i.d(t,{roundAlertValueUsingPrecision:()=>s})},327052:(e,t,i)=>{"use strict";var s;i.d(t,{AlertStopReason:()=>s}),function(e){e[e.Auto=0]="Auto",e[e.Manual=1]="Manual",e[e.Expired=2]="Expired",e[e.Created=3]="Created"}(s||(s={}))},377464:(e,t,i)=>{"use strict";i.d(t,{formatAppendingResolutionString:()=>r});var s=i(64262),n=i(969680);function r(e){const t=(0,s.getTranslatedResolution)(e);return(0,n.isRtl)()?" "+(0,n.forceRTLStr)(" ,"+t):", "+t}},939037:(e,t,i)=>{"use strict";i.d(t,{formatSymbolAndResolution:()=>a,formatSymbolString:()=>l});var s=i(212363),n=i.n(s),r=i(955722),o=i(377464);function a(e,t){const i=l(e.symbol,t);if(e.crossInterval)return i;return i+(0,o.formatAppendingResolutionString)(e.resolution)}function l(e,t){let i=(0,r.unwrapSimpleSymbol)(e);return t||(i=n().shortName(i)),i}},589534:(e,t,i)=>{"use strict";i.d(t,{formatWatchlistTitle:()=>n});var s=i(377464);function n(e){const t=e.watchlistName;if(e.crossInterval)return t;return t+(0,s.formatAppendingResolutionString)(e.resolution)}},44049:(e,t,i)=>{"use strict";i.d(t,{AsyncResourceWrapper:()=>s});class s{constructor(e,t){this._destroyed=!1,this._callbacks=[],this._resource={pendingResource:e},this._destroyFn=t,e.then((e=>{if(this._destroyed)this._destroyFn?.(e);else{for(const t of this._callbacks)t(e);this._resource.resource=e}})).finally((()=>{this._callbacks=[]}))}destroy(){this._resource.resource&&this._destroyFn?.(this._resource.resource),this._resource={pendingResource:Promise.reject("Resource is destroyed").catch((()=>{}))},this._callbacks=[],this._destroyed=!0}callFunction(e){this._destroyed||(this._resource.resource?e(this._resource.resource):this._callbacks.push(e))}get(){return this._destroyed||!this._resource.resource?null:this._resource.resource}promise(){return this._resource.pendingResource}}},228931:(e,t,i)=>{"use strict";i.r(t),i.d(t,{createNoticeDialog:()=>n,showNoticeDialog:()=>r});var s=i(444372);async function n(e){
return(await Promise.all([i.e(57335),i.e(38452),i.e(3016),i.e(41392),i.e(67799),i.e(66534),i.e(71761),i.e(11194),i.e(64935),i.e(47793),i.e(25977),i.e(30938),i.e(34834)]).then(i.bind(i,414929))).createDialog({width:400,destroyOnClose:!0,title:s.t(null,void 0,i(620748)),content:s.t(null,void 0,i(653497)),contentWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--no-border"><div class="tv-text"><p></p></div></div>',actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions tv-dialog__section--no-border">',actions:[{name:"ok",type:"primary",text:s.t(null,void 0,i(819295)),method:"close",key:[13,32]}],...e})}function r(e){n(e).then((e=>e.open()))}},699738:(e,t,i)=>{"use strict";function s(e){Promise.all([i.e(23754),i.e(98185),i.e(98933),i.e(18883),i.e(84712),i.e(15371),i.e(32937),i.e(46195),i.e(61681),i.e(63039),i.e(6612),i.e(66032),i.e(97540),i.e(25563),i.e(3359),i.e(72232),i.e(13672),i.e(10445),i.e(1462),i.e(19364),i.e(62112),i.e(90024),i.e(32227),i.e(62526),i.e(9887),i.e(49693),i.e(51226),i.e(2333),i.e(9374)]).then(i.bind(i,793497)).then((({SymbolInfoDialogImpl:t})=>{t.getInstance().show(e)}))}i.d(t,{showSymbolInfoDialog:()=>s})},16241:(e,t,i)=>{"use strict";function s(e){return e+"…"}i.d(t,{appendEllipsis:()=>s})},674488:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M15 9A6 6 0 1 1 3 9a6 6 0 0 1 12 0Zm1 0A7 7 0 1 1 2 9a7 7 0 0 1 14 0ZM7.97 5.87l-.78-.52V12.65l.78-.52 4.02-2.72.62-.41-.62-.42-4.02-2.7Zm.22 4.9V7.23L10.82 9l-2.63 1.77Z"/></svg>'},30556:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.5 4a.5.5 0 0 0-.5.5V5h4v-.5a.5.5 0 0 0-.5-.5h-3ZM12 5h3v1h-1.05l-.85 7.67A1.5 1.5 0 0 1 11.6 15H6.4a1.5 1.5 0 0 1-1.5-1.33L4.05 6H3V5h3v-.5C6 3.67 6.67 3 7.5 3h3c.83 0 1.5.67 1.5 1.5V5ZM5.06 6l.84 7.56a.5.5 0 0 0 .5.44h5.2a.5.5 0 0 0 .5-.44L12.94 6H5.06Z"/></svg>'}}]);