(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[27009,47365],{584317:(e,t,r)=>{"use strict";r.d(t,{DialogRenderer:()=>i});var o=r(820028);class i{constructor(){this._container=document.createElement("div"),this._visibility=new o.WatchedValue(!1),this._rootInstance=null}visible(){return this._visibility.readonly()}_setVisibility(e){this._visibility.setValue(e)}}},766409:(e,t,r)=>{"use strict";r.d(t,{barFunctionByStyle:()=>i});var o=r(326488);function i(e,t){switch(e){case 12:return(0,o.barFunction)("low","low","close");case 2:case 18:case 20:case 14:case 15:case 3:case 10:case 13:return(0,o.barFunction)(t??"close");default:return(0,o.barFunction)("close","open")}}},840514:(e,t,r)=>{"use strict";r.d(t,{CustomSourceBase:()=>o});class o{constructor(e,t){this._id=e,this._model=t}id(){return this._id}isHoveredEnabled(){return!0}isSelectionEnabled(){return!1}priceScale(){return null}paneViews(e){return[]}labelPaneViews(e){return[]}priceAxisViews(e,t){return[]}updateViewsForPane(e,t){e.containsMainSeries()&&this.updateAllViews(t)}}},830101:(e,t,r)=>{"use strict";r.d(t,{alwaysShowLastPriceAndLastDayChange:()=>o,lastDayChangeAvailable:()=>i});r(213377);const o=!1,i=!0},14767:(e,t,r)=>{"use strict";r.r(t),r.d(t,{QuotesProvider:()=>l});var o=r(534197),i=r(547465),s=r(623213);class l{constructor(e="full",t){this._quotes=null,this._quoteSessionSymbol=null,this._quoteSessionClientId="",this._pausedQuoteSessionSymbol=null,this._quotesUpdate=new i.Delegate,this._quoteSymbolChanged=new i.Delegate,this._multiplexerType=e,this._hibernated=t,this._hibernated?.subscribe((e=>{e?this.pause():this.resume()}))}setQuotesSessionSymbol(e){this._quoteSessionSymbol!==e&&(this._pausedQuoteSessionSymbol=null,this._quoteSessionClientId||(this._quoteSessionClientId="series-"+(0,s.guid)()),this._unsubscribeQuoteSession(),this._quoteSessionSymbol=e,this._quoteSymbolChanged.fire(),e&&this._subscribeQuoteSession(e))}symbol(){return this._quoteSessionSymbol}quotesUpdate(){return this._quotesUpdate}quoteSymbolChanged(){return this._quoteSymbolChanged}quotes(){return this._quotes}async quotesSnapshot(e){return(0,o.getQuoteSessionInstance)("simple").snapshot(e)}isPaused(){return null!==this._pausedQuoteSessionSymbol}pause(){null===this._pausedQuoteSessionSymbol&&(this._pausedQuoteSessionSymbol=this._quoteSessionSymbol,this._unsubscribeQuoteSession())}resume(){null!==this._pausedQuoteSessionSymbol&&(this._subscribeQuoteSession(this._pausedQuoteSessionSymbol),this._pausedQuoteSessionSymbol=null)}destroy(){this._unsubscribeQuoteSession(),this._hibernated?.release()}_onUpdate(e,t){this._quotes=e&&e.values||null,t&&t.values&&this._quotesUpdate.fire(e,t)}_subscribeQuoteSession(e){this._quoteSessionSymbol=e,(0,o.getQuoteSessionInstance)(this._multiplexerType).subscribe(this._quoteSessionClientId,this._quoteSessionSymbol,this._onUpdate.bind(this))}_unsubscribeQuoteSession(){this._quoteSessionSymbol&&((0,o.getQuoteSessionInstance)(this._multiplexerType).unsubscribe(this._quoteSessionClientId,this._quoteSessionSymbol),
this._quoteSessionSymbol=null,this._quotes=null)}}},889858:(e,t,r)=>{"use strict";r.d(t,{SeriesBarColorer:()=>p});var o=r(790188),i=r(650151),s=r(170562),l=r(584785),a=r(522109);const n=(0,o.getHexColorByName)("color-minty-green-500"),c=(0,o.getHexColorByName)("color-ripe-red-500");function h(e){return{barColor:e.upColor.value(),barBorderColor:e.borderUpColor?e.borderUpColor.value():e.borderColor.value()}}function d(e){return{barColor:e.downColor.value(),barBorderColor:e.borderDownColor?e.borderDownColor.value():e.borderColor.value()}}function u(e,t){return e.borderUpColorProjection&&e.borderUpColor?{barColor:t?e.upColorProjection.value():e.upColor.value(),barBorderColor:t?e.borderUpColorProjection.value():e.borderUpColor.value()}:{barColor:t?e.upColorProjection.value():e.upColor.value()}}function _(e,t){return e.borderDownColorProjection&&e.borderDownColor?{barColor:t?e.downColorProjection.value():e.downColor.value(),barBorderColor:t?e.borderDownColorProjection.value():e.borderDownColor.value()}:{barColor:t?e.downColorProjection.value():e.downColor.value()}}class p extends a.AbstractBarColorer{constructor(e){super(),this._series=e}applyBarStyle(e,t,r,o){const i=r;i.barColor=void 0,i.barBorderColor=void 0,i.barWickColor=void 0,i.isBarHollow=void 0,i.isBarUp=void 0,i.upColor=void 0,i.downColor=void 0,i.isTwoColorBar=void 0,i.isMergedBar=void 0;const s=this._series.properties();switch(s.childs().style.value()){case 2:case 14:case 15:this._applyLineStyle(e,t,r,o,s);break;case 18:this._applyLineStyle(e,t,r,o,s,!0);break;case 3:this._applyAreaStyle(r,s);break;case 16:this._applyHLCAreaStyle(e,t,r,o,s);break;case 0:this._applyBarStyle(e,r,o,s);break;case 17:case 1:case 19:this._applyCandleStyle(e,r,o,s);break;case 9:this._applyHollowCandleStyle(e,r,o,s);break;case 8:this._applyHAStyle(e,t,r,o,s);break;case 10:this._applyBaseLineStyle(e,t,r,o,s);break;case 12:this._applyHiLoStyle(t,r,s);break;case 13:this._applyColumnStyle(e,r,o,s);break;case 4:this._applyRenkoStyle(e,t,r,o,s);break;case 7:this._applyPBStyle(e,t,r,o,s);break;case 5:this._applyKagiStyle(e,t,r,o,s);break;case 6:this._applyPnfStyle(e,t,r,o,s);break;case 11:this._applyRangeStyle(e,t,r,o,s);break;case 20:this._applySVPStyle(e,r,o,s);break;case 21:this._applyHLCBarsStyle(e,r,o,s)}return r}static upColor(e,t){const r=e.childs(),o=r.style.value();switch(o){case 18:return{barColor:r.tpoStyle.childs().color.value()};case 20:return{barColor:r.svpStyle.childs().volumeProfile.childs().volumeColorUp.value()};case 2:return{barColor:r.lineStyle.childs().color.value()};case 14:return{barColor:r.lineWithMarkersStyle.childs().color.value()};case 15:return{barColor:r.steplineStyle.childs().color.value()};case 3:return{barColor:r.areaStyle.childs().linecolor.value()};case 16:return{barColor:r.hlcAreaStyle.childs().closeLineColor.value(),barBorderColor:n};case 0:return{barColor:r.barStyle.childs().upColor.value()};case 17:return h(r.volFootprintStyle.childs());case 19:return h(r.volCandlesStyle.childs());case 1:return h(r.candleStyle.childs());case 9:
return h(r.hollowCandleStyle.childs());case 8:return h(r.haStyle.childs());case 10:return{barColor:r.baselineStyle.childs().topLineColor.value()};case 12:return{barColor:r.hiloStyle.childs().color.value(),barBorderColor:e.childs().hiloStyle.childs().borderColor.value()};case 13:return{barColor:r.columnStyle.childs().upColor.value()};case 4:return u(r.renkoStyle.childs(),t);case 7:return u(r.pbStyle.childs(),t);case 5:return u(r.kagiStyle.childs(),t);case 6:return u(r.pnfStyle.childs(),t);case 11:0;const o=r.rangeStyle.childs(),i=o.barStyle.value()===s.RangeBarStyle.Bars;return{barColor:t?o.upColorProjection.value():i?o.upColor.value():o.candlesUpColor.value(),barBorderColor:t?o.upColorProjection.value():i?o.upColor.value():o.candlesBorderUpColor.value()};case 21:return{barColor:r.hlcBarsStyle.childs().color.value()}}(0,i.ensureNever)(o)}static downColor(e,t){const r=e.childs(),o=r.style.value();switch(o){case 2:return{barColor:r.lineStyle.childs().color.value()};case 18:return{barColor:r.tpoStyle.childs().color.value()};case 20:return{barColor:r.svpStyle.childs().volumeProfile.childs().volumeColorUp.value()};case 14:return{barColor:r.lineWithMarkersStyle.childs().color.value()};case 15:return{barColor:r.steplineStyle.childs().color.value()};case 3:return{barColor:r.areaStyle.childs().linecolor.value()};case 16:return{barColor:r.hlcAreaStyle.childs().closeLineColor.value(),barBorderColor:c};case 0:return{barColor:r.barStyle.childs().downColor.value()};case 17:return d(r.volFootprintStyle.childs());case 1:return d(r.candleStyle.childs());case 19:return d(r.volCandlesStyle.childs());case 9:return d(r.hollowCandleStyle.childs());case 8:return d(r.haStyle.childs());case 10:return{barColor:r.baselineStyle.childs().bottomLineColor.value()};case 12:return{barColor:r.hiloStyle.childs().color.value(),barBorderColor:e.childs().hiloStyle.childs().borderColor.value()};case 13:return{barColor:r.columnStyle.childs().downColor.value()};case 4:return _(r.renkoStyle.childs(),t);case 7:return _(r.pbStyle.childs(),t);case 5:return _(r.kagiStyle.childs(),t);case 6:return _(r.pnfStyle.childs(),t);case 11:0;const o=r.rangeStyle.childs(),i=o.barStyle.value()===s.RangeBarStyle.Bars;return{barColor:t?o.downColorProjection.value():i?o.downColor.value():o.candlesDownColor.value(),barBorderColor:t?o.downColorProjection.value():i?o.downColor.value():o.candlesBorderDownColor.value()};case 21:return{barColor:r.hlcBarsStyle.childs().color.value()}}(0,i.ensureNever)(o)}_applyLineStyle(e,t,r,o,s,l){if(r.barColor=p.upColor(s).barColor,l)return;const a=this._findBar(e,t,o),n=this._series.barFunction()(a),c=this._series.priceScale(),h=this._series.firstValue();if(null==n||c.isEmpty()||null==h)return;const d=c.priceToCoordinate(n,h);r.barColor=(0,i.ensureNotNull)(this._series.lineColorAtYPercentFromTop(d/c.height()))}_applyAreaStyle(e,t){e.barColor=p.upColor(t).barColor}_applyHLCAreaStyle(e,t,r,o,i){const s=this._isUp(e,!1,o,this._series.data().first()?.index!==e)?p.upColor(i,t):p.downColor(i,t);r.barColor=s.barColor,r.barBorderColor=s.barBorderColor}
_applyBarStyle(e,t,r,o){const i=this._isUp(e,!1,r,o.childs().barStyle.childs().barColorsOnPrevClose.value())?p.upColor(o):p.downColor(o);t.barColor=i.barColor,t.barBorderColor=i.barBorderColor}_applyCandleStyle(e,t,r,o){const i=o.childs(),s=1===i.style.value()?i.candleStyle.childs():19===i.style.value()?i.volCandlesStyle.childs():i.volFootprintStyle.childs(),l=this._isUp(e,!1,r,s.barColorsOnPrevClose.value()&&this._series.data().first()?.index!==e),a=l?p.upColor(o):p.downColor(o);t.barColor=a.barColor,t.barBorderColor=a.barBorderColor,t.barWickColor=l?s.wickUpColor?s.wickUpColor.value():s.wickColor.value():s.wickDownColor?s.wickDownColor.value():s.wickColor.value()}_applyHollowCandleStyle(e,t,r,o){const i=o.childs().hollowCandleStyle.childs(),s=this._isUp(e,!1,r,this._series.data().first()?.index!==e),l=s?p.upColor(o):p.downColor(o);t.barColor=l.barColor,t.barBorderColor=l.barBorderColor,t.barWickColor=s?i.wickUpColor?i.wickUpColor.value():i.wickColor.value():i.wickDownColor?i.wickDownColor.value():i.wickColor.value();const a=this._findBar(e,!1,r);t.isBarHollow=a[1]<=a[4]}_applyHAStyle(e,t,r,o,i){const s=i.childs().haStyle.childs(),l=this._isUp(e,t,o,s.barColorsOnPrevClose.value()),a=l?p.upColor(i):p.downColor(i);r.barColor=a.barColor,r.barBorderColor=a.barBorderColor,r.barWickColor=l?s.wickUpColor.value():s.wickDownColor.value()}_applyBaseLineStyle(e,t,r,o,s){const l=this._findBar(e,t,o),a=s.childs().baselineStyle.childs(),n=this._series.priceScale(),c=Math.round(n.height()*(Math.abs(100-a.baseLevelPercentage.value())/100)),h=(0,i.ensureNotNull)(this._series.firstValue()),d=n.coordinateToPrice(c,h);l[4]>d?r.barColor=p.upColor(s,t).barColor:r.barColor=p.downColor(s,t).barColor}_applyHiLoStyle(e,t,r){const o=p.upColor(r,e);t.barColor=o.barColor,t.barBorderColor=o.barBorderColor}_applyColumnStyle(e,t,r,o){const i=o.childs().columnStyle.childs(),s=this._isUp(e,!1,r,i.barColorsOnPrevClose.value())?p.upColor(o):p.downColor(o);t.color=s.barColor,t.barColor=t.color}_applyRenkoStyle(e,t,r,o,i){const s=i.childs().renkoStyle.childs(),l=this._isUp(e,t,o,!1),a=l?p.upColor(i,t):p.downColor(i,t);r.barColor=a.barColor,r.barBorderColor=a.barBorderColor,r.barWickColor=l?s.wickUpColor.value():s.wickDownColor.value(),r.isBarUp=l}_applyPBStyle(e,t,r,o,i){const s=this._isUp(e,t,o,!1),l=s?p.upColor(i,t):p.downColor(i,t);r.barColor=l.barColor,r.barBorderColor=l.barBorderColor,r.isBarUp=s}_applyKagiStyle(e,t,r,o,i){let s;r.upColor=p.upColor(i,t).barColor,r.downColor=p.downColor(i,t).barColor;const l=this._findBar(e,t,o);l[3]<l[6]&&l[6]<l[2]?(s=l[1]<=l[4],r.isTwoColorBar=!0):(s=l[1]<=l[4]?l[1]===l[6]:l[1]!==l[6],r.isTwoColorBar=!1),r.barColor=s?r.upColor:r.downColor,r.isBarUp=l[1]<=l[4]}_applyPnfStyle(e,t,r,o,i){const s=this._findBar(e,t,o)[6],l=s>0,a=p.upColor(i,t),n=p.downColor(i,t);r.isBarUp=l,r.isMergedBar=2===Math.abs(s),r.upColor=a.barColor,r.downColor=n.barColor,r.barColor=l?a.barColor:n.barColor}_applyRangeStyle(e,t,r,o,i){
const l=i.childs().rangeStyle.childs(),a=l.barStyle.value()===s.RangeBarStyle.Bars,n=this._isUp(e,!1,o,!1),c=n?p.upColor(i,t):p.downColor(i,t),h=n?t?l.upColorProjection.value():a?void 0:l.candlesWickUpColor.value():t?l.downColorProjection.value():a?void 0:l.candlesWickDownColor.value();r.barColor=c.barColor,r.barBorderColor=c.barBorderColor,r.wickColor=h,r.barWickColor=h}_applySVPStyle(e,t,r,o){const i=this._isUp(e,!1,r,!1)?p.upColor(o,!1):p.downColor(o,!1);t.barColor=i.barColor,t.barBorderColor=i.barBorderColor}_applyHLCBarsStyle(e,t,r,o){t.barColor=o.childs().hlcBarsStyle.childs().color.value()}_findBar(e,t,r){return r?r.value:this._getSeriesBars(t).valueAt(e)||[]}_findPrevBar(e,t,r){if(r&&r.previousValue)return r.previousValue;const o=this._series.bars().search(e-1,l.PlotRowSearchMode.NearestLeft,4);return null!==o?o.value:[]}_getSeriesBars(e){return e?this._series.nsBars():this._series.bars()}_isUp(e,t,r,o){const i=this._findBar(e,t,r);if(o){return this._findPrevBar(e,t,r)[4]<=i[4]}return i[1]<=i[4]}}},271747:(e,t,r)=>{"use strict";r.d(t,{SeriesAreaPaneView:()=>n});var o=r(534328),i=r(300562),s=r(708162),l=r(23076),a=r(705912);class n extends a.SeriesSingleLinePaneView{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e=this._source.priceScale();if(!e)return null;const t=this._source.properties().childs().areaStyle.childs(),r=t.transparency.value(),a={simpleMode:!1,barSpacing:this._model.timeScale().barSpacing(),items:this._items,lineColor:t.linecolor.value(),lineStyle:t.linestyle.value(),lineWidth:t.linewidth.value(),isSeries:!0,withMarkers:!1,bottom:e.height(),color1:(0,o.generateColor)(t.color1.value(),r),color2:(0,o.generateColor)(t.color2.value(),r),skipHoles:!0},n=new s.CompositeRenderer;return n.append(new i.PaneRendererArea(a)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&n.append(new l.SelectionRenderer(this._selectionData)),n}}},5253:(e,t,r)=>{"use strict";r.d(t,{SeriesBarsPaneView:()=>a});var o=r(708162),i=r(23076),s=r(512898),l=r(652695);class a extends s.SeriesBarCandlesPaneView{renderer(){this._invalidated&&(this._updateImpl(null),this._invalidated=!1);const e=this._source.properties().childs(),t={bars:this._bars,dontDrawOpen:e.barStyle.childs().dontDrawOpen.value(),thinBars:11===e.style.value()?e.rangeStyle.childs().thinBars.value():e.barStyle.childs().thinBars.value()},r=new o.CompositeRenderer;return r.append(new l.PaneRendererBars(t)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&r.append(new i.SelectionRenderer(this._selectionData)),r}_createItem(e,t,r){const o={center:NaN,open:NaN,high:NaN,low:NaN,close:NaN,color:r.barColor,left:NaN,right:NaN,timePointIndex:e};return(0,s.baseBarCandlesUpdater)(t,o)?o:null}}},340104:(e,t,r)=>{"use strict";r.d(t,{SeriesBaselinePaneView:()=>b});var o=r(534328),i=r(708162),s=r(86441),l=r(5531),a=r(204652),n=r(65840),c=r(660439),h=r(820807),d=r(731974);class u extends h.MediaCoordinatesPaneRenderer{constructor(){super(...arguments),
this._data=null}setData(e){this._data=e}hitTest(e){if(null===this._data)return null;const{items:t,topLineWidth:r,bottomLineWidth:o}=this._data,i=(0,n.interactionTolerance)().series+(r+o)/4,l=(0,c.lowerbound)(t,e,((e,t)=>e.center<=t.x)),h=Math.max(1,l-1),u=Math.min(t.length-1,l+1);for(let r=h;r<=u;++r){const o=t[r-1],l=t[r],{distance:n}=(0,a.distanceToSegment)((0,s.point)(o.center,o.y),(0,s.point)(l.center,l.y),(0,s.point)(e.x,e.y));if(n<=i)return new d.HitTestResult(d.HitTarget.Regular)}return null}_drawImpl(e){if(null===this._data)return;const{items:t,baseLevelCoordinate:r,bottom:o,bottomFillColor1:i,bottomFillColor2:a,topFillColor1:c,topFillColor2:h,topLineColor:d,bottomLineColor:u,topLineWidth:_,bottomLineWidth:p}=this._data;if(!function(e){if(0===e.length)return!1;const t=e.findIndex((e=>(0,n.coordinateIsValid)(e.y)));if(-1===t)return!1;let r=e.length-1;for(;r>t&&!(0,n.coordinateIsValid)(e[r].y);)r--;return!(t>r)}(t))return;const b=e.context,{topItems:C,bottomItems:S}=function(e,t){const r=[],o=[];let i=null;for(let a=0;a<e.length;a++){let c=e[a];const h=e[a+1]||{};if((0,n.coordinateIsValid)(c.y))c.y<=t&&r.push(c),c.y>=t&&o.push(c),i=c;else{if(null===i)continue;c=i}if((0,n.coordinateIsValid)(h.y)&&(c.y>t&&h.y<t||c.y<t&&h.y>t))if(Math.abs(c.center-h.center)<1){const e={center:c.center,y:t};r.push(e),o.push(e)}else{const e=(0,l.intersectLineSegments)((0,s.point)(c.center,c.y),(0,s.point)(h.center,h.y),(0,s.point)(c.center,t),(0,s.point)(h.center,t));if(null!==e){const t={center:c.center+(h.center-c.center)*e,y:c.y+(h.y-c.y)*e};r.push(t),o.push(t)}}}return{topItems:r,bottomItems:o}}(t,r);b.lineCap="round",b.lineJoin="round",0!==C.length&&(b.beginPath(),b.moveTo(C[0].center,r),this._makeLine(b,C,!0,0),b.closePath(),b.fillStyle=this._makeLinearGradient(b,c,h,r-o,r),b.fill(),b.beginPath(),this._makeLine(b,C,!1,0),b.lineWidth=_,b.strokeStyle=d,b.stroke()),0!==S.length&&(b.beginPath(),b.moveTo(S[0].center,r),this._makeLine(b,S,!0,1),b.closePath(),b.fillStyle=this._makeLinearGradient(b,i,a,r,r+o),b.fill(),b.beginPath(),this._makeLine(b,S,!1,1),b.lineWidth=p,b.strokeStyle=u,b.stroke())}_makeLine(e,t,r,o){if(null===this._data)return;const i=t.findIndex((e=>(0,n.coordinateIsValid)(e.y)));if(-1===i)return;const{barSpacing:s,baseLevelCoordinate:l}=this._data,a=.25*s;let c;const h=t.length;for(let s=i;s<h;s++){const h=t[s],d=t[s+1]||{};if((0,n.coordinateIsValid)(h.y)){if(0===o){if(c&&c.y>=l&&h.y>=l){e.moveTo(h.center,h.y);continue}}else if(c&&c.y<=l&&h.y<=l){e.moveTo(h.center,h.y);continue}if(c&&(0,n.coordinateIsValid)(c.y))e.lineTo(h.center,h.y),r&&!(0,n.coordinateIsValid)(d.y)&&e.lineTo(h.center,l);else if(d&&(0,n.coordinateIsValid)(d.y))r?(s!==i&&e.lineTo(h.center,l),e.lineTo(h.center,h.y)):e.moveTo(h.center,h.y);else if(r){if(0===s)continue;s!==i&&e.lineTo(h.center-a,l),e.lineTo(h.center-a,h.y),e.lineTo(h.center+a,h.y),e.lineTo(h.center+a,l)}else e.moveTo(h.center-a,h.y),e.lineTo(h.center+a,h.y);c=h}}}_makeLinearGradient(e,t,r,o,i){const s=e.createLinearGradient(0,o,0,i);return s.addColorStop(0,t),s.addColorStop(1,r),s}}
var _=r(23076),p=r(705912);class b extends p.SeriesSingleLinePaneView{constructor(){super(...arguments),this._renderer=new u,this._topFillColor1="",this._topFillColor2="",this._bottomFillColor1="",this._bottomFillColor2="",this._topLineColor="",this._bottomLineColor="",this._topLineWidth=0,this._bottomLineWidth=0,this._barSpacing=0,this._bottom=0,this._baseLevelCoordinate=0}renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer.setData({items:this._items,topFillColor1:this._topFillColor1,topFillColor2:this._topFillColor2,bottomFillColor1:this._bottomFillColor1,bottomFillColor2:this._bottomFillColor2,topLineColor:this._topLineColor,bottomLineColor:this._bottomLineColor,topLineWidth:this._topLineWidth,bottomLineWidth:this._bottomLineWidth,barSpacing:this._barSpacing,baseLevelCoordinate:this._baseLevelCoordinate,bottom:this._bottom});const e=new i.CompositeRenderer;return e.append(this._renderer),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&e.append(new _.SelectionRenderer(this._selectionData)),e}_updateImpl(){super._updateImpl();const e=this._source.priceScale();if(!e)return;const t=this._source.properties().childs().baselineStyle.childs(),r=t.transparency.value();this._topFillColor1=(0,o.generateColor)(t.topFillColor1.value(),r),this._topFillColor2=(0,o.generateColor)(t.topFillColor2.value(),r),this._bottomFillColor1=(0,o.generateColor)(t.bottomFillColor1.value(),r),this._bottomFillColor2=(0,o.generateColor)(t.bottomFillColor2.value(),r),this._topLineColor=t.topLineColor.value(),this._bottomLineColor=t.bottomLineColor.value(),this._topLineWidth=t.topLineWidth.value(),this._bottomLineWidth=t.bottomLineWidth.value(),this._barSpacing=this._model.timeScale().barSpacing(),this._bottom=e.height(),this._baseLevelCoordinate=Math.round(this._bottom*(Math.abs(100-t.baseLevelPercentage.value())/100))}}},973592:(e,t,r)=>{"use strict";r.d(t,{SeriesWaterlinePaneView:()=>a});var o=r(121181),i=r(765935),s=r(731974),l=r(257145);class a extends o.HorizontalLinePaneView{constructor(e){super(),this._getters=e;const t={cursorType:i.PaneCursorType.VerticalResize,activeItem:0,areaName:s.AreaName.SourceItemMove};this._lineRenderer.setHitTest(new s.HitTestResult(s.HitTarget.MovePoint,t)),this._lineRendererData.visible=!0,this._lineRendererData.linestyle=l.LINESTYLE_SPARSE_DOTTED}_updateImpl(){const{baseLevelPercentage:e,paneHeight:t,color:r}=this._getters,o=Math.abs(100-e());this._lineRendererData.y=Math.round(t()*(o/100)),this._lineRendererData.color=r()}}},616332:(e,t,r)=>{"use strict";r.d(t,{SeriesCandlesPaneView:()=>n});var o=r(708162),i=r(65840),s=r(23076),l=r(512898),a=r(149836);class n extends l.SeriesBarCandlesPaneView{constructor(e,t,r=1){super(e,t),this._scaleCoeff=1,this._scaleCoeff=r}renderer(){this._invalidated&&(this._updateImpl(null),this._invalidated=!1);const e=this._source.priceScale();if(!e)return null
;const t=this._source.properties().childs(),r=1===t.style.value()?t.candleStyle.childs():19===t.style.value()?t.volCandlesStyle.childs():t.volFootprintStyle.childs(),l=this._model.timeScale().barSpacing(),n={bars:this._bars,barSpacing:l,bodyVisible:r.drawBody.value(),borderVisible:r.drawBorder.value(),borderColor:r.borderColor.value(),wickColor:r.wickColor.value(),barWidth:(0,i.optimalBarWidth)(l),wickVisible:r.drawWick.value(),isPriceScaleInverted:e.isInverted(),scaleCoeff:this._scaleCoeff},c=new o.CompositeRenderer;return c.append(new a.PaneRendererCandles(n)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&c.append(new s.SelectionRenderer(this._selectionData)),c}_createItem(e,t,r){const o={center:NaN,open:NaN,high:NaN,low:NaN,close:NaN,left:NaN,right:NaN,timePointIndex:e,color:r.barColor,borderColor:r.barBorderColor,wickColor:r.barWickColor,hollow:r.isBarHollow};return(0,l.baseBarCandlesUpdater)(t,o)?o:null}}},351018:(e,t,r)=>{"use strict";r.d(t,{SeriesColumnsPaneView:()=>_});var o=r(650151),i=r(86441),s=r(213377),l=r(569708),a=r(731974),n=r(708162),c=r(584785),h=r(975022),d=r(23076),u=r(564079);r(316250);class _{constructor(e,t){this._items=[],this._invalidated=!0,this._isMarkersEnabled=(0,s.enabled)("source_selection_markers"),this._selectionData=null,this._histogramBase=0,this._source=e,this._model=t,this._selectionIndexer=new h.SelectionIndexes(t.timeScale())}update(){this._invalidated=!0}renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e={barSpacing:this._model.timeScale().barSpacing(),items:this._items,lineColor:"",histogramBase:this._histogramBase},t=new n.CompositeRenderer;return t.append(new u.PaneRendererColumns(e)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&t.append(new d.SelectionRenderer(this._selectionData)),t}_updateImpl(){this._items=[];const e=this._model.timeScale(),t=this._source.priceScale();if(e.isEmpty()||!t||t.isEmpty())return;const r=e.visibleBarsStrictRange();if(null===r)return;if(0===this._source.bars().size())return;const s=this._source.nearestIndex(r.firstBar(),c.PlotRowSearchMode.NearestRight),n=this._source.nearestIndex(r.lastBar(),c.PlotRowSearchMode.NearestLeft);if(void 0===s||void 0===n)return;const h=this._source.barColorer(),d={},u=this._source.barFunction();for(const{index:e,value:t}of this._source.bars().rangeIterator(s,n)){const r=u(t);if(!(0,l.default)(r))continue;d.value=t;let o=this._source.precomputedBarStyle(t);void 0===o&&(o=h.barStyle(e,!1,d),this._source.setPrecomputedBarStyle(t,o)),this._items.push({timePointIndex:e,left:NaN,center:NaN,right:NaN,y:r,style:o}),d.previousValue=t}const _=this._source.firstValue();if(null===_)return;t.pointsArrayToCoordinates(this._items,_),e.fillBarBorders(this._items);this._source.properties().childs().columnStyle.childs().baselinePosition?.value();if(this._histogramBase=t.isInverted()?0:t.height(),this._model.selection().isSelected(this._source)){const r=this._selectionIndexer.indexes();this._selectionData={
points:[],bgColors:[],visible:!0,barSpacing:e.barSpacing(),hittestResult:a.HitTarget.Regular};const s=(0,o.ensureNotNull)(this._model.paneForSource(this._source)).height();this._selectionData.hittestResult=a.HitTarget.Regular;for(let o=0;o<r.length;o++){const l=r[o],a=this._source.bars().valueAt(l);if(null===a)continue;const n=u(a),c=e.indexToCoordinate(l),h=t.priceToCoordinate(n,_);this._selectionData.points.push({point:new i.Point(c,h)}),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(h/s))}}else this._selectionIndexer.clear()}}},735922:(e,t,r)=>{"use strict";r.d(t,{SeriesHiLoPaneView:()=>C});var o=r(259332),i=r(837462),s=r(660439),l=r(65840),a=r(731974),n=r(820807);class c extends n.MediaCoordinatesPaneRenderer{constructor(){super(...arguments),this._data=null,this._barWidth=null}setData(e){this._data=e,this._barWidth=Math.max(1,Math.round((0,l.optimalHiLoWidth)(e.barSpacing)))}hitTest(e){if(null===this._data||null===this._barWidth)return null;const t=this._data.bars,r=.5*this._data.barSpacing;if(0===t.length)return null;if(e.x<t[0].center-r)return null;if(e.x>t[t.length-1].center+r)return null;const o=t[(0,s.lowerbound)(t,e.x-r,((e,t)=>e.center<t))];if(e.x<o.center-r||e.x>o.center+r)return null;const i=(0,l.interactionTolerance)().series+this._barWidth/2,n=Math.min(o.high,o.low),c=Math.max(o.high,o.low),h=this._data.fontSize;return n-i-h<=e.y&&e.y<=n+i||c-i<=e.y&&e.y<=c+i+h?new a.HitTestResult(a.HitTarget.Regular):null}_drawImpl(e){if(null===this._data||null===this._barWidth)return;const{font:t,fontSize:r,labelColor:o,bars:s,inverted:l,labelsPadding:a}=this._data,n=e.context;n.textAlign="center",n.fillStyle=o,n.font=(0,i.makeFont)(r,t);for(let e=0;e<s.length;++e){const t=s[e],r=Math.round(Math.min(t.high,t.low)),o=Math.round(Math.max(t.high,t.low)),i=Math.round(t.center);n.textBaseline="alphabetic",n.fillText(l?t.lowLabel:t.highLabel,i,r-a),n.textBaseline="top",n.fillText(l?t.highLabel:t.lowLabel,i,o+a)}}}var h=r(708162),d=r(23076),u=r(910282),_=r(688857),p=r(149836),b=r(512898);class C extends b.SeriesBarCandlesPaneView{constructor(e,t){super(e,t),this._labelsRenderer=new c,this._candlesRenderer=new p.PaneRendererCandles,this._maxLengthLabel="",this._calculateFontSize=(0,o.default)(((e,t)=>Math.max(1,(0,s.lowerboundExt)((e=>e+1),null,(r=>{const o=(0,i.makeFont)(r,u.CHART_FONT_FAMILY);return(0,_.measureText)(e,o).width<=t}),7,36))),((e,t)=>`${e}/${t}`))}renderer(){const e=this._source.priceScale();if(!e||e.isEmpty())return null;const t=new h.CompositeRenderer,r=this._needLabels(),o=this._source.properties().childs().hiloStyle.childs(),i=this._model.timeScale().barSpacing();if(this._invalidated){const e=this._source.formatter();this._maxLengthLabel="",this._updateImpl({generateLabels:r,formatter:e}),this._invalidated=!1}if(this._candlesRenderer.setData({bars:this._bars,wickVisible:!1,bodyVisible:o.drawBody.value(),barSpacing:i,borderVisible:o.showBorders.value(),barWidth:(0,l.optimalHiLoWidth)(i),isPriceScaleInverted:e.isInverted()}),t.append(this._candlesRenderer),r){
const r=this._calculateLabelFontSize();r&&r>=8&&(this._labelsRenderer.setData({bars:this._bars,barSpacing:i,font:u.CHART_FONT_FAMILY,fontSize:r,labelColor:o.labelColor.value(),inverted:e.isInverted(),labelsPadding:.4*r}),t.append(this._labelsRenderer))}return this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&t.append(new d.SelectionRenderer(this._selectionData)),t}topPixelMargin(){return this._margin()}bottomPixelMargin(){return this._margin()}_createItem(e,t,r,o){const i={center:NaN,left:NaN,right:NaN,open:NaN,high:NaN,low:NaN,close:NaN,color:r.barColor,borderColor:r.barBorderColor,hollow:!1,highLabel:"",lowLabel:"",timePointIndex:e};if(!(0,b.baseBarCandlesUpdater)(t,i))return null;if(i.open=i.high,i.close=i.low,o.generateLabels){const e=o.formatter.format(i.high),t=o.formatter.format(i.low);i.highLabel=e,i.lowLabel=t;const r=(e.length>t.length?e:t).replace(/\d/g,"0");r.length>this._maxLengthLabel.length&&(this._maxLengthLabel=r)}return i}_margin(){if(this._needLabels()){const e=this._calculateLabelFontSize();if(e&&e>=8)return 1.4*e}return 0}_calculateLabelFontSize(){return""===this._maxLengthLabel?null:this._calculateFontSize(this._maxLengthLabel,Math.floor(this._model.timeScale().barSpacing())-2)}_needLabels(){const e=this._source.properties().childs().hiloStyle.childs().showLabels.value(),t=this._model.timeScale().barSpacing();return e&&t>5}}},517742:(e,t,r)=>{"use strict";r.d(t,{SeriesHLCAreaPaneView:()=>C});var o=r(86441),i=r(650151),s=r(213377),l=r(276780),a=r(975022),n=r(23076),c=r(584785),h=r(65840),d=r(708162),u=r(731974),_=r(919383),p=r(886367);class b extends p.ObjectValuesCache{_newObject(){return{high:void 0,close:void 0,low:void 0}}_clearObject(e){e.high=void 0,e.close=void 0,e.low=void 0}}class C{constructor(e,t){this._isMarkersEnabled=(0,s.enabled)("source_selection_markers"),this._hlcAreaCache=new b,this._highPoints=new p.CachedContainer,this._closePoints=new p.CachedContainer,this._lowPoints=new p.CachedContainer,this._barsBorders=new p.CachedContainer,this._filledAreas=new l.CachedMap,this._renderer=new d.CompositeRenderer,this._invalidated=!0,this._source=e,this._model=t,this._selectionIndexer=new a.SelectionIndexes(t.timeScale())}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}_updateImpl(){this._renderer.clear();const e=this._model.timeScale(),t=this._source.priceScale();if(e.isEmpty()||!t||t.isEmpty())return;const r=e.visibleBarsStrictRange();if(null===r)return;if(0===this._source.bars().size())return;const s=this._source.firstValue();if(null===s)return;const a=this._source.nearestIndex(r.firstBar()-1,c.PlotRowSearchMode.NearestLeft)??r.firstBar()-1,d=this._source.nearestIndex(r.lastBar()+1,c.PlotRowSearchMode.NearestRight)??r.lastBar()+1;this._hlcAreaCache.invalidateCache(),this._hlcAreaCache.setStartIndex(a),this._barsBorders.invalidateCache(),this._highPoints.invalidateCache(),this._lowPoints.invalidateCache(),this._closePoints.invalidateCache(),
this._filledAreas.invalidateCache();let p,b,C;this._source.bars().range(a,d).each(((e,t)=>{if(this._hlcAreaCache.isValidIndex(e)){const r=this._hlcAreaCache.at(e);r.close=t[4],r.high=t[2],r.low=t[3]}return!1}));const S=new Map,v=a+this._hlcAreaCache.length();for(let e=a;e<v;e++){const t=this._hlcAreaCache.at(e),r=t.close??null,o=t.high??null,i=t.low??null;(null!==r||null!==o||null!==i||Number.isFinite(p)||Number.isFinite(b)||Number.isFinite(C))&&(p=r,b=o,C=i,this._highPoints.push(o),this._closePoints.push(r),this._lowPoints.push(i),this._barsBorders.push({timePointIndex:e,left:NaN,center:NaN,right:NaN}),S.set(e,this._barsBorders.length()-1))}t.pricesArrayToCoordinates(this._highPoints.data(),s,this._highPoints.length()),t.pricesArrayToCoordinates(this._closePoints.data(),s,this._closePoints.length()),t.pricesArrayToCoordinates(this._lowPoints.data(),s,this._lowPoints.length()),e.fillBarBorders(this._barsBorders.data(),{startItemIndex:0,endItemIndex:this._barsBorders.length()});const m=this._source.properties().childs().hlcAreaStyle.childs(),y=m.highCloseFillColor.value(),g=m.closeLowFillColor.value(),w=this._filledAreas.get(y)??new l.AreaBackgroundItemsGroup({type:0,color:y}),f=w.newItem()??new l.AreaBackgroundItem;w.push(f),this._filledAreas.set(y,w);const P=this._filledAreas.get(g)??new l.AreaBackgroundItemsGroup({type:0,color:g}),B=P.newItem()??new l.AreaBackgroundItem;P.push(B),this._filledAreas.set(g,P);const L=[],k=[],x=[],I=this._barsBorders.length();for(let e=0;e<I;e++){const t=this._closePoints.at(e),r=this._highPoints.at(e),o=this._lowPoints.at(e),i=this._barsBorders.at(e),s=i.center,l=(0,h.coordinateIsValid)(t),a=(0,h.coordinateIsValid)(r),n=(0,h.coordinateIsValid)(o);l&&a&&n&&(f.addPoints1Point(s,r),f.addPoints2Point(s,t),B.addPoints1Point(s,t),B.addPoints2Point(s,o),L.push({y:r,...i}),k.push({y:t,...i}),x.push({y:o,...i}))}const N=e.barSpacing();if(this._renderer.append(new l.AreaBackgroundRenderer({barSpacing:N,colorAreas:this._filledAreas})),m.lowLineVisible.value()&&this._renderer.append(new _.PaneRendererLine({barSpacing:N,items:x,simpleMode:!0,withMarkers:!1,lineColor:m.lowLineColor.value(),lineStyle:m.lowLineStyle.value(),lineWidth:m.lowLineWidth.value(),skipHoles:!0})),m.highLineVisible.value()&&this._renderer.append(new _.PaneRendererLine({barSpacing:N,items:L,simpleMode:!0,withMarkers:!1,lineColor:m.highLineColor.value(),lineStyle:m.highLineStyle.value(),lineWidth:m.highLineWidth.value(),skipHoles:!0})),this._renderer.append(new _.PaneRendererLine({barSpacing:N,items:k,simpleMode:!0,withMarkers:!1,lineColor:m.closeLineColor.value(),lineStyle:m.closeLineStyle.value(),lineWidth:m.closeLineWidth.value(),skipHoles:!0})),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled){const t=this._selectionIndexer.indexes(),r=[],s=[],l=(0,i.ensureNotNull)(this._model.paneForSource(this._source)).height();for(let e=0;e<t.length;e++){const i=t[e],a=S.get(i);if(void 0===a)continue;const n=this._closePoints.at(a),c=this._barsBorders.at(a).center;r.push({point:new o.Point(c,n)}),
s.push(this._model.backgroundColorAtYPercentFromTop(n/l))}this._renderer.append(new n.SelectionRenderer({bgColors:s,points:r,visible:!0,barSpacing:e.barSpacing(),hittestResult:u.HitTarget.Regular}))}else this._selectionIndexer.clear()}}},669110:(e,t,r)=>{"use strict";r.d(t,{SeriesHLCBarsPaneView:()=>a});var o=r(708162),i=r(23076),s=r(652695),l=r(5253);class a extends l.SeriesBarsPaneView{renderer(){this._invalidated&&(this._updateImpl(null),this._invalidated=!1);const e=this._source.properties().childs(),t={bars:this._bars,dontDrawOpen:!0,thinBars:e.hlcBarsStyle.childs().thinBars.value()},r=new o.CompositeRenderer;return r.append(new s.PaneRendererBars(t)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&r.append(new i.SelectionRenderer(this._selectionData)),r}}},498969:(e,t,r)=>{"use strict";r.d(t,{SeriesHollowCandlesPaneView:()=>n});var o=r(708162),i=r(65840),s=r(23076),l=r(149836),a=r(616332);class n extends a.SeriesCandlesPaneView{renderer(){this._invalidated&&(this._updateImpl(null),this._invalidated=!1);const e=this._source.priceScale();if(!e)return null;const t=this._source.properties().childs().hollowCandleStyle.childs(),r=this._model.timeScale().barSpacing(),a={bars:this._bars,barSpacing:r,bodyVisible:t.drawBody.value(),borderVisible:t.drawBorder.value(),borderColor:t.borderColor.value(),wickColor:t.wickColor.value(),barWidth:(0,i.optimalBarWidth)(r),wickVisible:t.drawWick.value(),isPriceScaleInverted:e.isInverted()},n=new o.CompositeRenderer;return n.append(new l.PaneRendererCandles(a)),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData&&n.append(new s.SelectionRenderer(this._selectionData)),n}}},316661:(e,t,r)=>{"use strict";r.d(t,{SeriesLinePaneView:()=>h});var o=r(731974),i=r(708162),s=r(919383),l=r(255143),a=r(23076),n=r(705912),c=r(660603);class h extends n.SeriesSingleLinePaneView{renderer(){this._invalidated&&(this._updateImpl(),this._invalidated=!1);const e=this._source.properties().childs(),t=e.style.value();let r,n=!1;2===t?r=e.lineStyle.childs():14===t?(r=e.lineWithMarkersStyle.childs(),n=!0):15===t?r=e.steplineStyle.childs():18===t&&(r=e.tpoStyle.childs());const h=this._model.timeScale().barSpacing(),d=r.colorType?.value()!==c.ColorType.Gradient?{type:c.ColorType.Solid,color:r.color.value()}:{type:c.ColorType.Gradient,startColor:r.gradientStartColor.value(),endColor:r.gradientEndColor.value()},u={barSpacing:h,items:this._items,lineColor:d,lineStyle:r.linestyle.value(),withMarkers:n,lineWidth:r.linewidth.value(),simpleMode:!0,hitTestResult:o.HitTarget.Regular,skipHoles:!0};let _,p;if(_=15===t?new l.PaneRendererStepLine(u):new s.PaneRendererLine(u),this._model.selection().isSelected(this._source)&&this._isMarkersEnabled&&this._selectionData){const e=new i.CompositeRenderer;e.append(_),e.append(new a.SelectionRenderer(this._selectionData)),p=e}else p=_;return p}}},512898:(e,t,r)=>{"use strict";r.d(t,{SeriesBarCandlesPaneView:()=>h,baseBarCandlesUpdater:()=>c})
;var o=r(86441),i=r(213377),s=r(975022),l=r(584785),a=r(731974);function n(e){return null!=e}function c(e,t){const r=e[1],o=e[2],i=e[3],s=e[4];return!!(n(r)&&n(o)&&n(i)&&n(s))&&(t.open=r,t.high=o,t.low=i,t.close=s,!0)}class h{constructor(e,t){this._bars=[],this._invalidated=!0,this._isMarkersEnabled=(0,i.enabled)("source_selection_markers"),this._selectionData=null,this._source=e,this._model=t,this._selectionIndexer=new s.SelectionIndexes(t.timeScale())}items(){return this._bars}update(){this._invalidated=!0}_updateImpl(e){const t=this._model.timeScale(),r=this._source.priceScale();if(this._bars=[],t.isEmpty()||!r||r.isEmpty())return;const i=t.visibleBarsStrictRange();if(null===i)return;if(0===this._source.bars().size())return;let s=this._source.nearestIndex(i.firstBar(),l.PlotRowSearchMode.NearestRight);const n=this._source.nearestIndex(i.lastBar(),l.PlotRowSearchMode.NearestLeft);if(void 0===s||void 0===n)return;for(;s<=n;s++){if(null!==this._source.bars().valueAt(s))break}if(s>n)return;const c=this._source.bars().range(s,n),h=this._source.barColorer(),d={};if(c.each(((t,r)=>{d.value=r;const o=h.firstColoredBar(t);let i;null!==o&&o>=t?this._source.setPrecomputedBarStyle(r,void 0):i=this._source.precomputedBarStyle(r),void 0===i&&(i=h.barStyle(t,!1,d),this._source.setPrecomputedBarStyle(r,i));const s=this._createItem(t,r,i,e);return!!s&&(d.previousValue=r,this._bars.push(s),!1)})),0===this._bars.length)return;const u=this._source.firstValue();if(null!==u)if(r.barPricesToCoordinates(this._bars,u),t.fillBarBorders(this._bars),this._model.selection().isSelected(this._source)){const e=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0,hittestResult:a.HitTarget.Regular,barSpacing:t.barSpacing()};const i=this._model.paneForSource(this._source);if(!i)return;const s=i.height();for(let i=0;i<e.length;i++){const l=e[i],a=this._source.bars().valueAt(l);if(null===a)continue;const n=a[1],c=a[4];if(null==n||null==c)continue;const h=.5*(n+c),d=t.indexToCoordinate(l),_=r.priceToCoordinate(h,u);this._selectionData.points.push({point:new o.Point(d,_)}),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(_/s))}}else this._selectionIndexer.clear()}}},705912:(e,t,r)=>{"use strict";r.d(t,{SeriesSingleLinePaneView:()=>d});var o=r(569708),i=r(86441),s=r(650151),l=r(213377),a=r(975022),n=r(584785),c=r(731974),h=r(660439);class d{constructor(e,t){this._items=[],this._invalidated=!0,this._isMarkersEnabled=(0,l.enabled)("source_selection_markers"),this._selectionData=null,this._source=e,this._model=t,this._selectionIndexer=new a.SelectionIndexes(t.timeScale())}update(){this._invalidated=!0}_updateImpl(){this._items=[];const e=this._model.timeScale(),t=this._source.priceScale();if(e.isEmpty()||!t||t.isEmpty())return;const r=e.visibleBarsStrictRange();if(null===r)return;if(0===this._source.bars().size())return
;const l=this._source.nearestIndex(r.firstBar()-1,n.PlotRowSearchMode.NearestLeft)??r.firstBar()-1,a=this._source.nearestIndex(r.lastBar()+1,n.PlotRowSearchMode.NearestRight)??r.lastBar()+1,d=this._source.barFunction(),u=this._model.timeScale().barSpacing();if(u<.1&&this._source.supportsConflatedChunks()){const e=this._source.conflatedChunks(u,(0,s.ensureNotNull)(this._source.priceSource())),t=(0,h.lowerbound)(e,l,((e,t)=>e.startTime<t)),r=Math.min(e.length-1,(0,h.lowerbound)(e,a,((e,t)=>e.endTime<t)));for(let o=t;o<=r;o++){const t=e[o];[t.open,t.high,t.low,t.close].forEach((e=>{this._items.push({timePointIndex:t.startTime,y:e,left:NaN,center:NaN,right:NaN})}))}}else for(const{index:e,value:t}of this._source.bars().rangeIterator(l,a)){const r=d(t);(0,o.default)(r)&&this._items.push({timePointIndex:e,y:r,left:NaN,center:NaN,right:NaN})}const _=this._source.firstValue();if(null!==_)if(t.pointsArrayToCoordinates(this._items,_),e.fillBarBorders(this._items),this._model.selection().isSelected(this._source)){const r=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0,barSpacing:e.barSpacing(),hittestResult:c.HitTarget.Regular};const o=(0,s.ensureNotNull)(this._model.paneForSource(this._source)).height();this._selectionData.hittestResult=c.HitTarget.Regular;for(let s=0;s<r.length;s++){const l=r[s],a=this._source.bars().valueAt(l);if(null===a)continue;const n=d(a),c=e.indexToCoordinate(l),h=t.priceToCoordinate(n,_);this._selectionData.points.push({point:new i.Point(c,h)}),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(h/o))}}else this._selectionIndexer.clear();else this._items=[]}}},176749:(e,t,r)=>{"use strict";r.d(t,{SeriesValuesProvider:()=>L,calculateColor:()=>P,changesData:()=>B});var o=r(650151),i=r(150335),s=r(724377),l=r(444372),a=r(638456),n=r(534328),c=r(969680),h=r(584785),d=r(87913),u=r(951827),_=r(889858);function p(e,t){return 100*(t-e)/Math.abs(e||1)}var b=r(909954),C=r(529751),S=r(634969),v=r(830101);const m=v.lastDayChangeAvailable||v.alwaysShowLastPriceAndLastDayChange,y=a.CheckMobile.any(),g=(0,u.getPercentageFormatter)(),w=(0,u.getVolumeFormatter)(2),f=`${S.notAvailable} (${S.notAvailable}%)`;function P(e,t){const r=(0,s.parseRgb)(t),o=(0,s.parseRgb)(e);return(0,s.distanceRgb)(r,o)<70?(0,s.rgbToHexString)((0,s.invertRgb)(r)):t}function B(e,t,r,o,i){let s,l;if(null!==t){const e=i[4],r=t.change||0;l={change:r,currentPrice:e,prevPrice:e-r,percentChange:t.change_percent||0}}const a=r[4],n=e.search(o-1,h.PlotRowSearchMode.NearestLeft,1),c=n?.value[4]??null;return null!==c&&null!=a&&(s={change:a-c,currentPrice:a,prevPrice:c,percentChange:p(c,a)}),{barChange:s,lastDayChange:l}}class L{constructor(e,t){this._series=e,this._model=t,this._emptyValues=[{title:l.t(null,void 0,r(16610)),visible:!1,value:"",index:0,id:""},{title:l.t(null,void 0,r(778254)),visible:!1,value:"",index:1,id:""},{title:l.t(null,void 0,r(165318)),visible:!1,value:"",index:2,id:""},{title:l.t(null,{context:"input"},r(51408)),visible:!1,value:"",index:3,id:""},{title:"",
visible:!1,value:"",index:4,id:""},{title:"",visible:!1,value:"",index:5,id:""},{title:l.t(null,void 0,r(537276)),visible:!1,value:"",index:6,id:""},{title:l.t(null,{context:"study"},r(424261)),visible:!1,value:"",index:7,id:""},{title:l.t(null,void 0,r(463815)),visible:!1,value:"",index:8,id:""}]}getItems(){return this._emptyValues}getValues(e){const t=this._showLastPriceAndChangeOnly(),r=this._emptyValues.map(((e,r)=>({...e,value:6===r||8===r?f:S.notAvailable,visible:5!==r&&4!==r&&!t})));if(this._model.timeScale().isEmpty()||0===this._series.bars().size()||this._series.priceScale().isEmpty())return r;const s=(0,o.ensureNotNull)(this._series.data().bars().last());(0,i.isNumber)(e)||(e=s.index);const l=this._series.nearestIndex(e,h.PlotRowSearchMode.NearestLeft);if(void 0===l)return r;const a=this._series.data().valueAt(l),d=this._model.backgroundTopColor().value();if(null===a)return r;const u=a[1],_=a[2],p=a[3],C=a[4],{barChange:v,lastDayChange:y}=B(this._series.data(),this._series.quotes(),a,l,s.value),L=(0,b.getPriceValueFormatterForSource)(this._series);if((0,b.shouldBeFormattedAsPercent)(this._series)||(0,b.shouldBeFormattedAsIndexedTo100)(this._series))r[6].value="",r[8].value="";else{const e=this._series.formatter(),t={signPositive:!0};if(void 0!==v){const{currentPrice:o,prevPrice:i,change:s,percentChange:l}=v,a=e.formatChange?.(o,i,t)??e.format(s,t);r[6].value=(0,c.forceLTRStr)(`${a} (${g.format(l,t)})`)}if(void 0!==y){const{currentPrice:o,prevPrice:i,change:s,percentChange:l}=y,a=e.formatChange?.(o,i,t)??e.format(s,t);r[8].value=(0,c.forceLTRStr)(`${a} (${g.format(l,t)})`)}}let k=null;if(t)r[5].value=null==C?S.notAvailable:L(C),r[5].visible=!0,k=this._getChangeColor(y?.change,s.index),r[6].visible=void 0!==v,r[8].visible=void 0!==y||m;else{r[0].value=null==u?S.notAvailable:L(u),r[1].value=null==_?S.notAvailable:L(_),r[2].value=null==p?S.notAvailable:L(p),r[3].value=null==C?S.notAvailable:L(C),r[4].value=L(this._series.barFunction()(a));const e=a[5];(0,i.isNumber)(e)?r[7].value=w.format(e):r[7].visible=!1;const t=this._series.intervalObj().value().is1Tick(),o=21!==this._series.style();r[0].visible=!t&&o,r[1].visible=!t,r[2].visible=!t,r[8].visible=void 0!==y||m,r[6].visible=void 0!==v;const s=this._series.barColorer().barStyle(l,!1);k=P(d,s.barBorderColor??s.barColor)}k=(0,n.resetTransparency)(P(d,k));for(const e of r)e.color||(e.color=k);return r[8].visible&&(r[8].color=(0,n.resetTransparency)(P(d,this._getChangeColor(y?.change,s.index)))),r}_mobileNonTrackingMode(){return y&&(null===this._model.crosshairSource().pane||(0,C.isLineToolName)(d.tool.value())||null!==this._model.lineBeingEdited())}_showLastPriceAndChangeOnly(){return v.alwaysShowLastPriceAndLastDayChange||this._mobileNonTrackingMode()}_getChangeColor(e,t){const r=this._series.style();if(2===r||15===r||14===r)return this._series.barColorer().barStyle(t,!1).barColor;const o=void 0===e||e>=0?_.SeriesBarColorer.upColor(this._series.properties()):_.SeriesBarColorer.downColor(this._series.properties());return o.barBorderColor??o.barColor}}},
885935:(e,t,r)=>{"use strict";r.d(t,{TpoSummaryDataSource:()=>s,tpoSummaryDataSourceId:()=>i});var o=r(470416);const i="_seriesTpoSummaryId";class s extends o.PriceDataSource{constructor(e){super(e,i)}barColorer(){return null}formatter(e){return this._model.mainSeries().formatter(e)}sessionId(){return this._model.mainSeries().sessionId()}sessionIdChanged(){return this._model.mainSeries().sessionIdChanged()}currency(){return this._model.mainSeries().currency()}unit(){return this._model.mainSeries().unit()}onStatusChanged(){return this._model.mainSeries().onStatusChanged()}symbolSource(){return this._model.mainSeries().symbolSource()}barsProvider(){return this._model.mainSeries().barsProvider()}valuesProvider(){return this._model.mainSeries().valuesProvider()}legendValuesProvider(){return this._model.mainSeries().legendValuesProvider()}statusProvider(e){return this._model.mainSeries().statusProvider(e)}name(){return"TPO Summary"}paneViews(e){return this._model.mainSeries().paneViews(e)}updateAllViews(e){this._model.mainSeries().updateAllViews(e)}widgetSideAreaViews(e){return this._model.mainSeries().widgetSideAreaViews?.(e)??null}properties(){return this._model.mainSeries().properties()}hasStateForAlert(){return!1}allowsMovingBetweenPanes(){return!1}isUserDeletable(){return!1}state(){return{id:this.id(),type:"TpoSummaryDataSource",zorder:this.zorder()}}canBeHidden(){return!1}isDraggable(){return!1}contextMenuStatName(){return"TpoSummaryContextMenu"}}},315507:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.57 5.5h-.07a3.5 3.5 0 1 0 .07 7A4.98 4.98 0 0 1 4 9a5 5 0 0 1 8.57-3.5z"/></svg>'},85290:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M12.22 11.78A3.47 3.47 0 0 0 9 6.98a3.48 3.48 0 0 0-3.22 4.8 6.97 6.97 0 0 1 6.44 0zM4.18 9.83L2.1 9.28l.33-1.24 2.07.55-.33 1.24zM6.38 6.36l-.9-1.94 1.16-.54.9 1.94-1.16.54zM10.46 5.82l.9-1.94 1.16.54-.9 1.94-1.16-.54zM13.49 8.6l2.07-.56.33 1.24-2.07.55-.33-1.24z"/></svg>'}}]);